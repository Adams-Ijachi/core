{"version":3,"sources":["webpack://@flarum/core/./src/admin/components/HeaderPrimary.js","webpack://@flarum/core/./src/admin/components/SessionDropdown.js","webpack://@flarum/core/./src/admin/components/HeaderSecondary.js","webpack://@flarum/core/./src/admin/components/DashboardWidget.js","webpack://@flarum/core/./src/admin/components/LoadingModal.js","webpack://@flarum/core/./src/admin/components/StatusWidget.js","webpack://@flarum/core/./src/admin/utils/isExtensionEnabled.js","webpack://@flarum/core/./src/admin/utils/getCategorizedExtensions.js","webpack://@flarum/core/./src/admin/components/ExtensionsWidget.js","webpack://@flarum/core/./src/common/components/Select.js","webpack://@flarum/core/./src/admin/utils/saveSettings.js","webpack://@flarum/core/./src/admin/components/AdminHeader.js","webpack://@flarum/core/./src/admin/components/AdminPage.js","webpack://@flarum/core/./src/admin/components/DashboardPage.js","webpack://@flarum/core/./src/admin/components/BasicsPage.js","webpack://@flarum/core/./src/admin/components/EditGroupModal.js","webpack://@flarum/core/./src/admin/components/PermissionDropdown.js","webpack://@flarum/core/./src/admin/components/SettingDropdown.js","webpack://@flarum/core/./src/admin/components/PermissionGrid.js","webpack://@flarum/core/./src/admin/components/PermissionsPage.js","webpack://@flarum/core/./src/admin/components/SettingsModal.js","webpack://@flarum/core/./src/admin/components/EditCustomCssModal.js","webpack://@flarum/core/./src/admin/components/EditCustomHeaderModal.js","webpack://@flarum/core/./src/admin/components/EditCustomFooterModal.js","webpack://@flarum/core/./src/admin/components/UploadImageButton.js","webpack://@flarum/core/./src/admin/components/AppearancePage.js","webpack://@flarum/core/./src/admin/components/MailPage.js","webpack://@flarum/core/./src/common/helpers/punctuateSeries.js","webpack://@flarum/core/./src/admin/components/ExtensionPermissionGrid.js","webpack://@flarum/core/./src/admin/components/ExtensionPage.js","webpack://@flarum/core/./src/admin/resolvers/ExtensionPageResolver.ts","webpack://@flarum/core/./src/admin/components/ExtensionLinkButton.js","webpack://@flarum/core/./src/admin/components/AdminNav.js","webpack://@flarum/core/./src/admin/utils/ExtensionData.js","webpack://@flarum/core/./src/admin/AdminApplication.js","webpack://@flarum/core/./src/admin/routes.js","webpack://@flarum/core/./src/admin/app.ts","webpack://@flarum/core/./src/common/utils/string.ts"],"names":["HeaderPrimary","view","className","listItems","this","items","toArray","config","isInitialized","context","retain","ItemList","Component","window","flreg","add","SessionDropdown","initAttrs","attrs","buttonClassName","menuClassName","vnode","children","getButtonContent","user","app","session","avatar","username","Button","icon","onclick","logout","bind","translator","trans","Dropdown","HeaderSecondary","LinkButton","href","external","target","component","DashboardWidget","content","LoadingModal","title","Modal","StatusWidget","label","handleClearCache","forum","attribute","data","phpVersion","mysqlVersion","e","modal","show","request","method","url","then","location","reload","isExtensionEnabled","name","JSON","parse","settings","extensions_enabled","includes","getCategorizedExtensions","extensions","Object","keys","map","id","extension","category","extra","extensionCategories","push","feature","ExtensionsWidget","oninit","categorizedExtensions","categories","extensionCategory","extensionWidget","Link","route","style","Select","options","onchange","value","disabled","withAttr","undefined","key","saveSettings","oldSettings","stringify","body","error","AdminHeader","classList","description","AdminPage","loading","headerInfo","header","submitButton","isChanged","buildSettingComponent","entry","call","setting","help","componentAttrs","type","Switch","state","bidi","onsaved","alerts","fallback","Stream","dirty","forEach","length","preventDefault","clear","Page","DashboardPage","availableWidgets","BasicsPage","localeOptions","locales","i","displayNameOptions","displayNameDrivers","identifier","slugDriverOptions","slugDrivers","model","option","FieldSet","homePageItems","path","EditGroupModal","group","store","createRecord","nameSingular","namePlural","color","isHidden","Badge","backgroundColor","fields","placeholder","a","tabindex","Number","exists","Group","deleteGroup","submitData","onsubmit","save","errorHandler","onerror","hide","m","redraw","confirm","badgeForId","getById","GroupBadge","filterByRequiredPermissions","groupIds","permission","getRequiredPermissions","required","restrictToGroupIds","permissions","indexOf","filter","PermissionDropdown","everyone","members","adminGroup","showing","allowGuest","isGroupDisabled","Separator","shiftKey","stopPropagation","apply","all","toggle","groupId","index","splice","SettingDropdown","caretIcon","defaultLabel","active","SelectDropdown","PermissionGrid","scopes","scopeItems","permissionCells","scope","render","onremove","scopeControlItems","permissionItems","section","child","viewItems","startItems","replyItems","moderateItems","merge","extensionData","getAllExtensionPermissions","minutes","parseInt","allow_renaming","transChoice","count","allow_post_editing","item","PermissionsPage","SettingsModal","form","changed","loaded","EditCustomCssModal","rows","EditCustomHeaderModal","EditCustomFooterModal","UploadImageButton","remove","src","alt","upload","$","appendTo","trigger","on","FormData","append","files","resourceUrl","serialize","raw","success","failure","response","AppearancePage","hex","test","alert","MailPage","sendingTest","refresh","status","sending","errors","driverFields","LoadingIndicator","fieldKeys","reduce","memo","val","Alert","dismissible","field","fieldInfo","email","sendTestEmail","saving","dismiss","testEmailSuccessAlert","punctuateSeries","first","second","slice","list","concat","third","ExtensionPermissionGrid","extensionId","permissionCategories","entries","obj","info","getExtensionPermissions","set","ExtensionPage","changingState","infoFields","discuss","documentation","support","website","donate","source","isEnabled","sections","topItems","infoItems","extensionHasPermissions","getSettings","version","links","authors","author","link","enabled","localStorage","setItem","setTimeout","close","code","join","ExtensionPageResolver","onmatch","args","requestedPath","extensionPage","getPage","DefaultResolver","ExtensionLinkButton","statuses","statusItems","unshift","class","AdminNav","query","extensionItems","oncreate","scrollToActive","onupdate","nav","time","previous","offsetTop","scrollTop","outerHeight","offsetHeight","animate","height","toUpperCase","ExtensionData","currentExtension","registerSetting","priority","Math","random","toString","registerPermission","permissionType","registerPage","page","AdminApplication","theme","language","canGoBack","getPrevious","backUrl","back","routes","dashboard","basics","appearance","mail","resolverClass","mount","document","hash","prefix","getElementById","Navigation","drawer","Application","Admin","getPlainContent","string","html","replace","dom","find","removeSelectors","text","trim","start","substring","toLowerCase","substr"],"mappings":"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","file":"admin/flarum-core.js","sourcesContent":["import Component from '../../common/Component';\nimport ItemList from '../../common/utils/ItemList';\nimport listItems from '../../common/helpers/listItems';\n\n/**\n * The `HeaderPrimary` component displays primary header controls. On the\n * default skin, these are shown just to the right of the forum title.\n */\nexport default class HeaderPrimary extends Component {\n  view() {\n    return <ul className=\"Header-controls\">{listItems(this.items().toArray())}</ul>;\n  }\n\n  config(isInitialized, context) {\n    // Since this component is 'above' the content of the page (that is, it is a\n    // part of the global UI that persists between routes), we will flag the DOM\n    // to be retained across route changes.\n    context.retain = true;\n  }\n\n  /**\n   * Build an item list for the controls.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    return new ItemList();\n  }\n}\n\nwindow.flreg.add('components/HeaderPrimary', HeaderPrimary)","import avatar from '../../common/helpers/avatar';\nimport username from '../../common/helpers/username';\nimport Dropdown from '../../common/components/Dropdown';\nimport Button from '../../common/components/Button';\nimport ItemList from '../../common/utils/ItemList';\n\n/**\n * The `SessionDropdown` component shows a button with the current user's\n * avatar/name, with a dropdown of session controls.\n */\nexport default class SessionDropdown extends Dropdown {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    attrs.className = 'SessionDropdown';\n    attrs.buttonClassName = 'Button Button--user Button--flat';\n    attrs.menuClassName = 'Dropdown-menu--right';\n  }\n\n  view(vnode) {\n    return super.view({ ...vnode, children: this.items().toArray() });\n  }\n\n  getButtonContent() {\n    const user = app.session.user;\n\n    return [avatar(user), ' ', <span className=\"Button-label\">{username(user)}</span>];\n  }\n\n  /**\n   * Build an item list for the contents of the dropdown menu.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    const items = new ItemList();\n\n    items.add(\n      'logOut',\n      Button.component(\n        {\n          icon: 'fas fa-sign-out-alt',\n          onclick: app.session.logout.bind(app.session),\n        },\n        app.translator.trans('core.admin.header.log_out_button')\n      ),\n      -100\n    );\n\n    return items;\n  }\n}\n\nwindow.flreg.add('components/SessionDropdown', SessionDropdown)","import Component from '../../common/Component';\nimport LinkButton from '../../common/components/LinkButton';\nimport SessionDropdown from './SessionDropdown';\nimport ItemList from '../../common/utils/ItemList';\nimport listItems from '../../common/helpers/listItems';\n\n/**\n * The `HeaderSecondary` component displays secondary header controls.\n */\nexport default class HeaderSecondary extends Component {\n  view() {\n    return <ul className=\"Header-controls\">{listItems(this.items().toArray())}</ul>;\n  }\n\n  /**\n   * Build an item list for the controls.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    const items = new ItemList();\n\n    items.add(\n      'help',\n      <LinkButton href=\"https://docs.flarum.org/troubleshoot.html\" icon=\"fas fa-question-circle\" external={true} target=\"_blank\">\n        {app.translator.trans('core.admin.header.get_help')}\n      </LinkButton>\n    );\n\n    items.add('session', SessionDropdown.component());\n\n    return items;\n  }\n}\n\nwindow.flreg.add('components/HeaderSecondary', HeaderSecondary)","import Component from '../../common/Component';\n\nexport default class DashboardWidget extends Component {\n  view() {\n    return <div className={'DashboardWidget Widget ' + this.className()}>{this.content()}</div>;\n  }\n\n  /**\n   * Get the class name to apply to the widget.\n   *\n   * @return {String}\n   */\n  className() {\n    return '';\n  }\n\n  /**\n   * Get the content of the widget.\n   *\n   * @return {VirtualElement}\n   */\n  content() {\n    return [];\n  }\n}\n\nwindow.flreg.add('components/DashboardWidget', DashboardWidget)","import Modal from '../../common/components/Modal';\n\nexport default class LoadingModal extends Modal {\n  /**\n   * @inheritdoc\n   */\n  static isDismissible = false;\n\n  className() {\n    return 'LoadingModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.loading.title');\n  }\n\n  content() {\n    return '';\n  }\n}\n\nwindow.flreg.add('components/LoadingModal', LoadingModal)","/*\n * This file is part of Flarum.\n *\n * (c) Toby Zerner <toby.zerner@gmail.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nimport DashboardWidget from './DashboardWidget';\nimport listItems from '../../common/helpers/listItems';\nimport ItemList from '../../common/utils/ItemList';\nimport Dropdown from '../../common/components/Dropdown';\nimport Button from '../../common/components/Button';\nimport LoadingModal from './LoadingModal';\n\nexport default class StatusWidget extends DashboardWidget {\n  className() {\n    return 'StatusWidget';\n  }\n\n  content() {\n    return <ul>{listItems(this.items().toArray())}</ul>;\n  }\n\n  items() {\n    const items = new ItemList();\n\n    items.add(\n      'tools',\n      <Dropdown\n        label={app.translator.trans('core.admin.dashboard.tools_button')}\n        icon=\"fas fa-cog\"\n        buttonClassName=\"Button\"\n        menuClassName=\"Dropdown-menu--right\"\n      >\n        <Button onclick={this.handleClearCache.bind(this)}>{app.translator.trans('core.admin.dashboard.clear_cache_button')}</Button>\n      </Dropdown>\n    );\n\n    items.add('version-flarum', [<strong>Flarum</strong>, <br />, app.forum.attribute('version')]);\n    items.add('version-php', [<strong>PHP</strong>, <br />, app.data.phpVersion]);\n    items.add('version-mysql', [<strong>MySQL</strong>, <br />, app.data.mysqlVersion]);\n\n    return items;\n  }\n\n  handleClearCache(e) {\n    app.modal.show(LoadingModal);\n\n    app\n      .request({\n        method: 'DELETE',\n        url: app.forum.attribute('apiUrl') + '/cache',\n      })\n      .then(() => window.location.reload());\n  }\n}\n\nwindow.flreg.add('components/StatusWidget', StatusWidget)","export default function isExtensionEnabled(name) {\n  const enabled = JSON.parse(app.data.settings.extensions_enabled);\n\n  return enabled.includes(name);\n}\n\nwindow.flreg.add('utils/isExtensionEnabled', isExtensionEnabled)","export default function getCategorizedExtensions() {\n  let extensions = {};\n\n  Object.keys(app.data.extensions).map((id) => {\n    const extension = app.data.extensions[id];\n    let category = extension.extra['flarum-extension'].category;\n\n    // Wrap languages packs into new system\n    if (extension.extra['flarum-locale']) {\n      category = 'language';\n    }\n\n    if (category in app.extensionCategories) {\n      extensions[category] = extensions[category] || [];\n\n      extensions[category].push(extension);\n    } else {\n      extensions.feature = extensions.feature || [];\n\n      extensions.feature.push(extension);\n    }\n  });\n\n  return extensions;\n}\n\nwindow.flreg.add('utils/getCategorizedExtensions', getCategorizedExtensions)","import DashboardWidget from './DashboardWidget';\nimport isExtensionEnabled from '../utils/isExtensionEnabled';\nimport getCategorizedExtensions from '../utils/getCategorizedExtensions';\nimport Link from '../../common/components/Link';\nimport icon from '../../common/helpers/icon';\n\nexport default class ExtensionsWidget extends DashboardWidget {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.categorizedExtensions = getCategorizedExtensions();\n  }\n\n  className() {\n    return 'ExtensionsWidget';\n  }\n\n  content() {\n    const categories = app.extensionCategories;\n\n    return (\n      <div className=\"ExtensionsWidget-list\">\n        {Object.keys(categories).map((category) => (this.categorizedExtensions[category] ? this.extensionCategory(category) : ''))}\n      </div>\n    );\n  }\n\n  extensionCategory(category) {\n    return (\n      <div className=\"ExtensionList-Category\">\n        <h4 className=\"ExtensionList-Label\">{app.translator.trans(`core.admin.nav.categories.${category}`)}</h4>\n        <ul className=\"ExtensionList\">{this.categorizedExtensions[category].map((extension) => this.extensionWidget(extension))}</ul>\n      </div>\n    );\n  }\n\n  extensionWidget(extension) {\n    return (\n      <li className={'ExtensionListItem ' + (!isExtensionEnabled(extension.id) ? 'disabled' : '')}>\n        <Link href={app.route('extension', { id: extension.id })}>\n          <div className=\"ExtensionListItem-content\">\n            <span className=\"ExtensionListItem-icon ExtensionIcon\" style={extension.icon}>\n              {extension.icon ? icon(extension.icon.name) : ''}\n            </span>\n            <span className=\"ExtensionListItem-title\">{extension.extra['flarum-extension'].title}</span>\n          </div>\n        </Link>\n      </li>\n    );\n  }\n}\n\nwindow.flreg.add('components/ExtensionsWidget', ExtensionsWidget)","import Component from '../Component';\nimport icon from '../helpers/icon';\nimport withAttr from '../utils/withAttr';\n\n/**\n * The `Select` component displays a <select> input, surrounded with some extra\n * elements for styling. It accepts the following attrs:\n *\n * - `options` A map of option values to labels.\n * - `onchange` A callback to run when the selected value is changed.\n * - `value` The value of the selected option.\n * - `disabled` Disabled state for the input.\n */\nexport default class Select extends Component {\n  view() {\n    const { options, onchange, value, disabled } = this.attrs;\n\n    return (\n      <span className=\"Select\">\n        <select\n          className=\"Select-input FormControl\"\n          onchange={onchange ? withAttr('value', onchange.bind(this)) : undefined}\n          value={value}\n          disabled={disabled}\n        >\n          {Object.keys(options).map((key) => (\n            <option value={key}>{options[key]}</option>\n          ))}\n        </select>\n        {icon('fas fa-sort', { className: 'Select-caret' })}\n      </span>\n    );\n  }\n}\n\nwindow.flreg.add('components/Select', Select)","export default function saveSettings(settings) {\n  const oldSettings = JSON.parse(JSON.stringify(app.data.settings));\n\n  Object.assign(app.data.settings, settings);\n\n  return app\n    .request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/settings',\n      body: settings,\n    })\n    .catch((error) => {\n      app.data.settings = oldSettings;\n      throw error;\n    });\n}\n\nwindow.flreg.add('utils/saveSettings', saveSettings)","import Component from '../../common/Component';\nimport classList from '../../common/utils/classList';\nimport icon from '../../common/helpers/icon';\n\nexport default class AdminHeader extends Component {\n  view(vnode) {\n    return [\n      <div className={classList(['AdminHeader', this.attrs.className])}>\n        <div className=\"container\">\n          <h2>\n            {icon(this.attrs.icon)}\n            {vnode.children}\n          </h2>\n          <div className=\"AdminHeader-description\">{this.attrs.description}</div>\n        </div>\n      </div>,\n    ];\n  }\n}\n\nwindow.flreg.add('components/AdminHeader', AdminHeader)","import Page from '../../common/components/Page';\nimport Button from '../../common/components/Button';\nimport Switch from '../../common/components/Switch';\nimport Select from '../../common/components/Select';\nimport classList from '../../common/utils/classList';\nimport Stream from '../../common/utils/Stream';\nimport saveSettings from '../utils/saveSettings';\nimport AdminHeader from './AdminHeader';\n\nexport default class AdminPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.settings = {};\n\n    this.loading = false;\n  }\n\n  view() {\n    const className = classList(['AdminPage', this.headerInfo().className]);\n\n    return (\n      <div className={className}>\n        {this.header()}\n        <div className=\"container\">{this.content()}</div>\n      </div>\n    );\n  }\n\n  content() {\n    return '';\n  }\n\n  submitButton() {\n    return (\n      <Button onclick={this.saveSettings.bind(this)} className=\"Button Button--primary\" loading={this.loading} disabled={!this.isChanged()}>\n        {app.translator.trans('core.admin.settings.submit_button')}\n      </Button>\n    );\n  }\n\n  header() {\n    const headerInfo = this.headerInfo();\n\n    return (\n      <AdminHeader icon={headerInfo.icon} description={headerInfo.description} className={headerInfo.className + '-header'}>\n        {headerInfo.title}\n      </AdminHeader>\n    );\n  }\n\n  headerInfo() {\n    return {\n      className: '',\n      icon: '',\n      title: '',\n      description: '',\n    };\n  }\n\n  /**\n   * buildSettingComponent takes a settings object and turns it into a component.\n   * Depending on the type of input, you can set the type to 'bool', 'select', or\n   * any standard <input> type. Any values inside the 'extra' object will be added\n   * to the component as an attribute.\n   *\n   * Alternatively, you can pass a callback that will be executed in ExtensionPage's\n   * context to include custom JSX elements.\n   *\n   * @example\n   *\n   * {\n   *    setting: 'acme.checkbox',\n   *    label: app.translator.trans('acme.admin.setting_label'),\n   *    type: 'bool',\n   *    help: app.translator.trans('acme.admin.setting_help'),\n   *    className: 'Setting-item'\n   * }\n   *\n   * @example\n   *\n   * {\n   *    setting: 'acme.select',\n   *    label: app.translator.trans('acme.admin.setting_label'),\n   *    type: 'select',\n   *    options: {\n   *      'option1': 'Option 1 label',\n   *      'option2': 'Option 2 label',\n   *    },\n   *    default: 'option1',\n   * }\n   *\n   * @param setting\n   * @returns {JSX.Element}\n   */\n  buildSettingComponent(entry) {\n    if (typeof entry === 'function') {\n      return entry.call(this);\n    }\n\n    const { setting, help, ...componentAttrs } = entry;\n\n    delete componentAttrs.help;\n\n    const value = this.setting([setting])();\n    if (['bool', 'checkbox', 'switch', 'boolean'].includes(componentAttrs.type)) {\n      return (\n        <div className=\"Form-group\">\n          <Switch state={!!value && value !== '0'} onchange={this.settings[setting]} {...componentAttrs}>\n            {componentAttrs.label}\n          </Switch>\n          <div className=\"helpText\">{help}</div>\n        </div>\n      );\n    } else if (['select', 'dropdown', 'selectdropdown'].includes(componentAttrs.type)) {\n      return (\n        <div className=\"Form-group\">\n          <label>{componentAttrs.label}</label>\n          <div className=\"helpText\">{help}</div>\n          <Select\n            value={value || componentAttrs.default}\n            options={componentAttrs.options}\n            buttonClassName=\"Button\"\n            onchange={this.settings[setting]}\n            {...componentAttrs}\n          />\n        </div>\n      );\n    } else {\n      componentAttrs.className = classList(['FormControl', componentAttrs.className]);\n      return (\n        <div className=\"Form-group\">\n          {componentAttrs.label ? <label>{componentAttrs.label}</label> : ''}\n          <div className=\"helpText\">{help}</div>\n          <input type={componentAttrs.type} bidi={this.setting(setting)} {...componentAttrs} />\n        </div>\n      );\n    }\n  }\n\n  onsaved() {\n    this.loading = false;\n\n    app.alerts.show({ type: 'success' }, app.translator.trans('core.admin.settings.saved_message'));\n  }\n\n  setting(key, fallback = '') {\n    this.settings[key] = this.settings[key] || Stream(app.data.settings[key] || fallback);\n\n    return this.settings[key];\n  }\n\n  dirty() {\n    const dirty = {};\n\n    Object.keys(this.settings).forEach((key) => {\n      const value = this.settings[key]();\n\n      if (value !== app.data.settings[key]) {\n        dirty[key] = value;\n      }\n    });\n\n    return dirty;\n  }\n\n  isChanged() {\n    return Object.keys(this.dirty()).length;\n  }\n\n  saveSettings(e) {\n    e.preventDefault();\n\n    app.alerts.clear();\n\n    this.loading = true;\n\n    return saveSettings(this.dirty()).then(this.onsaved.bind(this));\n  }\n}\n\nwindow.flreg.add('components/AdminPage', AdminPage)","import StatusWidget from './StatusWidget';\nimport ExtensionsWidget from './ExtensionsWidget';\nimport ItemList from '../../common/utils/ItemList';\nimport AdminPage from './AdminPage';\n\nexport default class DashboardPage extends AdminPage {\n  headerInfo() {\n    return {\n      className: 'DashboardPage',\n      icon: 'fas fa-chart-bar',\n      title: app.translator.trans('core.admin.dashboard.title'),\n      description: app.translator.trans('core.admin.dashboard.description'),\n    };\n  }\n\n  content() {\n    return this.availableWidgets().toArray();\n  }\n\n  availableWidgets() {\n    const items = new ItemList();\n\n    items.add('status', <StatusWidget />, 30);\n\n    items.add('extensions', <ExtensionsWidget />, 10);\n\n    return items;\n  }\n}\n\nwindow.flreg.add('components/DashboardPage', DashboardPage)","import FieldSet from '../../common/components/FieldSet';\nimport ItemList from '../../common/utils/ItemList';\nimport AdminPage from './AdminPage';\n\nexport default class BasicsPage extends AdminPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.localeOptions = {};\n    const locales = app.data.locales;\n    for (const i in locales) {\n      this.localeOptions[i] = `${locales[i]} (${i})`;\n    }\n\n    this.displayNameOptions = {};\n    const displayNameDrivers = app.data.displayNameDrivers;\n    displayNameDrivers.forEach(function (identifier) {\n      this.displayNameOptions[identifier] = identifier;\n    }, this);\n\n    this.slugDriverOptions = {};\n    Object.keys(app.data.slugDrivers).forEach((model) => {\n      this.slugDriverOptions[model] = {};\n\n      app.data.slugDrivers[model].forEach((option) => {\n        this.slugDriverOptions[model][option] = option;\n      });\n    });\n  }\n\n  headerInfo() {\n    return {\n      className: 'BasicsPage',\n      icon: 'fas fa-pencil-alt',\n      title: app.translator.trans('core.admin.basics.title'),\n      description: app.translator.trans('core.admin.basics.description'),\n    };\n  }\n\n  content() {\n    return [\n      <div className=\"Form\">\n        {this.buildSettingComponent({\n          type: 'text',\n          setting: 'forum_title',\n          label: app.translator.trans('core.admin.basics.forum_title_heading'),\n        })}\n        {this.buildSettingComponent({\n          type: 'text',\n          setting: 'forum_description',\n          label: app.translator.trans('core.admin.basics.forum_description_heading'),\n          help: app.translator.trans('core.admin.basics.forum_description_text'),\n        })}\n\n        {Object.keys(this.localeOptions).length > 1\n          ? [\n              this.buildSettingComponent({\n                type: 'select',\n                setting: 'default_locale',\n                options: this.localeOptions,\n                label: app.translator.trans('core.admin.basics.default_language_heading'),\n              }),\n              this.buildSettingComponent({\n                type: 'switch',\n                setting: 'show_language_selector',\n                label: app.translator.trans('core.admin.basics.show_language_selector_label'),\n              }),\n            ]\n          : ''}\n\n        <FieldSet className=\"BasicsPage-homePage Form-group\" label={app.translator.trans('core.admin.basics.home_page_heading')}>\n          <div className=\"helpText\">{app.translator.trans('core.admin.basics.home_page_text')}</div>\n          {this.homePageItems()\n            .toArray()\n            .map(({ path, label }) => (\n              <label className=\"checkbox\">\n                <input type=\"radio\" name=\"homePage\" value={path} bidi={this.setting('default_route')} />\n                {label}\n              </label>\n            ))}\n        </FieldSet>\n\n        <div className=\"Form-group BasicsPage-welcomeBanner-input\">\n          <label>{app.translator.trans('core.admin.basics.welcome_banner_heading')}</label>\n          <div className=\"helpText\">{app.translator.trans('core.admin.basics.welcome_banner_text')}</div>\n          <input type=\"text\" className=\"FormControl\" bidi={this.setting('welcome_title')} />\n          <textarea className=\"FormControl\" bidi={this.setting('welcome_message')} />\n        </div>\n\n        {Object.keys(this.displayNameOptions).length > 1\n          ? this.buildSettingComponent({\n              type: 'select',\n              setting: 'display_name_driver',\n              options: this.displayNameOptions,\n              label: app.translator.trans('core.admin.basics.display_name_heading'),\n              help: app.translator.trans('core.admin.basics.display_name_text'),\n            })\n          : ''}\n\n        {Object.keys(this.slugDriverOptions).map((model) => {\n          const options = this.slugDriverOptions[model];\n          if (Object.keys(options).length > 1) {\n            return this.buildSettingComponent({\n              type: 'select',\n              setting: `slug_driver_${model}`,\n              options,\n              label: app.translator.trans('core.admin.basics.slug_driver_heading', { model }),\n              help: app.translator.trans('core.admin.basics.slug_driver_text', { model }),\n            });\n          }\n        })}\n\n        {this.submitButton()}\n      </div>,\n    ];\n  }\n\n  /**\n   * Build a list of options for the default homepage. Each option must be an\n   * object with `path` and `label` properties.\n   *\n   * @return {ItemList}\n   * @public\n   */\n  homePageItems() {\n    const items = new ItemList();\n\n    items.add('allDiscussions', {\n      path: '/all',\n      label: app.translator.trans('core.admin.basics.all_discussions_label'),\n    });\n\n    return items;\n  }\n}\n\nwindow.flreg.add('components/BasicsPage', BasicsPage)","import Modal from '../../common/components/Modal';\nimport Button from '../../common/components/Button';\nimport Badge from '../../common/components/Badge';\nimport Group from '../../common/models/Group';\nimport ItemList from '../../common/utils/ItemList';\nimport Switch from '../../common/components/Switch';\nimport Stream from '../../common/utils/Stream';\n\n/**\n * The `EditGroupModal` component shows a modal dialog which allows the user\n * to create or edit a group.\n */\nexport default class EditGroupModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.group = this.attrs.group || app.store.createRecord('groups');\n\n    this.nameSingular = Stream(this.group.nameSingular() || '');\n    this.namePlural = Stream(this.group.namePlural() || '');\n    this.icon = Stream(this.group.icon() || '');\n    this.color = Stream(this.group.color() || '');\n    this.isHidden = Stream(this.group.isHidden() || false);\n  }\n\n  className() {\n    return 'EditGroupModal Modal--small';\n  }\n\n  title() {\n    return [\n      this.color() || this.icon()\n        ? Badge.component({\n            icon: this.icon(),\n            style: { backgroundColor: this.color() },\n          })\n        : '',\n      ' ',\n      this.namePlural() || app.translator.trans('core.admin.edit_group.title'),\n    ];\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">{this.fields().toArray()}</div>\n      </div>\n    );\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      'name',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('core.admin.edit_group.name_label')}</label>\n        <div className=\"EditGroupModal-name-input\">\n          <input className=\"FormControl\" placeholder={app.translator.trans('core.admin.edit_group.singular_placeholder')} bidi={this.nameSingular} />\n          <input className=\"FormControl\" placeholder={app.translator.trans('core.admin.edit_group.plural_placeholder')} bidi={this.namePlural} />\n        </div>\n      </div>,\n      30\n    );\n\n    items.add(\n      'color',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('core.admin.edit_group.color_label')}</label>\n        <input className=\"FormControl\" placeholder=\"#aaaaaa\" bidi={this.color} />\n      </div>,\n      20\n    );\n\n    items.add(\n      'icon',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('core.admin.edit_group.icon_label')}</label>\n        <div className=\"helpText\">\n          {app.translator.trans('core.admin.edit_group.icon_text', { a: <a href=\"https://fontawesome.com/icons?m=free\" tabindex=\"-1\" /> })}\n        </div>\n        <input className=\"FormControl\" placeholder=\"fas fa-bolt\" bidi={this.icon} />\n      </div>,\n      10\n    );\n\n    items.add(\n      'hidden',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: !!Number(this.isHidden()),\n            onchange: this.isHidden,\n          },\n          app.translator.trans('core.admin.edit_group.hide_label')\n        )}\n      </div>,\n      10\n    );\n\n    items.add(\n      'submit',\n      <div className=\"Form-group\">\n        {Button.component(\n          {\n            type: 'submit',\n            className: 'Button Button--primary EditGroupModal-save',\n            loading: this.loading,\n          },\n          app.translator.trans('core.admin.edit_group.submit_button')\n        )}\n        {this.group.exists && this.group.id() !== Group.ADMINISTRATOR_ID ? (\n          <button type=\"button\" className=\"Button EditGroupModal-delete\" onclick={this.deleteGroup.bind(this)}>\n            {app.translator.trans('core.admin.edit_group.delete_button')}\n          </button>\n        ) : (\n          ''\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  submitData() {\n    return {\n      nameSingular: this.nameSingular(),\n      namePlural: this.namePlural(),\n      color: this.color(),\n      icon: this.icon(),\n      isHidden: this.isHidden(),\n    };\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    this.group\n      .save(this.submitData(), { errorHandler: this.onerror.bind(this) })\n      .then(this.hide.bind(this))\n      .catch(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  deleteGroup() {\n    if (confirm(app.translator.trans('core.admin.edit_group.delete_confirmation'))) {\n      this.group.delete().then(() => m.redraw());\n      this.hide();\n    }\n  }\n}\n\nwindow.flreg.add('components/EditGroupModal', EditGroupModal)","import Dropdown from '../../common/components/Dropdown';\nimport Button from '../../common/components/Button';\nimport Separator from '../../common/components/Separator';\nimport Group from '../../common/models/Group';\nimport Badge from '../../common/components/Badge';\nimport GroupBadge from '../../common/components/GroupBadge';\n\nfunction badgeForId(id) {\n  const group = app.store.getById('groups', id);\n\n  return group ? GroupBadge.component({ group, label: null }) : '';\n}\n\nfunction filterByRequiredPermissions(groupIds, permission) {\n  app.getRequiredPermissions(permission).forEach((required) => {\n    const restrictToGroupIds = app.data.permissions[required] || [];\n\n    if (restrictToGroupIds.indexOf(Group.GUEST_ID) !== -1) {\n      // do nothing\n    } else if (restrictToGroupIds.indexOf(Group.MEMBER_ID) !== -1) {\n      groupIds = groupIds.filter((id) => id !== Group.GUEST_ID);\n    } else if (groupIds.indexOf(Group.MEMBER_ID) !== -1) {\n      groupIds = restrictToGroupIds;\n    } else {\n      groupIds = restrictToGroupIds.filter((id) => groupIds.indexOf(id) !== -1);\n    }\n\n    groupIds = filterByRequiredPermissions(groupIds, required);\n  });\n\n  return groupIds;\n}\n\nexport default class PermissionDropdown extends Dropdown {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    attrs.className = 'PermissionDropdown';\n    attrs.buttonClassName = 'Button Button--text';\n  }\n\n  view(vnode) {\n    const children = [];\n\n    let groupIds = app.data.permissions[this.attrs.permission] || [];\n\n    groupIds = filterByRequiredPermissions(groupIds, this.attrs.permission);\n\n    const everyone = groupIds.indexOf(Group.GUEST_ID) !== -1;\n    const members = groupIds.indexOf(Group.MEMBER_ID) !== -1;\n    const adminGroup = app.store.getById('groups', Group.ADMINISTRATOR_ID);\n\n    if (everyone) {\n      this.attrs.label = Badge.component({ icon: 'fas fa-globe' });\n    } else if (members) {\n      this.attrs.label = Badge.component({ icon: 'fas fa-user' });\n    } else {\n      this.attrs.label = [badgeForId(Group.ADMINISTRATOR_ID), groupIds.map(badgeForId)];\n    }\n\n    if (this.showing) {\n      if (this.attrs.allowGuest) {\n        children.push(\n          Button.component(\n            {\n              icon: everyone ? 'fas fa-check' : true,\n              onclick: () => this.save([Group.GUEST_ID]),\n              disabled: this.isGroupDisabled(Group.GUEST_ID),\n            },\n            [Badge.component({ icon: 'fas fa-globe' }), ' ', app.translator.trans('core.admin.permissions_controls.everyone_button')]\n          )\n        );\n      }\n\n      children.push(\n        Button.component(\n          {\n            icon: members ? 'fas fa-check' : true,\n            onclick: () => this.save([Group.MEMBER_ID]),\n            disabled: this.isGroupDisabled(Group.MEMBER_ID),\n          },\n          [Badge.component({ icon: 'fas fa-user' }), ' ', app.translator.trans('core.admin.permissions_controls.members_button')]\n        ),\n\n        Separator.component(),\n\n        Button.component(\n          {\n            icon: !everyone && !members ? 'fas fa-check' : true,\n            disabled: !everyone && !members,\n            onclick: (e) => {\n              if (e.shiftKey) e.stopPropagation();\n              this.save([]);\n            },\n          },\n          [badgeForId(adminGroup.id()), ' ', adminGroup.namePlural()]\n        )\n      );\n\n      [].push.apply(\n        children,\n        app.store\n          .all('groups')\n          .filter((group) => [Group.ADMINISTRATOR_ID, Group.GUEST_ID, Group.MEMBER_ID].indexOf(group.id()) === -1)\n          .map((group) =>\n            Button.component(\n              {\n                icon: groupIds.indexOf(group.id()) !== -1 ? 'fas fa-check' : true,\n                onclick: (e) => {\n                  if (e.shiftKey) e.stopPropagation();\n                  this.toggle(group.id());\n                },\n                disabled: this.isGroupDisabled(group.id()) && this.isGroupDisabled(Group.MEMBER_ID) && this.isGroupDisabled(Group.GUEST_ID),\n              },\n              [badgeForId(group.id()), ' ', group.namePlural()]\n            )\n          )\n      );\n    }\n\n    return super.view({ ...vnode, children });\n  }\n\n  save(groupIds) {\n    const permission = this.attrs.permission;\n\n    app.data.permissions[permission] = groupIds;\n\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/permission',\n      body: { permission, groupIds },\n    });\n  }\n\n  toggle(groupId) {\n    const permission = this.attrs.permission;\n\n    let groupIds = app.data.permissions[permission] || [];\n\n    const index = groupIds.indexOf(groupId);\n\n    if (index !== -1) {\n      groupIds.splice(index, 1);\n    } else {\n      groupIds.push(groupId);\n      groupIds = groupIds.filter((id) => [Group.GUEST_ID, Group.MEMBER_ID].indexOf(id) === -1);\n    }\n\n    this.save(groupIds);\n  }\n\n  isGroupDisabled(id) {\n    return filterByRequiredPermissions([id], this.attrs.permission).indexOf(id) === -1;\n  }\n}\n\nwindow.flreg.add('components/PermissionDropdown', PermissionDropdown)","import SelectDropdown from '../../common/components/SelectDropdown';\nimport Button from '../../common/components/Button';\nimport saveSettings from '../utils/saveSettings';\n\nexport default class SettingDropdown extends SelectDropdown {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    attrs.className = 'SettingDropdown';\n    attrs.buttonClassName = 'Button Button--text';\n    attrs.caretIcon = 'fas fa-caret-down';\n    attrs.defaultLabel = 'Custom';\n  }\n\n  view(vnode) {\n    return super.view({\n      ...vnode,\n      children: this.attrs.options.map(({ value, label }) => {\n        const active = app.data.settings[this.attrs.key] === value;\n\n        return Button.component(\n          {\n            icon: active ? 'fas fa-check' : true,\n            onclick: saveSettings.bind(this, { [this.attrs.key]: value }),\n            active,\n          },\n          label\n        );\n      }),\n    });\n  }\n}\n\nwindow.flreg.add('components/SettingDropdown', SettingDropdown)","import Component from '../../common/Component';\nimport PermissionDropdown from './PermissionDropdown';\nimport SettingDropdown from './SettingDropdown';\nimport Button from '../../common/components/Button';\nimport ItemList from '../../common/utils/ItemList';\nimport icon from '../../common/helpers/icon';\n\nexport default class PermissionGrid extends Component {\n  view() {\n    const scopes = this.scopeItems().toArray();\n\n    const permissionCells = (permission) => {\n      return scopes.map((scope) => <td>{scope.render(permission)}</td>);\n    };\n\n    return (\n      <table className=\"PermissionGrid\">\n        <thead>\n          <tr>\n            <td></td>\n            {scopes.map((scope) => (\n              <th>\n                {scope.label}{' '}\n                {scope.onremove\n                  ? Button.component({ icon: 'fas fa-times', className: 'Button Button--text PermissionGrid-removeScope', onclick: scope.onremove })\n                  : ''}\n              </th>\n            ))}\n            <th>{this.scopeControlItems().toArray()}</th>\n          </tr>\n        </thead>\n        {this.permissionItems()\n          .toArray()\n          .map((section) => (\n            <tbody>\n              <tr className=\"PermissionGrid-section\">\n                <th>{section.label}</th>\n                {permissionCells(section)}\n                <td />\n              </tr>\n              {section.children.map((child) => (\n                <tr className=\"PermissionGrid-child\">\n                  <th>\n                    {icon(child.icon)}\n                    {child.label}\n                  </th>\n                  {permissionCells(child)}\n                  <td />\n                </tr>\n              ))}\n            </tbody>\n          ))}\n      </table>\n    );\n  }\n\n  permissionItems() {\n    const items = new ItemList();\n\n    items.add(\n      'view',\n      {\n        label: app.translator.trans('core.admin.permissions.read_heading'),\n        children: this.viewItems().toArray(),\n      },\n      100\n    );\n\n    items.add(\n      'start',\n      {\n        label: app.translator.trans('core.admin.permissions.create_heading'),\n        children: this.startItems().toArray(),\n      },\n      90\n    );\n\n    items.add(\n      'reply',\n      {\n        label: app.translator.trans('core.admin.permissions.participate_heading'),\n        children: this.replyItems().toArray(),\n      },\n      80\n    );\n\n    items.add(\n      'moderate',\n      {\n        label: app.translator.trans('core.admin.permissions.moderate_heading'),\n        children: this.moderateItems().toArray(),\n      },\n      70\n    );\n\n    return items;\n  }\n\n  viewItems() {\n    const items = new ItemList();\n\n    items.add(\n      'viewDiscussions',\n      {\n        icon: 'fas fa-eye',\n        label: app.translator.trans('core.admin.permissions.view_discussions_label'),\n        permission: 'viewDiscussions',\n        allowGuest: true,\n      },\n      100\n    );\n\n    items.add(\n      'viewHiddenGroups',\n      {\n        icon: 'fas fa-users',\n        label: app.translator.trans('core.admin.permissions.view_hidden_groups_label'),\n        permission: 'viewHiddenGroups',\n      },\n      100\n    );\n\n    items.add(\n      'viewUserList',\n      {\n        icon: 'fas fa-users',\n        label: app.translator.trans('core.admin.permissions.view_user_list_label'),\n        permission: 'viewUserList',\n        allowGuest: true,\n      },\n      100\n    );\n\n    items.add(\n      'signUp',\n      {\n        icon: 'fas fa-user-plus',\n        label: app.translator.trans('core.admin.permissions.sign_up_label'),\n        setting: () =>\n          SettingDropdown.component({\n            key: 'allow_sign_up',\n            options: [\n              { value: '1', label: app.translator.trans('core.admin.permissions_controls.signup_open_button') },\n              { value: '0', label: app.translator.trans('core.admin.permissions_controls.signup_closed_button') },\n            ],\n          }),\n      },\n      90\n    );\n\n    items.add('viewLastSeenAt', {\n      icon: 'far fa-clock',\n      label: app.translator.trans('core.admin.permissions.view_last_seen_at_label'),\n      permission: 'user.viewLastSeenAt',\n    });\n\n    items.merge(app.extensionData.getAllExtensionPermissions('view'));\n\n    return items;\n  }\n\n  startItems() {\n    const items = new ItemList();\n\n    items.add(\n      'start',\n      {\n        icon: 'fas fa-edit',\n        label: app.translator.trans('core.admin.permissions.start_discussions_label'),\n        permission: 'startDiscussion',\n      },\n      100\n    );\n\n    items.add(\n      'allowRenaming',\n      {\n        icon: 'fas fa-i-cursor',\n        label: app.translator.trans('core.admin.permissions.allow_renaming_label'),\n        setting: () => {\n          const minutes = parseInt(app.data.settings.allow_renaming, 10);\n\n          return SettingDropdown.component({\n            defaultLabel: minutes\n              ? app.translator.transChoice('core.admin.permissions_controls.allow_some_minutes_button', minutes, { count: minutes })\n              : app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button'),\n            key: 'allow_renaming',\n            options: [\n              { value: '-1', label: app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button') },\n              { value: '10', label: app.translator.trans('core.admin.permissions_controls.allow_ten_minutes_button') },\n              { value: 'reply', label: app.translator.trans('core.admin.permissions_controls.allow_until_reply_button') },\n            ],\n          });\n        },\n      },\n      90\n    );\n\n    items.merge(app.extensionData.getAllExtensionPermissions('start'));\n\n    return items;\n  }\n\n  replyItems() {\n    const items = new ItemList();\n\n    items.add(\n      'reply',\n      {\n        icon: 'fas fa-reply',\n        label: app.translator.trans('core.admin.permissions.reply_to_discussions_label'),\n        permission: 'discussion.reply',\n      },\n      100\n    );\n\n    items.add(\n      'allowPostEditing',\n      {\n        icon: 'fas fa-pencil-alt',\n        label: app.translator.trans('core.admin.permissions.allow_post_editing_label'),\n        setting: () => {\n          const minutes = parseInt(app.data.settings.allow_post_editing, 10);\n\n          return SettingDropdown.component({\n            defaultLabel: minutes\n              ? app.translator.transChoice('core.admin.permissions_controls.allow_some_minutes_button', minutes, { count: minutes })\n              : app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button'),\n            key: 'allow_post_editing',\n            options: [\n              { value: '-1', label: app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button') },\n              { value: '10', label: app.translator.trans('core.admin.permissions_controls.allow_ten_minutes_button') },\n              { value: 'reply', label: app.translator.trans('core.admin.permissions_controls.allow_until_reply_button') },\n            ],\n          });\n        },\n      },\n      90\n    );\n\n    items.merge(app.extensionData.getAllExtensionPermissions('reply'));\n\n    return items;\n  }\n\n  moderateItems() {\n    const items = new ItemList();\n\n    items.add(\n      'viewIpsPosts',\n      {\n        icon: 'fas fa-bullseye',\n        label: app.translator.trans('core.admin.permissions.view_post_ips_label'),\n        permission: 'discussion.viewIpsPosts',\n      },\n      110\n    );\n\n    items.add(\n      'renameDiscussions',\n      {\n        icon: 'fas fa-i-cursor',\n        label: app.translator.trans('core.admin.permissions.rename_discussions_label'),\n        permission: 'discussion.rename',\n      },\n      100\n    );\n\n    items.add(\n      'hideDiscussions',\n      {\n        icon: 'far fa-trash-alt',\n        label: app.translator.trans('core.admin.permissions.delete_discussions_label'),\n        permission: 'discussion.hide',\n      },\n      90\n    );\n\n    items.add(\n      'deleteDiscussions',\n      {\n        icon: 'fas fa-times',\n        label: app.translator.trans('core.admin.permissions.delete_discussions_forever_label'),\n        permission: 'discussion.delete',\n      },\n      80\n    );\n\n    items.add(\n      'postWithoutThrottle',\n      {\n        icon: 'fas fa-swimmer',\n        label: app.translator.trans('core.admin.permissions.post_without_throttle_label'),\n        permission: 'postWithoutThrottle',\n      },\n      70\n    );\n\n    items.add(\n      'editPosts',\n      {\n        icon: 'fas fa-pencil-alt',\n        label: app.translator.trans('core.admin.permissions.edit_posts_label'),\n        permission: 'discussion.editPosts',\n      },\n      70\n    );\n\n    items.add(\n      'hidePosts',\n      {\n        icon: 'far fa-trash-alt',\n        label: app.translator.trans('core.admin.permissions.delete_posts_label'),\n        permission: 'discussion.hidePosts',\n      },\n      60\n    );\n\n    items.add(\n      'deletePosts',\n      {\n        icon: 'fas fa-times',\n        label: app.translator.trans('core.admin.permissions.delete_posts_forever_label'),\n        permission: 'discussion.deletePosts',\n      },\n      60\n    );\n\n    items.add(\n      'userEditCredentials',\n      {\n        icon: 'fas fa-user-cog',\n        label: app.translator.trans('core.admin.permissions.edit_users_credentials_label'),\n        permission: 'user.editCredentials',\n      },\n      60\n    );\n\n    items.add(\n      'userEditGroups',\n      {\n        icon: 'fas fa-users-cog',\n        label: app.translator.trans('core.admin.permissions.edit_users_groups_label'),\n        permission: 'user.editGroups',\n      },\n      60\n    );\n\n    items.add(\n      'userEdit',\n      {\n        icon: 'fas fa-address-card',\n        label: app.translator.trans('core.admin.permissions.edit_users_label'),\n        permission: 'user.edit',\n      },\n      60\n    );\n\n    items.merge(app.extensionData.getAllExtensionPermissions('moderate'));\n\n    return items;\n  }\n\n  scopeItems() {\n    const items = new ItemList();\n\n    items.add(\n      'global',\n      {\n        label: app.translator.trans('core.admin.permissions.global_heading'),\n        render: (item) => {\n          if (item.setting) {\n            return item.setting();\n          } else if (item.permission) {\n            return PermissionDropdown.component({\n              permission: item.permission,\n              allowGuest: item.allowGuest,\n            });\n          }\n\n          return '';\n        },\n      },\n      100\n    );\n\n    return items;\n  }\n\n  scopeControlItems() {\n    return new ItemList();\n  }\n}\n\nwindow.flreg.add('components/PermissionGrid', PermissionGrid)","import GroupBadge from '../../common/components/GroupBadge';\nimport EditGroupModal from './EditGroupModal';\nimport Group from '../../common/models/Group';\nimport icon from '../../common/helpers/icon';\nimport PermissionGrid from './PermissionGrid';\nimport AdminPage from './AdminPage';\n\nexport default class PermissionsPage extends AdminPage {\n  headerInfo() {\n    return {\n      className: 'PermissionsPage',\n      icon: 'fas fa-key',\n      title: app.translator.trans('core.admin.permissions.title'),\n      description: app.translator.trans('core.admin.permissions.description'),\n    };\n  }\n\n  content() {\n    return [\n      <div className=\"PermissionsPage-groups\">\n        {app.store\n          .all('groups')\n          .filter((group) => [Group.GUEST_ID, Group.MEMBER_ID].indexOf(group.id()) === -1)\n          .map((group) => (\n            <button className=\"Button Group\" onclick={() => app.modal.show(EditGroupModal, { group })}>\n              {GroupBadge.component({\n                group,\n                className: 'Group-icon',\n                label: null,\n              })}\n              <span className=\"Group-name\">{group.namePlural()}</span>\n            </button>\n          ))}\n        <button className=\"Button Group Group--add\" onclick={() => app.modal.show(EditGroupModal)}>\n          {icon('fas fa-plus', { className: 'Group-icon' })}\n          <span className=\"Group-name\">{app.translator.trans('core.admin.permissions.new_group_button')}</span>\n        </button>\n      </div>,\n\n      <div className=\"PermissionsPage-permissions\">{PermissionGrid.component()}</div>,\n    ];\n  }\n}\n\nwindow.flreg.add('components/PermissionsPage', PermissionsPage)","import Modal from '../../common/components/Modal';\nimport Button from '../../common/components/Button';\nimport Stream from '../../common/utils/Stream';\nimport saveSettings from '../utils/saveSettings';\n\nexport default class SettingsModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.settings = {};\n    this.loading = false;\n  }\n\n  form() {\n    return '';\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">\n          {this.form()}\n\n          <div className=\"Form-group\">{this.submitButton()}</div>\n        </div>\n      </div>\n    );\n  }\n\n  submitButton() {\n    return (\n      <Button type=\"submit\" className=\"Button Button--primary\" loading={this.loading} disabled={!this.changed()}>\n        {app.translator.trans('core.admin.settings.submit_button')}\n      </Button>\n    );\n  }\n\n  setting(key, fallback = '') {\n    this.settings[key] = this.settings[key] || Stream(app.data.settings[key] || fallback);\n\n    return this.settings[key];\n  }\n\n  dirty() {\n    const dirty = {};\n\n    Object.keys(this.settings).forEach((key) => {\n      const value = this.settings[key]();\n\n      if (value !== app.data.settings[key]) {\n        dirty[key] = value;\n      }\n    });\n\n    return dirty;\n  }\n\n  changed() {\n    return Object.keys(this.dirty()).length;\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    saveSettings(this.dirty()).then(this.onsaved.bind(this), this.loaded.bind(this));\n  }\n\n  onsaved() {\n    this.hide();\n  }\n}\n\nwindow.flreg.add('components/SettingsModal', SettingsModal)","import SettingsModal from './SettingsModal';\n\nexport default class EditCustomCssModal extends SettingsModal {\n  className() {\n    return 'EditCustomCssModal Modal--large';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.edit_css.title');\n  }\n\n  form() {\n    return [\n      <p>\n        {app.translator.trans('core.admin.edit_css.customize_text', {\n          a: <a href=\"https://github.com/flarum/core/tree/master/less\" target=\"_blank\" />,\n        })}\n      </p>,\n      <div className=\"Form-group\">\n        <textarea className=\"FormControl\" rows=\"30\" bidi={this.setting('custom_less')} />\n      </div>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n}\n\nwindow.flreg.add('components/EditCustomCssModal', EditCustomCssModal)","import SettingsModal from './SettingsModal';\n\nexport default class EditCustomHeaderModal extends SettingsModal {\n  className() {\n    return 'EditCustomHeaderModal Modal--large';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.edit_header.title');\n  }\n\n  form() {\n    return [\n      <p>{app.translator.trans('core.admin.edit_header.customize_text')}</p>,\n      <div className=\"Form-group\">\n        <textarea className=\"FormControl\" rows=\"30\" bidi={this.setting('custom_header')} />\n      </div>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n}\n\nwindow.flreg.add('components/EditCustomHeaderModal', EditCustomHeaderModal)","import SettingsModal from './SettingsModal';\n\nexport default class EditCustomFooterModal extends SettingsModal {\n  className() {\n    return 'EditCustomFooterModal Modal--large';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.edit_footer.title');\n  }\n\n  form() {\n    return [\n      <p>{app.translator.trans('core.admin.edit_footer.customize_text')}</p>,\n      <div className=\"Form-group\">\n        <textarea className=\"FormControl\" rows=\"30\" bidi={this.setting('custom_footer')} />\n      </div>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n}\n\nwindow.flreg.add('components/EditCustomFooterModal', EditCustomFooterModal)","import Button from '../../common/components/Button';\n\nexport default class UploadImageButton extends Button {\n  loading = false;\n\n  view(vnode) {\n    this.attrs.loading = this.loading;\n    this.attrs.className = (this.attrs.className || '') + ' Button';\n\n    if (app.data.settings[this.attrs.name + '_path']) {\n      this.attrs.onclick = this.remove.bind(this);\n\n      return (\n        <div>\n          <p>\n            <img src={app.forum.attribute(this.attrs.name + 'Url')} alt=\"\" />\n          </p>\n          <p>{super.view({ ...vnode, children: app.translator.trans('core.admin.upload_image.remove_button') })}</p>\n        </div>\n      );\n    } else {\n      this.attrs.onclick = this.upload.bind(this);\n    }\n\n    return super.view({ ...vnode, children: app.translator.trans('core.admin.upload_image.upload_button') });\n  }\n\n  /**\n   * Prompt the user to upload an image.\n   */\n  upload() {\n    if (this.loading) return;\n\n    const $input = $('<input type=\"file\">');\n\n    $input\n      .appendTo('body')\n      .hide()\n      .trigger('click')\n      .on('change', (e) => {\n        const body = new FormData();\n        body.append(this.attrs.name, $(e.target)[0].files[0]);\n\n        this.loading = true;\n        m.redraw();\n\n        app\n          .request({\n            method: 'POST',\n            url: this.resourceUrl(),\n            serialize: (raw) => raw,\n            body,\n          })\n          .then(this.success.bind(this), this.failure.bind(this));\n      });\n  }\n\n  /**\n   * Remove the logo.\n   */\n  remove() {\n    this.loading = true;\n    m.redraw();\n\n    app\n      .request({\n        method: 'DELETE',\n        url: this.resourceUrl(),\n      })\n      .then(this.success.bind(this), this.failure.bind(this));\n  }\n\n  resourceUrl() {\n    return app.forum.attribute('apiUrl') + '/' + this.attrs.name;\n  }\n\n  /**\n   * After a successful upload/removal, reload the page.\n   *\n   * @param {Object} response\n   * @protected\n   */\n  success(response) {\n    window.location.reload();\n  }\n\n  /**\n   * If upload/removal fails, stop loading.\n   *\n   * @param {Object} response\n   * @protected\n   */\n  failure(response) {\n    this.loading = false;\n    m.redraw();\n  }\n}\n\nwindow.flreg.add('components/UploadImageButton', UploadImageButton)","import Button from '../../common/components/Button';\nimport EditCustomCssModal from './EditCustomCssModal';\nimport EditCustomHeaderModal from './EditCustomHeaderModal';\nimport EditCustomFooterModal from './EditCustomFooterModal';\nimport UploadImageButton from './UploadImageButton';\nimport AdminPage from './AdminPage';\n\nexport default class AppearancePage extends AdminPage {\n  headerInfo() {\n    return {\n      className: 'AppearancePage',\n      icon: 'fas fa-paint-brush',\n      title: app.translator.trans('core.admin.appearance.title'),\n      description: app.translator.trans('core.admin.appearance.description'),\n    };\n  }\n\n  content() {\n    return [\n      <div className=\"Form\">\n        <fieldset className=\"AppearancePage-colors\">\n          <legend>{app.translator.trans('core.admin.appearance.colors_heading')}</legend>\n          <div className=\"helpText\">{app.translator.trans('core.admin.appearance.colors_text')}</div>\n\n          <div className=\"AppearancePage-colors-input\">\n            {this.buildSettingComponent({\n              type: 'text',\n              setting: 'theme_primary_color',\n              placeholder: '#aaaaaa',\n            })}\n            {this.buildSettingComponent({\n              type: 'text',\n              setting: 'theme_secondary_color',\n              placeholder: '#aaaaaa',\n            })}\n          </div>\n\n          {this.buildSettingComponent({\n            type: 'switch',\n            setting: 'theme_dark_mode',\n            label: app.translator.trans('core.admin.appearance.dark_mode_label'),\n          })}\n\n          {this.buildSettingComponent({\n            type: 'switch',\n            setting: 'theme_colored_header',\n            label: app.translator.trans('core.admin.appearance.colored_header_label'),\n          })}\n\n          {this.submitButton()}\n        </fieldset>\n      </div>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.logo_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.logo_text')}</div>\n        <UploadImageButton name=\"logo\" />\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.favicon_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.favicon_text')}</div>\n        <UploadImageButton name=\"favicon\" />\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.custom_header_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.custom_header_text')}</div>\n        {Button.component(\n          {\n            className: 'Button',\n            onclick: () => app.modal.show(EditCustomHeaderModal),\n          },\n          app.translator.trans('core.admin.appearance.edit_header_button')\n        )}\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.custom_footer_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.custom_footer_text')}</div>\n        {Button.component(\n          {\n            className: 'Button',\n            onclick: () => app.modal.show(EditCustomFooterModal),\n          },\n          app.translator.trans('core.admin.appearance.edit_footer_button')\n        )}\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.custom_styles_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.custom_styles_text')}</div>\n        {Button.component(\n          {\n            className: 'Button',\n            onclick: () => app.modal.show(EditCustomCssModal),\n          },\n          app.translator.trans('core.admin.appearance.edit_css_button')\n        )}\n      </fieldset>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n\n  saveSettings(e) {\n    e.preventDefault();\n\n    const hex = /^#[0-9a-f]{3}([0-9a-f]{3})?$/i;\n\n    if (!hex.test(this.settings['theme_primary_color']()) || !hex.test(this.settings['theme_secondary_color']())) {\n      alert(app.translator.trans('core.admin.appearance.enter_hex_message'));\n      return;\n    }\n\n    super.saveSettings(e);\n  }\n}\n\nwindow.flreg.add('components/AppearancePage', AppearancePage)","import FieldSet from '../../common/components/FieldSet';\nimport Button from '../../common/components/Button';\nimport Alert from '../../common/components/Alert';\nimport LoadingIndicator from '../../common/components/LoadingIndicator';\nimport AdminPage from './AdminPage';\n\nexport default class MailPage extends AdminPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.sendingTest = false;\n    this.refresh();\n  }\n\n  headerInfo() {\n    return {\n      className: 'MailPage',\n      icon: 'fas fa-envelope',\n      title: app.translator.trans('core.admin.email.title'),\n      description: app.translator.trans('core.admin.email.description'),\n    };\n  }\n\n  refresh() {\n    this.loading = true;\n\n    this.status = { sending: false, errors: {} };\n\n    app\n      .request({\n        method: 'GET',\n        url: app.forum.attribute('apiUrl') + '/mail/settings',\n      })\n      .then((response) => {\n        this.driverFields = response['data']['attributes']['fields'];\n        this.status.sending = response['data']['attributes']['sending'];\n        this.status.errors = response['data']['attributes']['errors'];\n\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  content() {\n    if (this.loading) {\n      return <LoadingIndicator />;\n    }\n\n    const fields = this.driverFields[this.setting('mail_driver')()];\n    const fieldKeys = Object.keys(fields);\n\n    return (\n      <div className=\"Form\">\n        {this.buildSettingComponent({\n          type: 'text',\n          setting: 'mail_from',\n          label: app.translator.trans('core.admin.email.addresses_heading'),\n          className: 'MailPage-MailSettings',\n        })}\n        {this.buildSettingComponent({\n          type: 'select',\n          setting: 'mail_driver',\n          options: Object.keys(this.driverFields).reduce((memo, val) => ({ ...memo, [val]: val }), {}),\n          label: app.translator.trans('core.admin.email.driver_heading'),\n          className: 'MailPage-MailSettings',\n        })}\n        {this.status.sending ||\n          Alert.component(\n            {\n              dismissible: false,\n            },\n            app.translator.trans('core.admin.email.not_sending_message')\n          )}\n\n        {fieldKeys.length > 0 && (\n          <FieldSet label={app.translator.trans(`core.admin.email.${this.setting('mail_driver')()}_heading`)} className=\"MailPage-MailSettings\">\n            <div className=\"MailPage-MailSettings-input\">\n              {fieldKeys.map((field) => {\n                const fieldInfo = fields[field];\n\n                return [\n                  this.buildSettingComponent({\n                    type: typeof this.setting(field)() === 'string' ? 'text' : 'select',\n                    label: app.translator.trans(`core.admin.email.${field}_label`),\n                    setting: field,\n                    options: fieldInfo,\n                  }),\n                  this.status.errors[field] && <p className=\"ValidationError\">{this.status.errors[field]}</p>,\n                ];\n              })}\n            </div>\n          </FieldSet>\n        )}\n        {this.submitButton()}\n\n        <FieldSet label={app.translator.trans('core.admin.email.send_test_mail_heading')} className=\"MailPage-MailSettings\">\n          <div className=\"helpText\">{app.translator.trans('core.admin.email.send_test_mail_text', { email: app.session.user.email() })}</div>\n          {Button.component(\n            {\n              className: 'Button Button--primary',\n              disabled: this.sendingTest || this.isChanged(),\n              onclick: () => this.sendTestEmail(),\n            },\n            app.translator.trans('core.admin.email.send_test_mail_button')\n          )}\n        </FieldSet>\n      </div>\n    );\n  }\n\n  sendTestEmail() {\n    if (this.saving || this.sendingTest) return;\n\n    this.sendingTest = true;\n    app.alerts.dismiss(this.testEmailSuccessAlert);\n\n    app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/mail/test',\n      })\n      .then((response) => {\n        this.sendingTest = false;\n        this.testEmailSuccessAlert = app.alerts.show({ type: 'success' }, app.translator.trans('core.admin.email.send_test_mail_success'));\n      })\n      .catch((error) => {\n        this.sendingTest = false;\n        m.redraw();\n        throw error;\n      });\n  }\n\n  saveSettings(e) {\n    super.saveSettings(e).then(this.refresh());\n  }\n}\n\nwindow.flreg.add('components/MailPage', MailPage)","/**\n * The `punctuateSeries` helper formats a list of strings (e.g. names) to read\n * fluently in the application's locale.\n *\n * ```js\n * punctuateSeries(['Toby', 'Franz', 'Dominion']) // Toby, Franz, and Dominion\n * ```\n *\n * @param {Array} items\n * @return {VirtualElement}\n */\nexport default function punctuateSeries(items) {\n  if (items.length === 2) {\n    return app.translator.trans('core.lib.series.two_text', {\n      first: items[0],\n      second: items[1],\n    });\n  } else if (items.length >= 3) {\n    // If there are three or more items, we will join all but the first and\n    // last items with the equivalent of a comma, and then we will feed that\n    // into the translator along with the first and last item.\n    const second = items\n      .slice(1, items.length - 1)\n      .reduce((list, item) => list.concat([item, app.translator.trans('core.lib.series.glue_text')]), [])\n      .slice(0, -1);\n\n    return app.translator.trans('core.lib.series.three_text', {\n      first: items[0],\n      second,\n      third: items[items.length - 1],\n    });\n  }\n\n  return items;\n}\n\nwindow.flreg.add('helpers/punctuateSeries', punctuateSeries)","import PermissionGrid from './PermissionGrid';\nimport Button from '../../common/components/Button';\nimport ItemList from '../../common/utils/ItemList';\n\nexport default class ExtensionPermissionGrid extends PermissionGrid {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.extensionId = this.attrs.extensionId;\n  }\n\n  permissionItems() {\n    const permissionCategories = super.permissionItems();\n\n    permissionCategories.items = Object.entries(permissionCategories.items)\n      .filter(([category, info]) => info.content.children.length > 0)\n      .reduce((obj, [category, info]) => {\n        obj[category] = info;\n        return obj;\n      }, {});\n\n    return permissionCategories;\n  }\n\n  viewItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'view') || new ItemList();\n  }\n\n  startItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'start') || new ItemList();\n  }\n\n  replyItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'reply') || new ItemList();\n  }\n\n  moderateItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'moderate') || new ItemList();\n  }\n\n  scopeControlItems() {\n    const items = new ItemList();\n\n    items.add(\n      'configureScopes',\n      <Button className=\"Button Button--text\" onclick={() => m.route.set(app.route('permissions'))}>\n        {app.translator.trans('core.admin.extension.configure_scopes')}\n      </Button>\n    );\n\n    return items;\n  }\n}\n\nwindow.flreg.add('components/ExtensionPermissionGrid', ExtensionPermissionGrid)","import Button from '../../common/components/Button';\nimport Link from '../../common/components/Link';\nimport LinkButton from '../../common/components/LinkButton';\nimport Switch from '../../common/components/Switch';\nimport icon from '../../common/helpers/icon';\nimport punctuateSeries from '../../common/helpers/punctuateSeries';\nimport listItems from '../../common/helpers/listItems';\nimport ItemList from '../../common/utils/ItemList';\nimport LoadingModal from './LoadingModal';\nimport ExtensionPermissionGrid from './ExtensionPermissionGrid';\nimport isExtensionEnabled from '../utils/isExtensionEnabled';\nimport AdminPage from './AdminPage';\n\nexport default class ExtensionPage extends AdminPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.extension = app.data.extensions[this.attrs.id];\n    this.changingState = false;\n\n    this.infoFields = {\n      discuss: 'fas fa-comment-alt',\n      documentation: 'fas fa-book',\n      support: 'fas fa-life-ring',\n      website: 'fas fa-link',\n      donate: 'fas fa-donate',\n      source: 'fas fa-code',\n    };\n\n    if (!this.extension) {\n      return m.route.set(app.route('dashboard'));\n    }\n  }\n\n  className() {\n    if (!this.extension) return '';\n\n    return this.extension.id + '-Page';\n  }\n\n  view() {\n    if (!this.extension) return null;\n\n    return (\n      <div className={'ExtensionPage ' + this.className()}>\n        {this.header()}\n        {!this.isEnabled() ? (\n          <div className=\"container\">\n            <h3 className=\"ExtensionPage-subHeader\">{app.translator.trans('core.admin.extension.enable_to_see')}</h3>\n          </div>\n        ) : (\n          <div className=\"ExtensionPage-body\">{this.sections().toArray()}</div>\n        )}\n      </div>\n    );\n  }\n\n  header() {\n    const isEnabled = this.isEnabled();\n\n    return [\n      <div className=\"ExtensionPage-header\">\n        <div className=\"container\">\n          <div className=\"ExtensionTitle\">\n            <span className=\"ExtensionIcon\" style={this.extension.icon}>\n              {this.extension.icon ? icon(this.extension.icon.name) : ''}\n            </span>\n            <div className=\"ExtensionName\">\n              <h2>{this.extension.extra['flarum-extension'].title}</h2>\n            </div>\n            <div className=\"ExtensionPage-headerTopItems\">\n              <ul>{listItems(this.topItems().toArray())}</ul>\n            </div>\n          </div>\n          <div className=\"helpText\">{this.extension.description}</div>\n          <div className=\"ExtensionPage-headerItems\">\n            <Switch\n              state={this.changingState ? !isEnabled : isEnabled}\n              loading={this.changingState}\n              onchange={this.toggle.bind(this, this.extension.id)}\n            >\n              {isEnabled ? app.translator.trans('core.admin.extension.enabled') : app.translator.trans('core.admin.extension.disabled')}\n            </Switch>\n            <aside className=\"ExtensionInfo\">\n              <ul>{listItems(this.infoItems().toArray())}</ul>\n            </aside>\n          </div>\n        </div>\n      </div>,\n    ];\n  }\n\n  sections() {\n    const items = new ItemList();\n\n    items.add('content', this.content());\n\n    items.add('permissions', [\n      <div className=\"ExtensionPage-permissions\">\n        <div className=\"ExtensionPage-permissions-header\">\n          <div className=\"container\">\n            <h2 className=\"ExtensionTitle\">{app.translator.trans('core.admin.extension.permissions_title')}</h2>\n          </div>\n        </div>\n        <div className=\"container\">\n          {app.extensionData.extensionHasPermissions(this.extension.id) ? (\n            ExtensionPermissionGrid.component({ extensionId: this.extension.id })\n          ) : (\n            <h3 className=\"ExtensionPage-subHeader\">{app.translator.trans('core.admin.extension.no_permissions')}</h3>\n          )}\n        </div>\n      </div>,\n    ]);\n\n    return items;\n  }\n\n  content() {\n    const settings = app.extensionData.getSettings(this.extension.id);\n\n    return (\n      <div className=\"ExtensionPage-settings\">\n        <div className=\"container\">\n          {settings ? (\n            <div className=\"Form\">\n              {settings.map(this.buildSettingComponent.bind(this))}\n              <div className=\"Form-group\">{this.submitButton()}</div>\n            </div>\n          ) : (\n            <h3 className=\"ExtensionPage-subHeader\">{app.translator.trans('core.admin.extension.no_settings')}</h3>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  topItems() {\n    const items = new ItemList();\n\n    items.add('version', <span className=\"ExtensionVersion\">{this.extension.version}</span>);\n\n    if (!this.isEnabled()) {\n      const uninstall = () => {\n        if (confirm(app.translator.trans('core.admin.extension.confirm_uninstall'))) {\n          app\n            .request({\n              url: app.forum.attribute('apiUrl') + '/extensions/' + this.extension.id,\n              method: 'DELETE',\n            })\n            .then(() => window.location.reload());\n\n          app.modal.show(LoadingModal);\n        }\n      };\n\n      items.add(\n        'uninstall',\n        <Button icon=\"fas fa-trash-alt\" className=\"Button Button--primary\" onclick={uninstall.bind(this)}>\n          {app.translator.trans('core.admin.extension.uninstall_button')}\n        </Button>\n      );\n    }\n\n    return items;\n  }\n\n  infoItems() {\n    const items = new ItemList();\n\n    const links = this.extension.links;\n\n    if (links.authors.length) {\n      let authors = [];\n\n      links.authors.map((author) => {\n        authors.push(\n          <Link href={author.link} external={true} target=\"_blank\">\n            {author.name}\n          </Link>\n        );\n      });\n\n      items.add('authors', [icon('fas fa-user'), <span>{punctuateSeries(authors)}</span>]);\n    }\n\n    Object.keys(this.infoFields).map((field) => {\n      if (links[field]) {\n        items.add(\n          field,\n          <LinkButton href={links[field]} icon={this.infoFields[field]} external={true} target=\"_blank\">\n            {app.translator.trans(`core.admin.extension.info_links.${field}`)}\n          </LinkButton>\n        );\n      }\n    });\n\n    return items;\n  }\n\n  toggle() {\n    const enabled = this.isEnabled();\n\n    this.changingState = true;\n\n    app\n      .request({\n        url: app.forum.attribute('apiUrl') + '/extensions/' + this.extension.id,\n        method: 'PATCH',\n        body: { enabled: !enabled },\n        errorHandler: this.onerror.bind(this),\n      })\n      .then(() => {\n        if (!enabled) localStorage.setItem('enabledExtension', this.extension.id);\n        window.location.reload();\n      });\n\n    app.modal.show(LoadingModal);\n  }\n\n  isEnabled() {\n    return isExtensionEnabled(this.extension.id);\n  }\n\n  onerror(e) {\n    // We need to give the modal animation time to start; if we close the modal too early,\n    // it breaks the bootstrap modal library.\n    // TODO: This workaround should be removed when we move away from bootstrap JS for modals.\n    setTimeout(() => {\n      app.modal.close();\n    }, 300); // Bootstrap's Modal.TRANSITION_DURATION is 300 ms.\n\n    this.changingState = false;\n\n    if (e.status !== 409) {\n      throw e;\n    }\n\n    const error = e.response.errors[0];\n\n    app.alerts.show(\n      { type: 'error' },\n      app.translator.trans(`core.lib.error.${error.code}_message`, {\n        extension: error.extension,\n        extensions: error.extensions.join(', '),\n      })\n    );\n  }\n}\n\nwindow.flreg.add('components/ExtensionPage', ExtensionPage)","import DefaultResolver from '../../common/resolvers/DefaultResolver';\n\n/**\n * A custom route resolver for ExtensionPage that generates handles routes\n * to default extension pages or a page provided by an extension.\n */\nexport default class ExtensionPageResolver extends DefaultResolver {\n  static extension: string | null = null;\n\n  onmatch(args, requestedPath, route) {\n    const extensionPage = app.extensionData.getPage(args.id);\n\n    if (extensionPage) {\n      return extensionPage;\n    }\n\n    return super.onmatch(args, requestedPath, route);\n  }\n}\n\nwindow.flreg.add('resolvers/ExtensionPageResolver', ExtensionPageResolver)","import isExtensionEnabled from '../utils/isExtensionEnabled';\nimport LinkButton from '../../common/components/LinkButton';\nimport icon from '../../common/helpers/icon';\nimport ItemList from '../../common/utils/ItemList';\n\nexport default class ExtensionLinkButton extends LinkButton {\n  getButtonContent(children) {\n    const content = super.getButtonContent(children);\n    const extension = app.data.extensions[this.attrs.extensionId];\n    const statuses = this.statusItems(extension.id).toArray();\n\n    content.unshift(\n      <span className=\"ExtensionListItem-icon ExtensionIcon\" style={extension.icon}>\n        {extension.icon ? icon(extension.icon.name) : ''}\n      </span>\n    );\n    content.push(statuses);\n\n    return content;\n  }\n\n  statusItems(name) {\n    const items = new ItemList();\n\n    items.add('enabled', <span class={'ExtensionListItem-Dot ' + (isExtensionEnabled(name) ? 'enabled' : 'disabled')} />);\n\n    return items;\n  }\n}\n\nwindow.flreg.add('components/ExtensionLinkButton', ExtensionLinkButton)","import ExtensionLinkButton from './ExtensionLinkButton';\nimport Component from '../../common/Component';\nimport LinkButton from '../../common/components/LinkButton';\nimport SelectDropdown from '../../common/components/SelectDropdown';\nimport getCategorizedExtensions from '../utils/getCategorizedExtensions';\nimport ItemList from '../../common/utils/ItemList';\nimport Stream from '../../common/utils/Stream';\n\nexport default class AdminNav extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.query = Stream('');\n  }\n\n  view() {\n    return (\n      <SelectDropdown className=\"AdminNav App-titleControl AdminNav-Main\" buttonClassName=\"Button\">\n        {this.items().toArray().concat(this.extensionItems().toArray())}\n      </SelectDropdown>\n    );\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.scrollToActive();\n  }\n\n  onupdate() {\n    this.scrollToActive();\n  }\n\n  scrollToActive() {\n    const children = $('.Dropdown-menu').children('.active');\n    const nav = $('#admin-navigation');\n    const time = app.previous.type ? 250 : 0;\n\n    if (\n      children.length > 0 &&\n      (children[0].offsetTop > nav.scrollTop() + nav.outerHeight() || children[0].offsetTop + children[0].offsetHeight < nav.scrollTop())\n    ) {\n      nav.animate(\n        {\n          scrollTop: children[0].offsetTop - nav.height() / 2,\n        },\n        time\n      );\n    }\n  }\n\n  /**\n   * Build an item list of main links to show in the admin navigation.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    const items = new ItemList();\n\n    items.add('category-core', <h4 className=\"ExtensionListTitle\">{app.translator.trans('core.admin.nav.categories.core')}</h4>);\n\n    items.add(\n      'dashboard',\n      <LinkButton href={app.route('dashboard')} icon=\"far fa-chart-bar\" title={app.translator.trans('core.admin.nav.dashboard_title')}>\n        {app.translator.trans('core.admin.nav.dashboard_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'basics',\n      <LinkButton href={app.route('basics')} icon=\"fas fa-pencil-alt\" title={app.translator.trans('core.admin.nav.basics_title')}>\n        {app.translator.trans('core.admin.nav.basics_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'mail',\n      <LinkButton href={app.route('mail')} icon=\"fas fa-envelope\" title={app.translator.trans('core.admin.nav.email_title')}>\n        {app.translator.trans('core.admin.nav.email_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'permissions',\n      <LinkButton href={app.route('permissions')} icon=\"fas fa-key\" title={app.translator.trans('core.admin.nav.permissions_title')}>\n        {app.translator.trans('core.admin.nav.permissions_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'appearance',\n      <LinkButton href={app.route('appearance')} icon=\"fas fa-paint-brush\" title={app.translator.trans('core.admin.nav.appearance_title')}>\n        {app.translator.trans('core.admin.nav.appearance_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'search',\n      <div className=\"Search-input\">\n        <input\n          className=\"FormControl SearchBar\"\n          bidi={this.query}\n          type=\"search\"\n          placeholder={app.translator.trans('core.admin.nav.search_placeholder')}\n        />\n      </div>\n    );\n\n    return items;\n  }\n\n  extensionItems() {\n    const items = new ItemList();\n\n    const categorizedExtensions = getCategorizedExtensions();\n    const categories = app.extensionCategories;\n\n    Object.keys(categorizedExtensions).map((category) => {\n      if (!this.query()) {\n        items.add(\n          `category-${category}`,\n          <h4 className=\"ExtensionListTitle\">{app.translator.trans(`core.admin.nav.categories.${category}`)}</h4>,\n          categories[category]\n        );\n      }\n\n      categorizedExtensions[category].map((extension) => {\n        const query = this.query().toUpperCase();\n        const title = extension.extra['flarum-extension'].title || '';\n        const description = extension.description || '';\n\n        if (!query || title.toUpperCase().includes(query) || description.toUpperCase().includes(query)) {\n          items.add(\n            `extension-${extension.id}`,\n            <ExtensionLinkButton\n              href={app.route('extension', { id: extension.id })}\n              extensionId={extension.id}\n              className=\"ExtensionNavButton\"\n              title={description}\n            >\n              {title}\n            </ExtensionLinkButton>,\n            categories[category]\n          );\n        }\n      });\n    });\n\n    return items;\n  }\n}\n\nwindow.flreg.add('components/AdminNav', AdminNav)","import ItemList from '../../common/utils/ItemList';\n\nexport default class ExtensionData {\n  constructor() {\n    this.data = {};\n    this.currentExtension = null;\n  }\n\n  /**\n   * This function simply takes the extension id\n   *\n   * @example\n   * app.extensionData.load('flarum-tags')\n   *\n   * flarum/flags -> flarum-flags | acme/extension -> acme-extension\n   *\n   * @param extension\n   */\n  for(extension) {\n    this.currentExtension = extension;\n    this.data[extension] = this.data[extension] || {};\n\n    return this;\n  }\n\n  /**\n   * This function registers your settings with Flarum\n   *\n   * It takes either a settings object or a callback.\n   *\n   * @example\n   *\n   * .registerSetting({\n   *   setting: 'flarum-flags.guidelines_url',\n   *   type: 'text', // This will be inputted into the input tag for the setting (text/number/etc)\n   *   label: app.translator.trans('flarum-flags.admin.settings.guidelines_url_label')\n   * }, 15) // priority is optional (ItemList)\n   *\n   *\n   * @param content\n   * @param priority\n   * @returns {ExtensionData}\n   */\n  registerSetting(content, priority = 0) {\n    this.data[this.currentExtension].settings = this.data[this.currentExtension].settings || new ItemList();\n\n    // Callbacks can be passed in instead of settings to display custom content.\n    // By default, they will be added with the `null` key, since they don't have a `.setting` attr.\n    // To support multiple such items for one extension, we assign a random ID.\n    // 36 is arbitrary length, but makes collisions very unlikely.\n    if (typeof content === 'function') {\n      content.setting = Math.random().toString(36);\n    }\n\n    this.data[this.currentExtension].settings.add(content.setting, content, priority);\n\n    return this;\n  }\n\n  /**\n   * This function registers your permission with Flarum\n   *\n   * @example\n   *\n   * .registerPermission('permissions', {\n   *     icon: 'fas fa-flag',\n   *     label: app.translator.trans('flarum-flags.admin.permissions.view_flags_label'),\n   *     permission: 'discussion.viewFlags'\n   * }, 'moderate', 65)\n   *\n   * @param content\n   * @param permissionType\n   * @param priority\n   * @returns {ExtensionData}\n   */\n  registerPermission(content, permissionType = null, priority = 0) {\n    this.data[this.currentExtension].permissions = this.data[this.currentExtension].permissions || {};\n\n    if (!this.data[this.currentExtension].permissions[permissionType]) {\n      this.data[this.currentExtension].permissions[permissionType] = new ItemList();\n    }\n\n    this.data[this.currentExtension].permissions[permissionType].add(content.permission, content, priority);\n\n    return this;\n  }\n\n  /**\n   * Replace the default extension page with a custom component.\n   * This component would typically extend ExtensionPage\n   *\n   * @param component\n   * @returns {ExtensionData}\n   */\n  registerPage(component) {\n    this.data[this.currentExtension].page = component;\n\n    return this;\n  }\n\n  /**\n   * Get an extension's registered settings\n   *\n   * @param extensionId\n   * @returns {boolean|*}\n   */\n  getSettings(extensionId) {\n    if (this.data[extensionId] && this.data[extensionId].settings) {\n      return this.data[extensionId].settings.toArray();\n    }\n\n    return false;\n  }\n\n  /**\n   *\n   * Get an ItemList of all extensions' registered permissions\n   *\n   * @param extension\n   * @param type\n   * @returns {ItemList}\n   */\n  getAllExtensionPermissions(type) {\n    const items = new ItemList();\n\n    Object.keys(this.data).map((extension) => {\n      if (this.extensionHasPermissions(extension) && this.data[extension].permissions[type]) {\n        items.merge(this.data[extension].permissions[type]);\n      }\n    });\n\n    return items;\n  }\n\n  /**\n   * Get a singular extension's registered permissions\n   *\n   * @param extension\n   * @param type\n   * @returns {boolean|*}\n   */\n  getExtensionPermissions(extension, type) {\n    if (this.extensionHasPermissions(extension) && this.data[extension].permissions[type]) {\n      return this.data[extension].permissions[type];\n    }\n\n    return new ItemList();\n  }\n\n  /**\n   * Checks whether a given extension has registered permissions.\n   *\n   * @param extension\n   * @returns {boolean}\n   */\n  extensionHasPermissions(extension) {\n    if (this.data[extension] && this.data[extension].permissions) {\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Returns an extension's custom page component if it exists.\n   *\n   * @param extension\n   * @returns {boolean|*}\n   */\n  getPage(extension) {\n    if (this.data[extension]) {\n      return this.data[extension].page;\n    }\n\n    return false;\n  }\n}\n\nwindow.flreg.add('utils/ExtensionData', ExtensionData)","import HeaderPrimary from './components/HeaderPrimary';\nimport HeaderSecondary from './components/HeaderSecondary';\nimport routes from './routes';\nimport Application from '../common/Application';\nimport Navigation from '../common/components/Navigation';\nimport AdminNav from './components/AdminNav';\nimport ExtensionData from './utils/ExtensionData';\n\nexport default class AdminApplication extends Application {\n  extensionData = new ExtensionData();\n\n  extensionCategories = {\n    feature: 30,\n    theme: 20,\n    language: 10,\n  };\n\n  history = {\n    canGoBack: () => true,\n    getPrevious: () => {},\n    backUrl: () => this.forum.attribute('baseUrl'),\n    back: function () {\n      window.location = this.backUrl();\n    },\n  };\n\n  constructor() {\n    super();\n\n    routes(this);\n  }\n\n  /**\n   * @inheritdoc\n   */\n  mount() {\n    // Mithril does not render the home route on https://example.com/admin, so\n    // we need to go to https://example.com/admin#/ explicitly.\n    if (!document.location.hash) document.location.hash = '#/';\n\n    m.route.prefix = '#';\n    super.mount();\n\n    m.mount(document.getElementById('app-navigation'), {\n      view: () =>\n        Navigation.component({\n          className: 'App-backControl',\n          drawer: true,\n        }),\n    });\n    m.mount(document.getElementById('header-navigation'), Navigation);\n    m.mount(document.getElementById('header-primary'), HeaderPrimary);\n    m.mount(document.getElementById('header-secondary'), HeaderSecondary);\n    m.mount(document.getElementById('admin-navigation'), AdminNav);\n  }\n\n  getRequiredPermissions(permission) {\n    const required = [];\n\n    if (permission === 'startDiscussion' || permission.indexOf('discussion.') === 0) {\n      required.push('viewDiscussions');\n    }\n    if (permission === 'discussion.delete') {\n      required.push('discussion.hide');\n    }\n    if (permission === 'discussion.deletePosts') {\n      required.push('discussion.hidePosts');\n    }\n\n    return required;\n  }\n}\n\nwindow.flreg.add('admin/AdminApplication', AdminApplication)","import DashboardPage from './components/DashboardPage';\nimport BasicsPage from './components/BasicsPage';\nimport PermissionsPage from './components/PermissionsPage';\nimport AppearancePage from './components/AppearancePage';\nimport MailPage from './components/MailPage';\nimport ExtensionPage from './components/ExtensionPage';\nimport ExtensionPageResolver from './resolvers/ExtensionPageResolver';\n\n/**\n * The `routes` initializer defines the forum app's routes.\n *\n * @param {App} app\n */\nexport default function (app) {\n  app.routes = {\n    dashboard: { path: '/', component: DashboardPage },\n    basics: { path: '/basics', component: BasicsPage },\n    permissions: { path: '/permissions', component: PermissionsPage },\n    appearance: { path: '/appearance', component: AppearancePage },\n    mail: { path: '/mail', component: MailPage },\n    extension: { path: '/extension/:id', component: ExtensionPage, resolverClass: ExtensionPageResolver },\n  };\n}\n","import Admin from './AdminApplication';\n\nconst app = new Admin();\n\n// @ts-ignore\nwindow.app = app;\n\nexport default app;\n","/**\n * Truncate a string to the given length, appending ellipses if necessary.\n */\nexport function truncate(string: string, length: number, start: number = 0): string {\n  return (start > 0 ? '...' : '') + string.substring(start, start + length) + (string.length > start + length ? '...' : '');\n}\n\n/**\n * Create a slug out of the given string. Non-alphanumeric characters are\n * converted to hyphens.\n *\n * NOTE: This method does not use the comparably sophisticated transliteration\n * mechanism that is employed in the backend. Therefore, it should only be used\n * to *suggest* slugs that can be overridden by the user.\n */\nexport function slug(string: string): string {\n  return string\n    .toLowerCase()\n    .replace(/[^a-z0-9]/gi, '-')\n    .replace(/-+/g, '-')\n    .replace(/-$|^-/g, '');\n}\n\n/**\n * Strip HTML tags and quotes out of the given string, replacing them with\n * meaningful punctuation.\n */\nexport function getPlainContent(string: string): string {\n  const html = string.replace(/(<\\/p>|<br>)/g, '$1 &nbsp;').replace(/<img\\b[^>]*>/gi, ' ');\n\n  const dom = $('<div/>').html(html);\n\n  dom.find(getPlainContent.removeSelectors.join(',')).remove();\n\n  return dom.text().replace(/\\s+/g, ' ').trim();\n}\n\n/**\n * An array of DOM selectors to remove when getting plain content.\n *\n * @type {Array}\n */\ngetPlainContent.removeSelectors = ['blockquote', 'script'];\n\n/**\n * Make a string's first character uppercase.\n */\nexport function ucfirst(string: string): string {\n  return string.substr(0, 1).toUpperCase() + string.substr(1);\n}\n\nwindow.flreg.add('utils/truncate', truncate)\nwindow.flreg.add('utils/slug', slug)\nwindow.flreg.add('utils/getPlainContent', getPlainContent)\nwindow.flreg.add('utils/ucfirst', ucfirst)"],"sourceRoot":""}