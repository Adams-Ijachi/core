{"version":3,"sources":["webpack://@flarum/core/./src/admin/components/HeaderPrimary.js","webpack://@flarum/core/./src/admin/components/SessionDropdown.js","webpack://@flarum/core/./src/admin/components/HeaderSecondary.js","webpack://@flarum/core/./src/admin/components/DashboardWidget.js","webpack://@flarum/core/./src/admin/components/LoadingModal.js","webpack://@flarum/core/./src/admin/components/StatusWidget.js","webpack://@flarum/core/./src/admin/utils/isExtensionEnabled.js","webpack://@flarum/core/./src/admin/utils/getCategorizedExtensions.js","webpack://@flarum/core/./src/admin/components/ExtensionsWidget.js","webpack://@flarum/core/./src/admin/utils/saveSettings.js","webpack://@flarum/core/./src/admin/components/AdminHeader.js","webpack://@flarum/core/./src/admin/components/AdminPage.js","webpack://@flarum/core/./src/admin/components/DashboardPage.js","webpack://@flarum/core/./src/admin/components/BasicsPage.js","webpack://@flarum/core/./src/admin/components/EditGroupModal.js","webpack://@flarum/core/./src/admin/components/PermissionDropdown.js","webpack://@flarum/core/./src/admin/components/SettingDropdown.js","webpack://@flarum/core/./src/admin/components/PermissionGrid.js","webpack://@flarum/core/./src/admin/components/PermissionsPage.js","webpack://@flarum/core/./src/admin/components/SettingsModal.js","webpack://@flarum/core/./src/admin/components/EditCustomCssModal.js","webpack://@flarum/core/./src/admin/components/EditCustomHeaderModal.js","webpack://@flarum/core/./src/admin/components/EditCustomFooterModal.js","webpack://@flarum/core/./src/admin/components/UploadImageButton.js","webpack://@flarum/core/./src/admin/components/AppearancePage.js","webpack://@flarum/core/./src/admin/components/MailPage.js","webpack://@flarum/core/./src/admin/components/ExtensionPermissionGrid.js","webpack://@flarum/core/./src/admin/components/ExtensionPage.js","webpack://@flarum/core/./src/admin/resolvers/ExtensionPageResolver.ts","webpack://@flarum/core/./src/admin/routes.js","webpack://@flarum/core/./src/admin/components/ExtensionLinkButton.js","webpack://@flarum/core/./src/admin/components/AdminNav.js","webpack://@flarum/core/./src/admin/utils/ExtensionData.js","webpack://@flarum/core/./src/admin/AdminApplication.js","webpack://@flarum/core/./src/admin/app.ts","webpack://@flarum/core/./src/admin/compat.js","webpack://@flarum/core/./src/admin/index.js","webpack://@flarum/core/./src/common/utils/string.ts"],"names":["HeaderPrimary","view","className","listItems","this","items","toArray","config","isInitialized","context","retain","ItemList","Component","SessionDropdown","initAttrs","attrs","buttonClassName","menuClassName","vnode","children","getButtonContent","user","app","session","avatar","username","add","Button","icon","onclick","logout","bind","translator","trans","Dropdown","HeaderSecondary","LinkButton","href","external","target","component","DashboardWidget","content","LoadingModal","title","Modal","StatusWidget","label","handleClearCache","forum","attribute","data","phpVersion","mysqlVersion","e","modal","show","request","method","url","then","window","location","reload","isExtensionEnabled","name","JSON","parse","settings","extensions_enabled","includes","getCategorizedExtensions","extensions","Object","keys","map","id","extension","category","extra","extensionCategories","push","feature","ExtensionsWidget","oninit","categorizedExtensions","categories","extensionCategory","extensionWidget","Link","route","style","saveSettings","oldSettings","stringify","body","error","AdminHeader","classList","description","AdminPage","loading","headerInfo","header","submitButton","disabled","isChanged","buildSettingComponent","entry","call","setting","help","componentAttrs","value","type","Switch","state","onchange","Select","options","bidi","onsaved","alerts","key","fallback","Stream","dirty","forEach","length","preventDefault","clear","Page","DashboardPage","availableWidgets","BasicsPage","localeOptions","locales","i","displayNameOptions","displayNameDrivers","identifier","slugDriverOptions","slugDrivers","model","option","FieldSet","homePageItems","path","EditGroupModal","group","store","createRecord","nameSingular","namePlural","color","isHidden","Badge","backgroundColor","fields","placeholder","a","tabindex","Number","exists","Group","deleteGroup","submitData","onsubmit","save","errorHandler","onerror","hide","m","redraw","confirm","badgeForId","getById","GroupBadge","filterByRequiredPermissions","groupIds","permission","getRequiredPermissions","required","restrictToGroupIds","permissions","indexOf","filter","PermissionDropdown","everyone","members","adminGroup","showing","allowGuest","isGroupDisabled","Separator","shiftKey","stopPropagation","apply","all","toggle","groupId","index","splice","SettingDropdown","caretIcon","defaultLabel","active","SelectDropdown","PermissionGrid","scopes","scopeItems","permissionCells","scope","render","onremove","scopeControlItems","permissionItems","section","child","viewItems","startItems","replyItems","moderateItems","merge","extensionData","getAllExtensionPermissions","minutes","parseInt","allow_renaming","transChoice","count","allow_post_editing","item","PermissionsPage","SettingsModal","form","changed","loaded","EditCustomCssModal","rows","EditCustomHeaderModal","EditCustomFooterModal","UploadImageButton","remove","src","alt","upload","$","appendTo","click","on","FormData","append","files","resourceUrl","serialize","raw","success","failure","response","AppearancePage","hex","test","alert","MailPage","sendingTest","refresh","status","sending","errors","driverFields","LoadingIndicator","fieldKeys","reduce","memo","val","Alert","dismissible","field","fieldInfo","email","sendTestEmail","saving","dismiss","testEmailSuccessAlert","ExtensionPermissionGrid","extensionId","permissionCategories","entries","obj","info","getExtensionPermissions","set","ExtensionPage","changingState","infoFields","discuss","documentation","support","website","donate","source","isEnabled","sections","topItems","infoItems","extensionHasPermissions","getSettings","version","links","authors","author","link","punctuateSeries","enabled","localStorage","setItem","setTimeout","close","code","join","ExtensionPageResolver","onmatch","args","requestedPath","getPage","DefaultResolver","routes","dashboard","basics","appearance","mail","resolverClass","ExtensionLinkButton","statuses","statusItems","unshift","class","AdminNav","query","concat","extensionItems","oncreate","scrollToActive","onupdate","nav","time","previous","offsetTop","scrollTop","outerHeight","offsetHeight","animate","height","toUpperCase","ExtensionData","currentExtension","registerSetting","priority","Math","random","toString","registerPermission","permissionType","registerPage","page","AdminApplication","theme","language","canGoBack","getPrevious","backUrl","back","mount","document","hash","prefix","getElementById","Navigation","drawer","Application","Admin","compat","compatObj","proxifyCompat","truncate","string","start","substring","slug","toLowerCase","replace","getPlainContent","html","dom","find","removeSelectors","text","trim","ucfirst","substr"],"mappings":"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","file":"/admin/flarum-core.js","sourcesContent":["import Component from '../../common/Component';\nimport ItemList from '../../common/utils/ItemList';\nimport listItems from '../../common/helpers/listItems';\n\n/**\n * The `HeaderPrimary` component displays primary header controls. On the\n * default skin, these are shown just to the right of the forum title.\n */\nexport default class HeaderPrimary extends Component {\n  view() {\n    return <ul className=\"Header-controls\">{listItems(this.items().toArray())}</ul>;\n  }\n\n  config(isInitialized, context) {\n    // Since this component is 'above' the content of the page (that is, it is a\n    // part of the global UI that persists between routes), we will flag the DOM\n    // to be retained across route changes.\n    context.retain = true;\n  }\n\n  /**\n   * Build an item list for the controls.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    return new ItemList();\n  }\n}\n","import avatar from '../../common/helpers/avatar';\nimport username from '../../common/helpers/username';\nimport Dropdown from '../../common/components/Dropdown';\nimport Button from '../../common/components/Button';\nimport ItemList from '../../common/utils/ItemList';\n\n/**\n * The `SessionDropdown` component shows a button with the current user's\n * avatar/name, with a dropdown of session controls.\n */\nexport default class SessionDropdown extends Dropdown {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    attrs.className = 'SessionDropdown';\n    attrs.buttonClassName = 'Button Button--user Button--flat';\n    attrs.menuClassName = 'Dropdown-menu--right';\n  }\n\n  view(vnode) {\n    return super.view({ ...vnode, children: this.items().toArray() });\n  }\n\n  getButtonContent() {\n    const user = app.session.user;\n\n    return [avatar(user), ' ', <span className=\"Button-label\">{username(user)}</span>];\n  }\n\n  /**\n   * Build an item list for the contents of the dropdown menu.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    const items = new ItemList();\n\n    items.add(\n      'logOut',\n      Button.component(\n        {\n          icon: 'fas fa-sign-out-alt',\n          onclick: app.session.logout.bind(app.session),\n        },\n        app.translator.trans('core.admin.header.log_out_button')\n      ),\n      -100\n    );\n\n    return items;\n  }\n}\n","import Component from '../../common/Component';\nimport LinkButton from '../../common/components/LinkButton';\nimport SessionDropdown from './SessionDropdown';\nimport ItemList from '../../common/utils/ItemList';\nimport listItems from '../../common/helpers/listItems';\n\n/**\n * The `HeaderSecondary` component displays secondary header controls.\n */\nexport default class HeaderSecondary extends Component {\n  view() {\n    return <ul className=\"Header-controls\">{listItems(this.items().toArray())}</ul>;\n  }\n\n  /**\n   * Build an item list for the controls.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    const items = new ItemList();\n\n    items.add(\n      'help',\n      <LinkButton href=\"https://docs.flarum.org/troubleshoot.html\" icon=\"fas fa-question-circle\" external={true} target=\"_blank\">\n        {app.translator.trans('core.admin.header.get_help')}\n      </LinkButton>\n    );\n\n    items.add('session', SessionDropdown.component());\n\n    return items;\n  }\n}\n","import Component from '../../common/Component';\n\nexport default class DashboardWidget extends Component {\n  view() {\n    return <div className={'DashboardWidget Widget ' + this.className()}>{this.content()}</div>;\n  }\n\n  /**\n   * Get the class name to apply to the widget.\n   *\n   * @return {String}\n   */\n  className() {\n    return '';\n  }\n\n  /**\n   * Get the content of the widget.\n   *\n   * @return {VirtualElement}\n   */\n  content() {\n    return [];\n  }\n}\n","import Modal from '../../common/components/Modal';\n\nexport default class LoadingModal extends Modal {\n  /**\n   * @inheritdoc\n   */\n  static isDismissible = false;\n\n  className() {\n    return 'LoadingModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.loading.title');\n  }\n\n  content() {\n    return '';\n  }\n}\n","/*\n * This file is part of Flarum.\n *\n * (c) Toby Zerner <toby.zerner@gmail.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nimport DashboardWidget from './DashboardWidget';\nimport listItems from '../../common/helpers/listItems';\nimport ItemList from '../../common/utils/ItemList';\nimport Dropdown from '../../common/components/Dropdown';\nimport Button from '../../common/components/Button';\nimport LoadingModal from './LoadingModal';\n\nexport default class StatusWidget extends DashboardWidget {\n  className() {\n    return 'StatusWidget';\n  }\n\n  content() {\n    return <ul>{listItems(this.items().toArray())}</ul>;\n  }\n\n  items() {\n    const items = new ItemList();\n\n    items.add(\n      'tools',\n      <Dropdown\n        label={app.translator.trans('core.admin.dashboard.tools_button')}\n        icon=\"fas fa-cog\"\n        buttonClassName=\"Button\"\n        menuClassName=\"Dropdown-menu--right\"\n      >\n        <Button onclick={this.handleClearCache.bind(this)}>{app.translator.trans('core.admin.dashboard.clear_cache_button')}</Button>\n      </Dropdown>\n    );\n\n    items.add('version-flarum', [<strong>Flarum</strong>, <br />, app.forum.attribute('version')]);\n    items.add('version-php', [<strong>PHP</strong>, <br />, app.data.phpVersion]);\n    items.add('version-mysql', [<strong>MySQL</strong>, <br />, app.data.mysqlVersion]);\n\n    return items;\n  }\n\n  handleClearCache(e) {\n    app.modal.show(LoadingModal);\n\n    app\n      .request({\n        method: 'DELETE',\n        url: app.forum.attribute('apiUrl') + '/cache',\n      })\n      .then(() => window.location.reload());\n  }\n}\n","export default function isExtensionEnabled(name) {\n  const enabled = JSON.parse(app.data.settings.extensions_enabled);\n\n  return enabled.includes(name);\n}\n","export default function getCategorizedExtensions() {\n  let extensions = {};\n\n  Object.keys(app.data.extensions).map((id) => {\n    const extension = app.data.extensions[id];\n    let category = extension.extra['flarum-extension'].category;\n\n    // Wrap languages packs into new system\n    if (extension.extra['flarum-locale']) {\n      category = 'language';\n    }\n\n    if (category in app.extensionCategories) {\n      extensions[category] = extensions[category] || [];\n\n      extensions[category].push(extension);\n    } else {\n      extensions.feature = extensions.feature || [];\n\n      extensions.feature.push(extension);\n    }\n  });\n\n  return extensions;\n}\n","import DashboardWidget from './DashboardWidget';\nimport isExtensionEnabled from '../utils/isExtensionEnabled';\nimport getCategorizedExtensions from '../utils/getCategorizedExtensions';\nimport Link from '../../common/components/Link';\nimport icon from '../../common/helpers/icon';\n\nexport default class ExtensionsWidget extends DashboardWidget {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.categorizedExtensions = getCategorizedExtensions();\n  }\n\n  className() {\n    return 'ExtensionsWidget';\n  }\n\n  content() {\n    const categories = app.extensionCategories;\n\n    return (\n      <div className=\"ExtensionsWidget-list\">\n        {Object.keys(categories).map((category) => (this.categorizedExtensions[category] ? this.extensionCategory(category) : ''))}\n      </div>\n    );\n  }\n\n  extensionCategory(category) {\n    return (\n      <div className=\"ExtensionList-Category\">\n        <h4 className=\"ExtensionList-Label\">{app.translator.trans(`core.admin.nav.categories.${category}`)}</h4>\n        <ul className=\"ExtensionList\">{this.categorizedExtensions[category].map((extension) => this.extensionWidget(extension))}</ul>\n      </div>\n    );\n  }\n\n  extensionWidget(extension) {\n    return (\n      <li className={'ExtensionListItem ' + (!isExtensionEnabled(extension.id) ? 'disabled' : '')}>\n        <Link href={app.route('extension', { id: extension.id })}>\n          <div className=\"ExtensionListItem-content\">\n            <span className=\"ExtensionListItem-icon ExtensionIcon\" style={extension.icon}>\n              {extension.icon ? icon(extension.icon.name) : ''}\n            </span>\n            <span className=\"ExtensionListItem-title\">{extension.extra['flarum-extension'].title}</span>\n          </div>\n        </Link>\n      </li>\n    );\n  }\n}\n","export default function saveSettings(settings) {\n  const oldSettings = JSON.parse(JSON.stringify(app.data.settings));\n\n  Object.assign(app.data.settings, settings);\n\n  return app\n    .request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/settings',\n      body: settings,\n    })\n    .catch((error) => {\n      app.data.settings = oldSettings;\n      throw error;\n    });\n}\n","import Component from '../../common/Component';\nimport classList from '../../common/utils/classList';\nimport icon from '../../common/helpers/icon';\n\nexport default class AdminHeader extends Component {\n  view(vnode) {\n    return [\n      <div className={classList(['AdminHeader', this.attrs.className])}>\n        <div className=\"container\">\n          <h2>\n            {icon(this.attrs.icon)}\n            {vnode.children}\n          </h2>\n          <div className=\"AdminHeader-description\">{this.attrs.description}</div>\n        </div>\n      </div>,\n    ];\n  }\n}\n","import Page from '../../common/components/Page';\nimport Button from '../../common/components/Button';\nimport Switch from '../../common/components/Switch';\nimport Select from '../../common/components/Select';\nimport classList from '../../common/utils/classList';\nimport Stream from '../../common/utils/Stream';\nimport saveSettings from '../utils/saveSettings';\nimport AdminHeader from './AdminHeader';\n\nexport default class AdminPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.settings = {};\n\n    this.loading = false;\n  }\n\n  view() {\n    const className = classList(['AdminPage', this.headerInfo().className]);\n\n    return (\n      <div className={className}>\n        {this.header()}\n        <div className=\"container\">{this.content()}</div>\n      </div>\n    );\n  }\n\n  content() {\n    return '';\n  }\n\n  submitButton() {\n    return (\n      <Button onclick={this.saveSettings.bind(this)} className=\"Button Button--primary\" loading={this.loading} disabled={!this.isChanged()}>\n        {app.translator.trans('core.admin.settings.submit_button')}\n      </Button>\n    );\n  }\n\n  header() {\n    const headerInfo = this.headerInfo();\n\n    return (\n      <AdminHeader icon={headerInfo.icon} description={headerInfo.description} className={headerInfo.className + '-header'}>\n        {headerInfo.title}\n      </AdminHeader>\n    );\n  }\n\n  headerInfo() {\n    return {\n      className: '',\n      icon: '',\n      title: '',\n      description: '',\n    };\n  }\n\n  /**\n   * buildSettingComponent takes a settings object and turns it into a component.\n   * Depending on the type of input, you can set the type to 'bool', 'select', or\n   * any standard <input> type. Any values inside the 'extra' object will be added\n   * to the component as an attribute.\n   *\n   * Alternatively, you can pass a callback that will be executed in ExtensionPage's\n   * context to include custom JSX elements.\n   *\n   * @example\n   *\n   * {\n   *    setting: 'acme.checkbox',\n   *    label: app.translator.trans('acme.admin.setting_label'),\n   *    type: 'bool',\n   *    help: app.translator.trans('acme.admin.setting_help'),\n   *    className: 'Setting-item'\n   * }\n   *\n   * @example\n   *\n   * {\n   *    setting: 'acme.select',\n   *    label: app.translator.trans('acme.admin.setting_label'),\n   *    type: 'select',\n   *    options: {\n   *      'option1': 'Option 1 label',\n   *      'option2': 'Option 2 label',\n   *    },\n   *    default: 'option1',\n   * }\n   *\n   * @param setting\n   * @returns {JSX.Element}\n   */\n  buildSettingComponent(entry) {\n    if (typeof entry === 'function') {\n      return entry.call(this);\n    }\n\n    const { setting, help, ...componentAttrs } = entry;\n\n    delete componentAttrs.help;\n\n    const value = this.setting([setting])();\n    if (['bool', 'checkbox', 'switch', 'boolean'].includes(componentAttrs.type)) {\n      return (\n        <div className=\"Form-group\">\n          <Switch state={!!value && value !== '0'} onchange={this.settings[setting]} {...componentAttrs}>\n            {componentAttrs.label}\n          </Switch>\n          <div className=\"helpText\">{help}</div>\n        </div>\n      );\n    } else if (['select', 'dropdown', 'selectdropdown'].includes(componentAttrs.type)) {\n      return (\n        <div className=\"Form-group\">\n          <label>{componentAttrs.label}</label>\n          <div className=\"helpText\">{help}</div>\n          <Select\n            value={value || componentAttrs.default}\n            options={componentAttrs.options}\n            buttonClassName=\"Button\"\n            onchange={this.settings[setting]}\n            {...componentAttrs}\n          />\n        </div>\n      );\n    } else {\n      componentAttrs.className = classList(['FormControl', componentAttrs.className]);\n      return (\n        <div className=\"Form-group\">\n          {componentAttrs.label ? <label>{componentAttrs.label}</label> : ''}\n          <div className=\"helpText\">{help}</div>\n          <input type={componentAttrs.type} bidi={this.setting(setting)} {...componentAttrs} />\n        </div>\n      );\n    }\n  }\n\n  onsaved() {\n    this.loading = false;\n\n    app.alerts.show({ type: 'success' }, app.translator.trans('core.admin.settings.saved_message'));\n  }\n\n  setting(key, fallback = '') {\n    this.settings[key] = this.settings[key] || Stream(app.data.settings[key] || fallback);\n\n    return this.settings[key];\n  }\n\n  dirty() {\n    const dirty = {};\n\n    Object.keys(this.settings).forEach((key) => {\n      const value = this.settings[key]();\n\n      if (value !== app.data.settings[key]) {\n        dirty[key] = value;\n      }\n    });\n\n    return dirty;\n  }\n\n  isChanged() {\n    return Object.keys(this.dirty()).length;\n  }\n\n  saveSettings(e) {\n    e.preventDefault();\n\n    app.alerts.clear();\n\n    this.loading = true;\n\n    return saveSettings(this.dirty()).then(this.onsaved.bind(this));\n  }\n}\n","import StatusWidget from './StatusWidget';\nimport ExtensionsWidget from './ExtensionsWidget';\nimport ItemList from '../../common/utils/ItemList';\nimport AdminPage from './AdminPage';\n\nexport default class DashboardPage extends AdminPage {\n  headerInfo() {\n    return {\n      className: 'DashboardPage',\n      icon: 'fas fa-chart-bar',\n      title: app.translator.trans('core.admin.dashboard.title'),\n      description: app.translator.trans('core.admin.dashboard.description'),\n    };\n  }\n\n  content() {\n    return this.availableWidgets().toArray();\n  }\n\n  availableWidgets() {\n    const items = new ItemList();\n\n    items.add('status', <StatusWidget />, 30);\n\n    items.add('extensions', <ExtensionsWidget />, 10);\n\n    return items;\n  }\n}\n","import FieldSet from '../../common/components/FieldSet';\nimport ItemList from '../../common/utils/ItemList';\nimport AdminPage from './AdminPage';\n\nexport default class BasicsPage extends AdminPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.localeOptions = {};\n    const locales = app.data.locales;\n    for (const i in locales) {\n      this.localeOptions[i] = `${locales[i]} (${i})`;\n    }\n\n    this.displayNameOptions = {};\n    const displayNameDrivers = app.data.displayNameDrivers;\n    displayNameDrivers.forEach(function (identifier) {\n      this.displayNameOptions[identifier] = identifier;\n    }, this);\n\n    this.slugDriverOptions = {};\n    Object.keys(app.data.slugDrivers).forEach((model) => {\n      this.slugDriverOptions[model] = {};\n\n      app.data.slugDrivers[model].forEach((option) => {\n        this.slugDriverOptions[model][option] = option;\n      });\n    });\n  }\n\n  headerInfo() {\n    return {\n      className: 'BasicsPage',\n      icon: 'fas fa-pencil-alt',\n      title: app.translator.trans('core.admin.basics.title'),\n      description: app.translator.trans('core.admin.basics.description'),\n    };\n  }\n\n  content() {\n    return [\n      <div className=\"Form\">\n        {this.buildSettingComponent({\n          type: 'text',\n          setting: 'forum_title',\n          label: app.translator.trans('core.admin.basics.forum_title_heading'),\n        })}\n        {this.buildSettingComponent({\n          type: 'text',\n          setting: 'forum_description',\n          label: app.translator.trans('core.admin.basics.forum_description_heading'),\n          help: app.translator.trans('core.admin.basics.forum_description_text'),\n        })}\n\n        {Object.keys(this.localeOptions).length > 1\n          ? [\n              this.buildSettingComponent({\n                type: 'select',\n                setting: 'default_locale',\n                options: this.localeOptions,\n                label: app.translator.trans('core.admin.basics.default_language_heading'),\n              }),\n              this.buildSettingComponent({\n                type: 'switch',\n                setting: 'show_language_selector',\n                label: app.translator.trans('core.admin.basics.show_language_selector_label'),\n              }),\n            ]\n          : ''}\n\n        <FieldSet className=\"BasicsPage-homePage Form-group\" label={app.translator.trans('core.admin.basics.home_page_heading')}>\n          <div className=\"helpText\">{app.translator.trans('core.admin.basics.home_page_text')}</div>\n          {this.homePageItems()\n            .toArray()\n            .map(({ path, label }) => (\n              <label className=\"checkbox\">\n                <input type=\"radio\" name=\"homePage\" value={path} bidi={this.setting('default_route')} />\n                {label}\n              </label>\n            ))}\n        </FieldSet>\n\n        <div className=\"Form-group BasicsPage-welcomeBanner-input\">\n          <label>{app.translator.trans('core.admin.basics.welcome_banner_heading')}</label>\n          <div className=\"helpText\">{app.translator.trans('core.admin.basics.welcome_banner_text')}</div>\n          <input type=\"text\" className=\"FormControl\" bidi={this.setting('welcome_title')} />\n          <textarea className=\"FormControl\" bidi={this.setting('welcome_message')} />\n        </div>\n\n        {Object.keys(this.displayNameOptions).length > 1\n          ? this.buildSettingComponent({\n              type: 'select',\n              setting: 'display_name_driver',\n              options: this.displayNameOptions,\n              label: app.translator.trans('core.admin.basics.display_name_heading'),\n              help: app.translator.trans('core.admin.basics.display_name_text'),\n            })\n          : ''}\n\n        {Object.keys(this.slugDriverOptions).map((model) => {\n          const options = this.slugDriverOptions[model];\n          if (Object.keys(options).length > 1) {\n            return this.buildSettingComponent({\n              type: 'select',\n              setting: `slug_driver_${model}`,\n              options,\n              label: app.translator.trans('core.admin.basics.slug_driver_heading', { model }),\n              help: app.translator.trans('core.admin.basics.slug_driver_text', { model }),\n            });\n          }\n        })}\n\n        {this.submitButton()}\n      </div>,\n    ];\n  }\n\n  /**\n   * Build a list of options for the default homepage. Each option must be an\n   * object with `path` and `label` properties.\n   *\n   * @return {ItemList}\n   * @public\n   */\n  homePageItems() {\n    const items = new ItemList();\n\n    items.add('allDiscussions', {\n      path: '/all',\n      label: app.translator.trans('core.admin.basics.all_discussions_label'),\n    });\n\n    return items;\n  }\n}\n","import Modal from '../../common/components/Modal';\nimport Button from '../../common/components/Button';\nimport Badge from '../../common/components/Badge';\nimport Group from '../../common/models/Group';\nimport ItemList from '../../common/utils/ItemList';\nimport Switch from '../../common/components/Switch';\nimport Stream from '../../common/utils/Stream';\n\n/**\n * The `EditGroupModal` component shows a modal dialog which allows the user\n * to create or edit a group.\n */\nexport default class EditGroupModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.group = this.attrs.group || app.store.createRecord('groups');\n\n    this.nameSingular = Stream(this.group.nameSingular() || '');\n    this.namePlural = Stream(this.group.namePlural() || '');\n    this.icon = Stream(this.group.icon() || '');\n    this.color = Stream(this.group.color() || '');\n    this.isHidden = Stream(this.group.isHidden() || false);\n  }\n\n  className() {\n    return 'EditGroupModal Modal--small';\n  }\n\n  title() {\n    return [\n      this.color() || this.icon()\n        ? Badge.component({\n            icon: this.icon(),\n            style: { backgroundColor: this.color() },\n          })\n        : '',\n      ' ',\n      this.namePlural() || app.translator.trans('core.admin.edit_group.title'),\n    ];\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">{this.fields().toArray()}</div>\n      </div>\n    );\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      'name',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('core.admin.edit_group.name_label')}</label>\n        <div className=\"EditGroupModal-name-input\">\n          <input className=\"FormControl\" placeholder={app.translator.trans('core.admin.edit_group.singular_placeholder')} bidi={this.nameSingular} />\n          <input className=\"FormControl\" placeholder={app.translator.trans('core.admin.edit_group.plural_placeholder')} bidi={this.namePlural} />\n        </div>\n      </div>,\n      30\n    );\n\n    items.add(\n      'color',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('core.admin.edit_group.color_label')}</label>\n        <input className=\"FormControl\" placeholder=\"#aaaaaa\" bidi={this.color} />\n      </div>,\n      20\n    );\n\n    items.add(\n      'icon',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('core.admin.edit_group.icon_label')}</label>\n        <div className=\"helpText\">\n          {app.translator.trans('core.admin.edit_group.icon_text', { a: <a href=\"https://fontawesome.com/icons?m=free\" tabindex=\"-1\" /> })}\n        </div>\n        <input className=\"FormControl\" placeholder=\"fas fa-bolt\" bidi={this.icon} />\n      </div>,\n      10\n    );\n\n    items.add(\n      'hidden',\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: !!Number(this.isHidden()),\n            onchange: this.isHidden,\n          },\n          app.translator.trans('core.admin.edit_group.hide_label')\n        )}\n      </div>,\n      10\n    );\n\n    items.add(\n      'submit',\n      <div className=\"Form-group\">\n        {Button.component(\n          {\n            type: 'submit',\n            className: 'Button Button--primary EditGroupModal-save',\n            loading: this.loading,\n          },\n          app.translator.trans('core.admin.edit_group.submit_button')\n        )}\n        {this.group.exists && this.group.id() !== Group.ADMINISTRATOR_ID ? (\n          <button type=\"button\" className=\"Button EditGroupModal-delete\" onclick={this.deleteGroup.bind(this)}>\n            {app.translator.trans('core.admin.edit_group.delete_button')}\n          </button>\n        ) : (\n          ''\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  submitData() {\n    return {\n      nameSingular: this.nameSingular(),\n      namePlural: this.namePlural(),\n      color: this.color(),\n      icon: this.icon(),\n      isHidden: this.isHidden(),\n    };\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    this.group\n      .save(this.submitData(), { errorHandler: this.onerror.bind(this) })\n      .then(this.hide.bind(this))\n      .catch(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  deleteGroup() {\n    if (confirm(app.translator.trans('core.admin.edit_group.delete_confirmation'))) {\n      this.group.delete().then(() => m.redraw());\n      this.hide();\n    }\n  }\n}\n","import Dropdown from '../../common/components/Dropdown';\nimport Button from '../../common/components/Button';\nimport Separator from '../../common/components/Separator';\nimport Group from '../../common/models/Group';\nimport Badge from '../../common/components/Badge';\nimport GroupBadge from '../../common/components/GroupBadge';\n\nfunction badgeForId(id) {\n  const group = app.store.getById('groups', id);\n\n  return group ? GroupBadge.component({ group, label: null }) : '';\n}\n\nfunction filterByRequiredPermissions(groupIds, permission) {\n  app.getRequiredPermissions(permission).forEach((required) => {\n    const restrictToGroupIds = app.data.permissions[required] || [];\n\n    if (restrictToGroupIds.indexOf(Group.GUEST_ID) !== -1) {\n      // do nothing\n    } else if (restrictToGroupIds.indexOf(Group.MEMBER_ID) !== -1) {\n      groupIds = groupIds.filter((id) => id !== Group.GUEST_ID);\n    } else if (groupIds.indexOf(Group.MEMBER_ID) !== -1) {\n      groupIds = restrictToGroupIds;\n    } else {\n      groupIds = restrictToGroupIds.filter((id) => groupIds.indexOf(id) !== -1);\n    }\n\n    groupIds = filterByRequiredPermissions(groupIds, required);\n  });\n\n  return groupIds;\n}\n\nexport default class PermissionDropdown extends Dropdown {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    attrs.className = 'PermissionDropdown';\n    attrs.buttonClassName = 'Button Button--text';\n  }\n\n  view(vnode) {\n    const children = [];\n\n    let groupIds = app.data.permissions[this.attrs.permission] || [];\n\n    groupIds = filterByRequiredPermissions(groupIds, this.attrs.permission);\n\n    const everyone = groupIds.indexOf(Group.GUEST_ID) !== -1;\n    const members = groupIds.indexOf(Group.MEMBER_ID) !== -1;\n    const adminGroup = app.store.getById('groups', Group.ADMINISTRATOR_ID);\n\n    if (everyone) {\n      this.attrs.label = Badge.component({ icon: 'fas fa-globe' });\n    } else if (members) {\n      this.attrs.label = Badge.component({ icon: 'fas fa-user' });\n    } else {\n      this.attrs.label = [badgeForId(Group.ADMINISTRATOR_ID), groupIds.map(badgeForId)];\n    }\n\n    if (this.showing) {\n      if (this.attrs.allowGuest) {\n        children.push(\n          Button.component(\n            {\n              icon: everyone ? 'fas fa-check' : true,\n              onclick: () => this.save([Group.GUEST_ID]),\n              disabled: this.isGroupDisabled(Group.GUEST_ID),\n            },\n            [Badge.component({ icon: 'fas fa-globe' }), ' ', app.translator.trans('core.admin.permissions_controls.everyone_button')]\n          )\n        );\n      }\n\n      children.push(\n        Button.component(\n          {\n            icon: members ? 'fas fa-check' : true,\n            onclick: () => this.save([Group.MEMBER_ID]),\n            disabled: this.isGroupDisabled(Group.MEMBER_ID),\n          },\n          [Badge.component({ icon: 'fas fa-user' }), ' ', app.translator.trans('core.admin.permissions_controls.members_button')]\n        ),\n\n        Separator.component(),\n\n        Button.component(\n          {\n            icon: !everyone && !members ? 'fas fa-check' : true,\n            disabled: !everyone && !members,\n            onclick: (e) => {\n              if (e.shiftKey) e.stopPropagation();\n              this.save([]);\n            },\n          },\n          [badgeForId(adminGroup.id()), ' ', adminGroup.namePlural()]\n        )\n      );\n\n      [].push.apply(\n        children,\n        app.store\n          .all('groups')\n          .filter((group) => [Group.ADMINISTRATOR_ID, Group.GUEST_ID, Group.MEMBER_ID].indexOf(group.id()) === -1)\n          .map((group) =>\n            Button.component(\n              {\n                icon: groupIds.indexOf(group.id()) !== -1 ? 'fas fa-check' : true,\n                onclick: (e) => {\n                  if (e.shiftKey) e.stopPropagation();\n                  this.toggle(group.id());\n                },\n                disabled: this.isGroupDisabled(group.id()) && this.isGroupDisabled(Group.MEMBER_ID) && this.isGroupDisabled(Group.GUEST_ID),\n              },\n              [badgeForId(group.id()), ' ', group.namePlural()]\n            )\n          )\n      );\n    }\n\n    return super.view({ ...vnode, children });\n  }\n\n  save(groupIds) {\n    const permission = this.attrs.permission;\n\n    app.data.permissions[permission] = groupIds;\n\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/permission',\n      body: { permission, groupIds },\n    });\n  }\n\n  toggle(groupId) {\n    const permission = this.attrs.permission;\n\n    let groupIds = app.data.permissions[permission] || [];\n\n    const index = groupIds.indexOf(groupId);\n\n    if (index !== -1) {\n      groupIds.splice(index, 1);\n    } else {\n      groupIds.push(groupId);\n      groupIds = groupIds.filter((id) => [Group.GUEST_ID, Group.MEMBER_ID].indexOf(id) === -1);\n    }\n\n    this.save(groupIds);\n  }\n\n  isGroupDisabled(id) {\n    return filterByRequiredPermissions([id], this.attrs.permission).indexOf(id) === -1;\n  }\n}\n","import SelectDropdown from '../../common/components/SelectDropdown';\nimport Button from '../../common/components/Button';\nimport saveSettings from '../utils/saveSettings';\n\nexport default class SettingDropdown extends SelectDropdown {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    attrs.className = 'SettingDropdown';\n    attrs.buttonClassName = 'Button Button--text';\n    attrs.caretIcon = 'fas fa-caret-down';\n    attrs.defaultLabel = 'Custom';\n  }\n\n  view(vnode) {\n    return super.view({\n      ...vnode,\n      children: this.attrs.options.map(({ value, label }) => {\n        const active = app.data.settings[this.attrs.key] === value;\n\n        return Button.component(\n          {\n            icon: active ? 'fas fa-check' : true,\n            onclick: saveSettings.bind(this, { [this.attrs.key]: value }),\n            active,\n          },\n          label\n        );\n      }),\n    });\n  }\n}\n","import Component from '../../common/Component';\nimport PermissionDropdown from './PermissionDropdown';\nimport SettingDropdown from './SettingDropdown';\nimport Button from '../../common/components/Button';\nimport ItemList from '../../common/utils/ItemList';\nimport icon from '../../common/helpers/icon';\n\nexport default class PermissionGrid extends Component {\n  view() {\n    const scopes = this.scopeItems().toArray();\n\n    const permissionCells = (permission) => {\n      return scopes.map((scope) => <td>{scope.render(permission)}</td>);\n    };\n\n    return (\n      <table className=\"PermissionGrid\">\n        <thead>\n          <tr>\n            <td></td>\n            {scopes.map((scope) => (\n              <th>\n                {scope.label}{' '}\n                {scope.onremove\n                  ? Button.component({ icon: 'fas fa-times', className: 'Button Button--text PermissionGrid-removeScope', onclick: scope.onremove })\n                  : ''}\n              </th>\n            ))}\n            <th>{this.scopeControlItems().toArray()}</th>\n          </tr>\n        </thead>\n        {this.permissionItems()\n          .toArray()\n          .map((section) => (\n            <tbody>\n              <tr className=\"PermissionGrid-section\">\n                <th>{section.label}</th>\n                {permissionCells(section)}\n                <td />\n              </tr>\n              {section.children.map((child) => (\n                <tr className=\"PermissionGrid-child\">\n                  <th>\n                    {icon(child.icon)}\n                    {child.label}\n                  </th>\n                  {permissionCells(child)}\n                  <td />\n                </tr>\n              ))}\n            </tbody>\n          ))}\n      </table>\n    );\n  }\n\n  permissionItems() {\n    const items = new ItemList();\n\n    items.add(\n      'view',\n      {\n        label: app.translator.trans('core.admin.permissions.read_heading'),\n        children: this.viewItems().toArray(),\n      },\n      100\n    );\n\n    items.add(\n      'start',\n      {\n        label: app.translator.trans('core.admin.permissions.create_heading'),\n        children: this.startItems().toArray(),\n      },\n      90\n    );\n\n    items.add(\n      'reply',\n      {\n        label: app.translator.trans('core.admin.permissions.participate_heading'),\n        children: this.replyItems().toArray(),\n      },\n      80\n    );\n\n    items.add(\n      'moderate',\n      {\n        label: app.translator.trans('core.admin.permissions.moderate_heading'),\n        children: this.moderateItems().toArray(),\n      },\n      70\n    );\n\n    return items;\n  }\n\n  viewItems() {\n    const items = new ItemList();\n\n    items.add(\n      'viewDiscussions',\n      {\n        icon: 'fas fa-eye',\n        label: app.translator.trans('core.admin.permissions.view_discussions_label'),\n        permission: 'viewDiscussions',\n        allowGuest: true,\n      },\n      100\n    );\n\n    items.add(\n      'viewHiddenGroups',\n      {\n        icon: 'fas fa-users',\n        label: app.translator.trans('core.admin.permissions.view_hidden_groups_label'),\n        permission: 'viewHiddenGroups',\n      },\n      100\n    );\n\n    items.add(\n      'viewUserList',\n      {\n        icon: 'fas fa-users',\n        label: app.translator.trans('core.admin.permissions.view_user_list_label'),\n        permission: 'viewUserList',\n        allowGuest: true,\n      },\n      100\n    );\n\n    items.add(\n      'signUp',\n      {\n        icon: 'fas fa-user-plus',\n        label: app.translator.trans('core.admin.permissions.sign_up_label'),\n        setting: () =>\n          SettingDropdown.component({\n            key: 'allow_sign_up',\n            options: [\n              { value: '1', label: app.translator.trans('core.admin.permissions_controls.signup_open_button') },\n              { value: '0', label: app.translator.trans('core.admin.permissions_controls.signup_closed_button') },\n            ],\n          }),\n      },\n      90\n    );\n\n    items.add('viewLastSeenAt', {\n      icon: 'far fa-clock',\n      label: app.translator.trans('core.admin.permissions.view_last_seen_at_label'),\n      permission: 'user.viewLastSeenAt',\n    });\n\n    items.merge(app.extensionData.getAllExtensionPermissions('view'));\n\n    return items;\n  }\n\n  startItems() {\n    const items = new ItemList();\n\n    items.add(\n      'start',\n      {\n        icon: 'fas fa-edit',\n        label: app.translator.trans('core.admin.permissions.start_discussions_label'),\n        permission: 'startDiscussion',\n      },\n      100\n    );\n\n    items.add(\n      'allowRenaming',\n      {\n        icon: 'fas fa-i-cursor',\n        label: app.translator.trans('core.admin.permissions.allow_renaming_label'),\n        setting: () => {\n          const minutes = parseInt(app.data.settings.allow_renaming, 10);\n\n          return SettingDropdown.component({\n            defaultLabel: minutes\n              ? app.translator.transChoice('core.admin.permissions_controls.allow_some_minutes_button', minutes, { count: minutes })\n              : app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button'),\n            key: 'allow_renaming',\n            options: [\n              { value: '-1', label: app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button') },\n              { value: '10', label: app.translator.trans('core.admin.permissions_controls.allow_ten_minutes_button') },\n              { value: 'reply', label: app.translator.trans('core.admin.permissions_controls.allow_until_reply_button') },\n            ],\n          });\n        },\n      },\n      90\n    );\n\n    items.merge(app.extensionData.getAllExtensionPermissions('start'));\n\n    return items;\n  }\n\n  replyItems() {\n    const items = new ItemList();\n\n    items.add(\n      'reply',\n      {\n        icon: 'fas fa-reply',\n        label: app.translator.trans('core.admin.permissions.reply_to_discussions_label'),\n        permission: 'discussion.reply',\n      },\n      100\n    );\n\n    items.add(\n      'allowPostEditing',\n      {\n        icon: 'fas fa-pencil-alt',\n        label: app.translator.trans('core.admin.permissions.allow_post_editing_label'),\n        setting: () => {\n          const minutes = parseInt(app.data.settings.allow_post_editing, 10);\n\n          return SettingDropdown.component({\n            defaultLabel: minutes\n              ? app.translator.transChoice('core.admin.permissions_controls.allow_some_minutes_button', minutes, { count: minutes })\n              : app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button'),\n            key: 'allow_post_editing',\n            options: [\n              { value: '-1', label: app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button') },\n              { value: '10', label: app.translator.trans('core.admin.permissions_controls.allow_ten_minutes_button') },\n              { value: 'reply', label: app.translator.trans('core.admin.permissions_controls.allow_until_reply_button') },\n            ],\n          });\n        },\n      },\n      90\n    );\n\n    items.merge(app.extensionData.getAllExtensionPermissions('reply'));\n\n    return items;\n  }\n\n  moderateItems() {\n    const items = new ItemList();\n\n    items.add(\n      'viewIpsPosts',\n      {\n        icon: 'fas fa-bullseye',\n        label: app.translator.trans('core.admin.permissions.view_post_ips_label'),\n        permission: 'discussion.viewIpsPosts',\n      },\n      110\n    );\n\n    items.add(\n      'renameDiscussions',\n      {\n        icon: 'fas fa-i-cursor',\n        label: app.translator.trans('core.admin.permissions.rename_discussions_label'),\n        permission: 'discussion.rename',\n      },\n      100\n    );\n\n    items.add(\n      'hideDiscussions',\n      {\n        icon: 'far fa-trash-alt',\n        label: app.translator.trans('core.admin.permissions.delete_discussions_label'),\n        permission: 'discussion.hide',\n      },\n      90\n    );\n\n    items.add(\n      'deleteDiscussions',\n      {\n        icon: 'fas fa-times',\n        label: app.translator.trans('core.admin.permissions.delete_discussions_forever_label'),\n        permission: 'discussion.delete',\n      },\n      80\n    );\n\n    items.add(\n      'postWithoutThrottle',\n      {\n        icon: 'fas fa-swimmer',\n        label: app.translator.trans('core.admin.permissions.post_without_throttle_label'),\n        permission: 'postWithoutThrottle',\n      },\n      70\n    );\n\n    items.add(\n      'editPosts',\n      {\n        icon: 'fas fa-pencil-alt',\n        label: app.translator.trans('core.admin.permissions.edit_posts_label'),\n        permission: 'discussion.editPosts',\n      },\n      70\n    );\n\n    items.add(\n      'hidePosts',\n      {\n        icon: 'far fa-trash-alt',\n        label: app.translator.trans('core.admin.permissions.delete_posts_label'),\n        permission: 'discussion.hidePosts',\n      },\n      60\n    );\n\n    items.add(\n      'deletePosts',\n      {\n        icon: 'fas fa-times',\n        label: app.translator.trans('core.admin.permissions.delete_posts_forever_label'),\n        permission: 'discussion.deletePosts',\n      },\n      60\n    );\n\n    items.add(\n      'userEditCredentials',\n      {\n        icon: 'fas fa-user-cog',\n        label: app.translator.trans('core.admin.permissions.edit_users_credentials_label'),\n        permission: 'user.editCredentials',\n      },\n      60\n    );\n\n    items.add(\n      'userEditGroups',\n      {\n        icon: 'fas fa-users-cog',\n        label: app.translator.trans('core.admin.permissions.edit_users_groups_label'),\n        permission: 'user.editGroups',\n      },\n      60\n    );\n\n    items.add(\n      'userEdit',\n      {\n        icon: 'fas fa-address-card',\n        label: app.translator.trans('core.admin.permissions.edit_users_label'),\n        permission: 'user.edit',\n      },\n      60\n    );\n\n    items.merge(app.extensionData.getAllExtensionPermissions('moderate'));\n\n    return items;\n  }\n\n  scopeItems() {\n    const items = new ItemList();\n\n    items.add(\n      'global',\n      {\n        label: app.translator.trans('core.admin.permissions.global_heading'),\n        render: (item) => {\n          if (item.setting) {\n            return item.setting();\n          } else if (item.permission) {\n            return PermissionDropdown.component({\n              permission: item.permission,\n              allowGuest: item.allowGuest,\n            });\n          }\n\n          return '';\n        },\n      },\n      100\n    );\n\n    return items;\n  }\n\n  scopeControlItems() {\n    return new ItemList();\n  }\n}\n","import GroupBadge from '../../common/components/GroupBadge';\nimport EditGroupModal from './EditGroupModal';\nimport Group from '../../common/models/Group';\nimport icon from '../../common/helpers/icon';\nimport PermissionGrid from './PermissionGrid';\nimport AdminPage from './AdminPage';\n\nexport default class PermissionsPage extends AdminPage {\n  headerInfo() {\n    return {\n      className: 'PermissionsPage',\n      icon: 'fas fa-key',\n      title: app.translator.trans('core.admin.permissions.title'),\n      description: app.translator.trans('core.admin.permissions.description'),\n    };\n  }\n\n  content() {\n    return [\n      <div className=\"PermissionsPage-groups\">\n        {app.store\n          .all('groups')\n          .filter((group) => [Group.GUEST_ID, Group.MEMBER_ID].indexOf(group.id()) === -1)\n          .map((group) => (\n            <button className=\"Button Group\" onclick={() => app.modal.show(EditGroupModal, { group })}>\n              {GroupBadge.component({\n                group,\n                className: 'Group-icon',\n                label: null,\n              })}\n              <span className=\"Group-name\">{group.namePlural()}</span>\n            </button>\n          ))}\n        <button className=\"Button Group Group--add\" onclick={() => app.modal.show(EditGroupModal)}>\n          {icon('fas fa-plus', { className: 'Group-icon' })}\n          <span className=\"Group-name\">{app.translator.trans('core.admin.permissions.new_group_button')}</span>\n        </button>\n      </div>,\n\n      <div className=\"PermissionsPage-permissions\">{PermissionGrid.component()}</div>,\n    ];\n  }\n}\n","import Modal from '../../common/components/Modal';\nimport Button from '../../common/components/Button';\nimport Stream from '../../common/utils/Stream';\nimport saveSettings from '../utils/saveSettings';\n\nexport default class SettingsModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.settings = {};\n    this.loading = false;\n  }\n\n  form() {\n    return '';\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">\n          {this.form()}\n\n          <div className=\"Form-group\">{this.submitButton()}</div>\n        </div>\n      </div>\n    );\n  }\n\n  submitButton() {\n    return (\n      <Button type=\"submit\" className=\"Button Button--primary\" loading={this.loading} disabled={!this.changed()}>\n        {app.translator.trans('core.admin.settings.submit_button')}\n      </Button>\n    );\n  }\n\n  setting(key, fallback = '') {\n    this.settings[key] = this.settings[key] || Stream(app.data.settings[key] || fallback);\n\n    return this.settings[key];\n  }\n\n  dirty() {\n    const dirty = {};\n\n    Object.keys(this.settings).forEach((key) => {\n      const value = this.settings[key]();\n\n      if (value !== app.data.settings[key]) {\n        dirty[key] = value;\n      }\n    });\n\n    return dirty;\n  }\n\n  changed() {\n    return Object.keys(this.dirty()).length;\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    saveSettings(this.dirty()).then(this.onsaved.bind(this), this.loaded.bind(this));\n  }\n\n  onsaved() {\n    this.hide();\n  }\n}\n","import SettingsModal from './SettingsModal';\n\nexport default class EditCustomCssModal extends SettingsModal {\n  className() {\n    return 'EditCustomCssModal Modal--large';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.edit_css.title');\n  }\n\n  form() {\n    return [\n      <p>\n        {app.translator.trans('core.admin.edit_css.customize_text', {\n          a: <a href=\"https://github.com/flarum/core/tree/master/less\" target=\"_blank\" />,\n        })}\n      </p>,\n      <div className=\"Form-group\">\n        <textarea className=\"FormControl\" rows=\"30\" bidi={this.setting('custom_less')} />\n      </div>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n}\n","import SettingsModal from './SettingsModal';\n\nexport default class EditCustomHeaderModal extends SettingsModal {\n  className() {\n    return 'EditCustomHeaderModal Modal--large';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.edit_header.title');\n  }\n\n  form() {\n    return [\n      <p>{app.translator.trans('core.admin.edit_header.customize_text')}</p>,\n      <div className=\"Form-group\">\n        <textarea className=\"FormControl\" rows=\"30\" bidi={this.setting('custom_header')} />\n      </div>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n}\n","import SettingsModal from './SettingsModal';\n\nexport default class EditCustomFooterModal extends SettingsModal {\n  className() {\n    return 'EditCustomFooterModal Modal--large';\n  }\n\n  title() {\n    return app.translator.trans('core.admin.edit_footer.title');\n  }\n\n  form() {\n    return [\n      <p>{app.translator.trans('core.admin.edit_footer.customize_text')}</p>,\n      <div className=\"Form-group\">\n        <textarea className=\"FormControl\" rows=\"30\" bidi={this.setting('custom_footer')} />\n      </div>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n}\n","import Button from '../../common/components/Button';\n\nexport default class UploadImageButton extends Button {\n  loading = false;\n\n  view(vnode) {\n    this.attrs.loading = this.loading;\n    this.attrs.className = (this.attrs.className || '') + ' Button';\n\n    if (app.data.settings[this.attrs.name + '_path']) {\n      this.attrs.onclick = this.remove.bind(this);\n\n      return (\n        <div>\n          <p>\n            <img src={app.forum.attribute(this.attrs.name + 'Url')} alt=\"\" />\n          </p>\n          <p>{super.view({ ...vnode, children: app.translator.trans('core.admin.upload_image.remove_button') })}</p>\n        </div>\n      );\n    } else {\n      this.attrs.onclick = this.upload.bind(this);\n    }\n\n    return super.view({ ...vnode, children: app.translator.trans('core.admin.upload_image.upload_button') });\n  }\n\n  /**\n   * Prompt the user to upload an image.\n   */\n  upload() {\n    if (this.loading) return;\n\n    const $input = $('<input type=\"file\">');\n\n    $input\n      .appendTo('body')\n      .hide()\n      .click()\n      .on('change', (e) => {\n        const body = new FormData();\n        body.append(this.attrs.name, $(e.target)[0].files[0]);\n\n        this.loading = true;\n        m.redraw();\n\n        app\n          .request({\n            method: 'POST',\n            url: this.resourceUrl(),\n            serialize: (raw) => raw,\n            body,\n          })\n          .then(this.success.bind(this), this.failure.bind(this));\n      });\n  }\n\n  /**\n   * Remove the logo.\n   */\n  remove() {\n    this.loading = true;\n    m.redraw();\n\n    app\n      .request({\n        method: 'DELETE',\n        url: this.resourceUrl(),\n      })\n      .then(this.success.bind(this), this.failure.bind(this));\n  }\n\n  resourceUrl() {\n    return app.forum.attribute('apiUrl') + '/' + this.attrs.name;\n  }\n\n  /**\n   * After a successful upload/removal, reload the page.\n   *\n   * @param {Object} response\n   * @protected\n   */\n  success(response) {\n    window.location.reload();\n  }\n\n  /**\n   * If upload/removal fails, stop loading.\n   *\n   * @param {Object} response\n   * @protected\n   */\n  failure(response) {\n    this.loading = false;\n    m.redraw();\n  }\n}\n","import Button from '../../common/components/Button';\nimport EditCustomCssModal from './EditCustomCssModal';\nimport EditCustomHeaderModal from './EditCustomHeaderModal';\nimport EditCustomFooterModal from './EditCustomFooterModal';\nimport UploadImageButton from './UploadImageButton';\nimport AdminPage from './AdminPage';\n\nexport default class AppearancePage extends AdminPage {\n  headerInfo() {\n    return {\n      className: 'AppearancePage',\n      icon: 'fas fa-paint-brush',\n      title: app.translator.trans('core.admin.appearance.title'),\n      description: app.translator.trans('core.admin.appearance.description'),\n    };\n  }\n\n  content() {\n    return [\n      <div className=\"Form\">\n        <fieldset className=\"AppearancePage-colors\">\n          <legend>{app.translator.trans('core.admin.appearance.colors_heading')}</legend>\n          <div className=\"helpText\">{app.translator.trans('core.admin.appearance.colors_text')}</div>\n\n          <div className=\"AppearancePage-colors-input\">\n            {this.buildSettingComponent({\n              type: 'text',\n              setting: 'theme_primary_color',\n              placeholder: '#aaaaaa',\n            })}\n            {this.buildSettingComponent({\n              type: 'text',\n              setting: 'theme_secondary_color',\n              placeholder: '#aaaaaa',\n            })}\n          </div>\n\n          {this.buildSettingComponent({\n            type: 'switch',\n            setting: 'theme_dark_mode',\n            label: app.translator.trans('core.admin.appearance.dark_mode_label'),\n          })}\n\n          {this.buildSettingComponent({\n            type: 'switch',\n            setting: 'theme_colored_header',\n            label: app.translator.trans('core.admin.appearance.colored_header_label'),\n          })}\n\n          {this.submitButton()}\n        </fieldset>\n      </div>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.logo_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.logo_text')}</div>\n        <UploadImageButton name=\"logo\" />\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.favicon_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.favicon_text')}</div>\n        <UploadImageButton name=\"favicon\" />\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.custom_header_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.custom_header_text')}</div>\n        {Button.component(\n          {\n            className: 'Button',\n            onclick: () => app.modal.show(EditCustomHeaderModal),\n          },\n          app.translator.trans('core.admin.appearance.edit_header_button')\n        )}\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.custom_footer_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.custom_footer_text')}</div>\n        {Button.component(\n          {\n            className: 'Button',\n            onclick: () => app.modal.show(EditCustomFooterModal),\n          },\n          app.translator.trans('core.admin.appearance.edit_footer_button')\n        )}\n      </fieldset>,\n\n      <fieldset>\n        <legend>{app.translator.trans('core.admin.appearance.custom_styles_heading')}</legend>\n        <div className=\"helpText\">{app.translator.trans('core.admin.appearance.custom_styles_text')}</div>\n        {Button.component(\n          {\n            className: 'Button',\n            onclick: () => app.modal.show(EditCustomCssModal),\n          },\n          app.translator.trans('core.admin.appearance.edit_css_button')\n        )}\n      </fieldset>,\n    ];\n  }\n\n  onsaved() {\n    window.location.reload();\n  }\n\n  saveSettings(e) {\n    e.preventDefault();\n\n    const hex = /^#[0-9a-f]{3}([0-9a-f]{3})?$/i;\n\n    if (!hex.test(this.settings['theme_primary_color']()) || !hex.test(this.settings['theme_secondary_color']())) {\n      alert(app.translator.trans('core.admin.appearance.enter_hex_message'));\n      return;\n    }\n\n    super.saveSettings(e);\n  }\n}\n","import FieldSet from '../../common/components/FieldSet';\nimport Button from '../../common/components/Button';\nimport Alert from '../../common/components/Alert';\nimport LoadingIndicator from '../../common/components/LoadingIndicator';\nimport AdminPage from './AdminPage';\n\nexport default class MailPage extends AdminPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.sendingTest = false;\n    this.refresh();\n  }\n\n  headerInfo() {\n    return {\n      className: 'MailPage',\n      icon: 'fas fa-envelope',\n      title: app.translator.trans('core.admin.email.title'),\n      description: app.translator.trans('core.admin.email.description'),\n    };\n  }\n\n  refresh() {\n    this.loading = true;\n\n    this.status = { sending: false, errors: {} };\n\n    app\n      .request({\n        method: 'GET',\n        url: app.forum.attribute('apiUrl') + '/mail/settings',\n      })\n      .then((response) => {\n        this.driverFields = response['data']['attributes']['fields'];\n        this.status.sending = response['data']['attributes']['sending'];\n        this.status.errors = response['data']['attributes']['errors'];\n\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  content() {\n    if (this.loading) {\n      return <LoadingIndicator />;\n    }\n\n    const fields = this.driverFields[this.setting('mail_driver')()];\n    const fieldKeys = Object.keys(fields);\n\n    return (\n      <div className=\"Form\">\n        {this.buildSettingComponent({\n          type: 'text',\n          setting: 'mail_from',\n          label: app.translator.trans('core.admin.email.addresses_heading'),\n          className: 'MailPage-MailSettings',\n        })}\n        {this.buildSettingComponent({\n          type: 'select',\n          setting: 'mail_driver',\n          options: Object.keys(this.driverFields).reduce((memo, val) => ({ ...memo, [val]: val }), {}),\n          label: app.translator.trans('core.admin.email.driver_heading'),\n          className: 'MailPage-MailSettings',\n        })}\n        {this.status.sending ||\n          Alert.component(\n            {\n              dismissible: false,\n            },\n            app.translator.trans('core.admin.email.not_sending_message')\n          )}\n\n        {fieldKeys.length > 0 && (\n          <FieldSet label={app.translator.trans(`core.admin.email.${this.setting('mail_driver')()}_heading`)} className=\"MailPage-MailSettings\">\n            <div className=\"MailPage-MailSettings-input\">\n              {fieldKeys.map((field) => {\n                const fieldInfo = fields[field];\n\n                return [\n                  this.buildSettingComponent({\n                    type: typeof this.setting(field)() === 'string' ? 'text' : 'select',\n                    label: app.translator.trans(`core.admin.email.${field}_label`),\n                    setting: field,\n                    options: fieldInfo,\n                  }),\n                  this.status.errors[field] && <p className=\"ValidationError\">{this.status.errors[field]}</p>,\n                ];\n              })}\n            </div>\n          </FieldSet>\n        )}\n        {this.submitButton()}\n\n        <FieldSet label={app.translator.trans('core.admin.email.send_test_mail_heading')} className=\"MailPage-MailSettings\">\n          <div className=\"helpText\">{app.translator.trans('core.admin.email.send_test_mail_text', { email: app.session.user.email() })}</div>\n          {Button.component(\n            {\n              className: 'Button Button--primary',\n              disabled: this.sendingTest || this.isChanged(),\n              onclick: () => this.sendTestEmail(),\n            },\n            app.translator.trans('core.admin.email.send_test_mail_button')\n          )}\n        </FieldSet>\n      </div>\n    );\n  }\n\n  sendTestEmail() {\n    if (this.saving || this.sendingTest) return;\n\n    this.sendingTest = true;\n    app.alerts.dismiss(this.testEmailSuccessAlert);\n\n    app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/mail/test',\n      })\n      .then((response) => {\n        this.sendingTest = false;\n        this.testEmailSuccessAlert = app.alerts.show({ type: 'success' }, app.translator.trans('core.admin.email.send_test_mail_success'));\n      })\n      .catch((error) => {\n        this.sendingTest = false;\n        m.redraw();\n        throw error;\n      });\n  }\n\n  saveSettings(e) {\n    super.saveSettings(e).then(this.refresh());\n  }\n}\n","import PermissionGrid from './PermissionGrid';\nimport Button from '../../common/components/Button';\nimport ItemList from '../../common/utils/ItemList';\n\nexport default class ExtensionPermissionGrid extends PermissionGrid {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.extensionId = this.attrs.extensionId;\n  }\n\n  permissionItems() {\n    const permissionCategories = super.permissionItems();\n\n    permissionCategories.items = Object.entries(permissionCategories.items)\n      .filter(([category, info]) => info.content.children.length > 0)\n      .reduce((obj, [category, info]) => {\n        obj[category] = info;\n        return obj;\n      }, {});\n\n    return permissionCategories;\n  }\n\n  viewItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'view') || new ItemList();\n  }\n\n  startItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'start') || new ItemList();\n  }\n\n  replyItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'reply') || new ItemList();\n  }\n\n  moderateItems() {\n    return app.extensionData.getExtensionPermissions(this.extensionId, 'moderate') || new ItemList();\n  }\n\n  scopeControlItems() {\n    const items = new ItemList();\n\n    items.add(\n      'configureScopes',\n      <Button className=\"Button Button--text\" onclick={() => m.route.set(app.route('permissions'))}>\n        {app.translator.trans('core.admin.extension.configure_scopes')}\n      </Button>\n    );\n\n    return items;\n  }\n}\n","import Button from '../../common/components/Button';\nimport Link from '../../common/components/Link';\nimport LinkButton from '../../common/components/LinkButton';\nimport Switch from '../../common/components/Switch';\nimport icon from '../../common/helpers/icon';\nimport punctuateSeries from '../../common/helpers/punctuateSeries';\nimport listItems from '../../common/helpers/listItems';\nimport ItemList from '../../common/utils/ItemList';\nimport LoadingModal from './LoadingModal';\nimport ExtensionPermissionGrid from './ExtensionPermissionGrid';\nimport isExtensionEnabled from '../utils/isExtensionEnabled';\nimport AdminPage from './AdminPage';\n\nexport default class ExtensionPage extends AdminPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.extension = app.data.extensions[this.attrs.id];\n    this.changingState = false;\n\n    this.infoFields = {\n      discuss: 'fas fa-comment-alt',\n      documentation: 'fas fa-book',\n      support: 'fas fa-life-ring',\n      website: 'fas fa-link',\n      donate: 'fas fa-donate',\n      source: 'fas fa-code',\n    };\n\n    if (!this.extension) {\n      return m.route.set(app.route('dashboard'));\n    }\n  }\n\n  className() {\n    if (!this.extension) return '';\n\n    return this.extension.id + '-Page';\n  }\n\n  view() {\n    if (!this.extension) return null;\n\n    return (\n      <div className={'ExtensionPage ' + this.className()}>\n        {this.header()}\n        {!this.isEnabled() ? (\n          <div className=\"container\">\n            <h3 className=\"ExtensionPage-subHeader\">{app.translator.trans('core.admin.extension.enable_to_see')}</h3>\n          </div>\n        ) : (\n          <div className=\"ExtensionPage-body\">{this.sections().toArray()}</div>\n        )}\n      </div>\n    );\n  }\n\n  header() {\n    const isEnabled = this.isEnabled();\n\n    return [\n      <div className=\"ExtensionPage-header\">\n        <div className=\"container\">\n          <div className=\"ExtensionTitle\">\n            <span className=\"ExtensionIcon\" style={this.extension.icon}>\n              {this.extension.icon ? icon(this.extension.icon.name) : ''}\n            </span>\n            <div className=\"ExtensionName\">\n              <h2>{this.extension.extra['flarum-extension'].title}</h2>\n            </div>\n            <div className=\"ExtensionPage-headerTopItems\">\n              <ul>{listItems(this.topItems().toArray())}</ul>\n            </div>\n          </div>\n          <div className=\"helpText\">{this.extension.description}</div>\n          <div className=\"ExtensionPage-headerItems\">\n            <Switch\n              state={this.changingState ? !isEnabled : isEnabled}\n              loading={this.changingState}\n              onchange={this.toggle.bind(this, this.extension.id)}\n            >\n              {isEnabled ? app.translator.trans('core.admin.extension.enabled') : app.translator.trans('core.admin.extension.disabled')}\n            </Switch>\n            <aside className=\"ExtensionInfo\">\n              <ul>{listItems(this.infoItems().toArray())}</ul>\n            </aside>\n          </div>\n        </div>\n      </div>,\n    ];\n  }\n\n  sections() {\n    const items = new ItemList();\n\n    items.add('content', this.content());\n\n    items.add('permissions', [\n      <div className=\"ExtensionPage-permissions\">\n        <div className=\"ExtensionPage-permissions-header\">\n          <div className=\"container\">\n            <h2 className=\"ExtensionTitle\">{app.translator.trans('core.admin.extension.permissions_title')}</h2>\n          </div>\n        </div>\n        <div className=\"container\">\n          {app.extensionData.extensionHasPermissions(this.extension.id) ? (\n            ExtensionPermissionGrid.component({ extensionId: this.extension.id })\n          ) : (\n            <h3 className=\"ExtensionPage-subHeader\">{app.translator.trans('core.admin.extension.no_permissions')}</h3>\n          )}\n        </div>\n      </div>,\n    ]);\n\n    return items;\n  }\n\n  content() {\n    const settings = app.extensionData.getSettings(this.extension.id);\n\n    return (\n      <div className=\"ExtensionPage-settings\">\n        <div className=\"container\">\n          {settings ? (\n            <div className=\"Form\">\n              {settings.map(this.buildSettingComponent.bind(this))}\n              <div className=\"Form-group\">{this.submitButton()}</div>\n            </div>\n          ) : (\n            <h3 className=\"ExtensionPage-subHeader\">{app.translator.trans('core.admin.extension.no_settings')}</h3>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  topItems() {\n    const items = new ItemList();\n\n    items.add('version', <span className=\"ExtensionVersion\">{this.extension.version}</span>);\n\n    if (!this.isEnabled()) {\n      const uninstall = () => {\n        if (confirm(app.translator.trans('core.admin.extension.confirm_uninstall'))) {\n          app\n            .request({\n              url: app.forum.attribute('apiUrl') + '/extensions/' + this.extension.id,\n              method: 'DELETE',\n            })\n            .then(() => window.location.reload());\n\n          app.modal.show(LoadingModal);\n        }\n      };\n\n      items.add(\n        'uninstall',\n        <Button icon=\"fas fa-trash-alt\" className=\"Button Button--primary\" onclick={uninstall.bind(this)}>\n          {app.translator.trans('core.admin.extension.uninstall_button')}\n        </Button>\n      );\n    }\n\n    return items;\n  }\n\n  infoItems() {\n    const items = new ItemList();\n\n    const links = this.extension.links;\n\n    if (links.authors.length) {\n      let authors = [];\n\n      links.authors.map((author) => {\n        authors.push(\n          <Link href={author.link} external={true} target=\"_blank\">\n            {author.name}\n          </Link>\n        );\n      });\n\n      items.add('authors', [icon('fas fa-user'), <span>{punctuateSeries(authors)}</span>]);\n    }\n\n    Object.keys(this.infoFields).map((field) => {\n      if (links[field]) {\n        items.add(\n          field,\n          <LinkButton href={links[field]} icon={this.infoFields[field]} external={true} target=\"_blank\">\n            {app.translator.trans(`core.admin.extension.info_links.${field}`)}\n          </LinkButton>\n        );\n      }\n    });\n\n    return items;\n  }\n\n  toggle() {\n    const enabled = this.isEnabled();\n\n    this.changingState = true;\n\n    app\n      .request({\n        url: app.forum.attribute('apiUrl') + '/extensions/' + this.extension.id,\n        method: 'PATCH',\n        body: { enabled: !enabled },\n        errorHandler: this.onerror.bind(this),\n      })\n      .then(() => {\n        if (!enabled) localStorage.setItem('enabledExtension', this.extension.id);\n        window.location.reload();\n      });\n\n    app.modal.show(LoadingModal);\n  }\n\n  isEnabled() {\n    return isExtensionEnabled(this.extension.id);\n  }\n\n  onerror(e) {\n    // We need to give the modal animation time to start; if we close the modal too early,\n    // it breaks the bootstrap modal library.\n    // TODO: This workaround should be removed when we move away from bootstrap JS for modals.\n    setTimeout(() => {\n      app.modal.close();\n    }, 300); // Bootstrap's Modal.TRANSITION_DURATION is 300 ms.\n\n    this.changingState = false;\n\n    if (e.status !== 409) {\n      throw e;\n    }\n\n    const error = e.response.errors[0];\n\n    app.alerts.show(\n      { type: 'error' },\n      app.translator.trans(`core.lib.error.${error.code}_message`, {\n        extension: error.extension,\n        extensions: error.extensions.join(', '),\n      })\n    );\n  }\n}\n","import DefaultResolver from '../../common/resolvers/DefaultResolver';\n\n/**\n * A custom route resolver for ExtensionPage that generates handles routes\n * to default extension pages or a page provided by an extension.\n */\nexport default class ExtensionPageResolver extends DefaultResolver {\n  static extension: string | null = null;\n\n  onmatch(args, requestedPath, route) {\n    const extensionPage = app.extensionData.getPage(args.id);\n\n    if (extensionPage) {\n      return extensionPage;\n    }\n\n    return super.onmatch(args, requestedPath, route);\n  }\n}\n","import DashboardPage from './components/DashboardPage';\nimport BasicsPage from './components/BasicsPage';\nimport PermissionsPage from './components/PermissionsPage';\nimport AppearancePage from './components/AppearancePage';\nimport MailPage from './components/MailPage';\nimport ExtensionPage from './components/ExtensionPage';\nimport ExtensionPageResolver from './resolvers/ExtensionPageResolver';\n\n/**\n * The `routes` initializer defines the forum app's routes.\n *\n * @param {App} app\n */\nexport default function (app) {\n  app.routes = {\n    dashboard: { path: '/', component: DashboardPage },\n    basics: { path: '/basics', component: BasicsPage },\n    permissions: { path: '/permissions', component: PermissionsPage },\n    appearance: { path: '/appearance', component: AppearancePage },\n    mail: { path: '/mail', component: MailPage },\n    extension: { path: '/extension/:id', component: ExtensionPage, resolverClass: ExtensionPageResolver },\n  };\n}\n","import isExtensionEnabled from '../utils/isExtensionEnabled';\nimport LinkButton from '../../common/components/LinkButton';\nimport icon from '../../common/helpers/icon';\nimport ItemList from '../../common/utils/ItemList';\n\nexport default class ExtensionLinkButton extends LinkButton {\n  getButtonContent(children) {\n    const content = super.getButtonContent(children);\n    const extension = app.data.extensions[this.attrs.extensionId];\n    const statuses = this.statusItems(extension.id).toArray();\n\n    content.unshift(\n      <span className=\"ExtensionListItem-icon ExtensionIcon\" style={extension.icon}>\n        {extension.icon ? icon(extension.icon.name) : ''}\n      </span>\n    );\n    content.push(statuses);\n\n    return content;\n  }\n\n  statusItems(name) {\n    const items = new ItemList();\n\n    items.add('enabled', <span class={'ExtensionListItem-Dot ' + (isExtensionEnabled(name) ? 'enabled' : 'disabled')} />);\n\n    return items;\n  }\n}\n","import ExtensionLinkButton from './ExtensionLinkButton';\nimport Component from '../../common/Component';\nimport LinkButton from '../../common/components/LinkButton';\nimport SelectDropdown from '../../common/components/SelectDropdown';\nimport getCategorizedExtensions from '../utils/getCategorizedExtensions';\nimport ItemList from '../../common/utils/ItemList';\nimport Stream from '../../common/utils/Stream';\n\nexport default class AdminNav extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.query = Stream('');\n  }\n\n  view() {\n    return (\n      <SelectDropdown className=\"AdminNav App-titleControl AdminNav-Main\" buttonClassName=\"Button\">\n        {this.items().toArray().concat(this.extensionItems().toArray())}\n      </SelectDropdown>\n    );\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.scrollToActive();\n  }\n\n  onupdate() {\n    this.scrollToActive();\n  }\n\n  scrollToActive() {\n    const children = $('.Dropdown-menu').children('.active');\n    const nav = $('#admin-navigation');\n    const time = app.previous.type ? 250 : 0;\n\n    if (\n      children.length > 0 &&\n      (children[0].offsetTop > nav.scrollTop() + nav.outerHeight() || children[0].offsetTop + children[0].offsetHeight < nav.scrollTop())\n    ) {\n      nav.animate(\n        {\n          scrollTop: children[0].offsetTop - nav.height() / 2,\n        },\n        time\n      );\n    }\n  }\n\n  /**\n   * Build an item list of main links to show in the admin navigation.\n   *\n   * @return {ItemList}\n   */\n  items() {\n    const items = new ItemList();\n\n    items.add('category-core', <h4 className=\"ExtensionListTitle\">{app.translator.trans('core.admin.nav.categories.core')}</h4>);\n\n    items.add(\n      'dashboard',\n      <LinkButton href={app.route('dashboard')} icon=\"far fa-chart-bar\" title={app.translator.trans('core.admin.nav.dashboard_title')}>\n        {app.translator.trans('core.admin.nav.dashboard_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'basics',\n      <LinkButton href={app.route('basics')} icon=\"fas fa-pencil-alt\" title={app.translator.trans('core.admin.nav.basics_title')}>\n        {app.translator.trans('core.admin.nav.basics_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'mail',\n      <LinkButton href={app.route('mail')} icon=\"fas fa-envelope\" title={app.translator.trans('core.admin.nav.email_title')}>\n        {app.translator.trans('core.admin.nav.email_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'permissions',\n      <LinkButton href={app.route('permissions')} icon=\"fas fa-key\" title={app.translator.trans('core.admin.nav.permissions_title')}>\n        {app.translator.trans('core.admin.nav.permissions_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'appearance',\n      <LinkButton href={app.route('appearance')} icon=\"fas fa-paint-brush\" title={app.translator.trans('core.admin.nav.appearance_title')}>\n        {app.translator.trans('core.admin.nav.appearance_button')}\n      </LinkButton>\n    );\n\n    items.add(\n      'search',\n      <div className=\"Search-input\">\n        <input\n          className=\"FormControl SearchBar\"\n          bidi={this.query}\n          type=\"search\"\n          placeholder={app.translator.trans('core.admin.nav.search_placeholder')}\n        />\n      </div>\n    );\n\n    return items;\n  }\n\n  extensionItems() {\n    const items = new ItemList();\n\n    const categorizedExtensions = getCategorizedExtensions();\n    const categories = app.extensionCategories;\n\n    Object.keys(categorizedExtensions).map((category) => {\n      if (!this.query()) {\n        items.add(\n          `category-${category}`,\n          <h4 className=\"ExtensionListTitle\">{app.translator.trans(`core.admin.nav.categories.${category}`)}</h4>,\n          categories[category]\n        );\n      }\n\n      categorizedExtensions[category].map((extension) => {\n        const query = this.query().toUpperCase();\n        const title = extension.extra['flarum-extension'].title || '';\n        const description = extension.description || '';\n\n        if (!query || title.toUpperCase().includes(query) || description.toUpperCase().includes(query)) {\n          items.add(\n            `extension-${extension.id}`,\n            <ExtensionLinkButton\n              href={app.route('extension', { id: extension.id })}\n              extensionId={extension.id}\n              className=\"ExtensionNavButton\"\n              title={description}\n            >\n              {title}\n            </ExtensionLinkButton>,\n            categories[category]\n          );\n        }\n      });\n    });\n\n    return items;\n  }\n}\n","import ItemList from '../../common/utils/ItemList';\n\nexport default class ExtensionData {\n  constructor() {\n    this.data = {};\n    this.currentExtension = null;\n  }\n\n  /**\n   * This function simply takes the extension id\n   *\n   * @example\n   * app.extensionData.load('flarum-tags')\n   *\n   * flarum/flags -> flarum-flags | acme/extension -> acme-extension\n   *\n   * @param extension\n   */\n  for(extension) {\n    this.currentExtension = extension;\n    this.data[extension] = this.data[extension] || {};\n\n    return this;\n  }\n\n  /**\n   * This function registers your settings with Flarum\n   *\n   * It takes either a settings object or a callback.\n   *\n   * @example\n   *\n   * .registerSetting({\n   *   setting: 'flarum-flags.guidelines_url',\n   *   type: 'text', // This will be inputted into the input tag for the setting (text/number/etc)\n   *   label: app.translator.trans('flarum-flags.admin.settings.guidelines_url_label')\n   * }, 15) // priority is optional (ItemList)\n   *\n   *\n   * @param content\n   * @param priority\n   * @returns {ExtensionData}\n   */\n  registerSetting(content, priority = 0) {\n    this.data[this.currentExtension].settings = this.data[this.currentExtension].settings || new ItemList();\n\n    // Callbacks can be passed in instead of settings to display custom content.\n    // By default, they will be added with the `null` key, since they don't have a `.setting` attr.\n    // To support multiple such items for one extension, we assign a random ID.\n    // 36 is arbitrary length, but makes collisions very unlikely.\n    if (typeof content === 'function') {\n      content.setting = Math.random().toString(36);\n    }\n\n    this.data[this.currentExtension].settings.add(content.setting, content, priority);\n\n    return this;\n  }\n\n  /**\n   * This function registers your permission with Flarum\n   *\n   * @example\n   *\n   * .registerPermission('permissions', {\n   *     icon: 'fas fa-flag',\n   *     label: app.translator.trans('flarum-flags.admin.permissions.view_flags_label'),\n   *     permission: 'discussion.viewFlags'\n   * }, 'moderate', 65)\n   *\n   * @param content\n   * @param permissionType\n   * @param priority\n   * @returns {ExtensionData}\n   */\n  registerPermission(content, permissionType = null, priority = 0) {\n    this.data[this.currentExtension].permissions = this.data[this.currentExtension].permissions || {};\n\n    if (!this.data[this.currentExtension].permissions[permissionType]) {\n      this.data[this.currentExtension].permissions[permissionType] = new ItemList();\n    }\n\n    this.data[this.currentExtension].permissions[permissionType].add(content.permission, content, priority);\n\n    return this;\n  }\n\n  /**\n   * Replace the default extension page with a custom component.\n   * This component would typically extend ExtensionPage\n   *\n   * @param component\n   * @returns {ExtensionData}\n   */\n  registerPage(component) {\n    this.data[this.currentExtension].page = component;\n\n    return this;\n  }\n\n  /**\n   * Get an extension's registered settings\n   *\n   * @param extensionId\n   * @returns {boolean|*}\n   */\n  getSettings(extensionId) {\n    if (this.data[extensionId] && this.data[extensionId].settings) {\n      return this.data[extensionId].settings.toArray();\n    }\n\n    return false;\n  }\n\n  /**\n   *\n   * Get an ItemList of all extensions' registered permissions\n   *\n   * @param extension\n   * @param type\n   * @returns {ItemList}\n   */\n  getAllExtensionPermissions(type) {\n    const items = new ItemList();\n\n    Object.keys(this.data).map((extension) => {\n      if (this.extensionHasPermissions(extension) && this.data[extension].permissions[type]) {\n        items.merge(this.data[extension].permissions[type]);\n      }\n    });\n\n    return items;\n  }\n\n  /**\n   * Get a singular extension's registered permissions\n   *\n   * @param extension\n   * @param type\n   * @returns {boolean|*}\n   */\n  getExtensionPermissions(extension, type) {\n    if (this.extensionHasPermissions(extension) && this.data[extension].permissions[type]) {\n      return this.data[extension].permissions[type];\n    }\n\n    return new ItemList();\n  }\n\n  /**\n   * Checks whether a given extension has registered permissions.\n   *\n   * @param extension\n   * @returns {boolean}\n   */\n  extensionHasPermissions(extension) {\n    if (this.data[extension] && this.data[extension].permissions) {\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Returns an extension's custom page component if it exists.\n   *\n   * @param extension\n   * @returns {boolean|*}\n   */\n  getPage(extension) {\n    if (this.data[extension]) {\n      return this.data[extension].page;\n    }\n\n    return false;\n  }\n}\n","import HeaderPrimary from './components/HeaderPrimary';\nimport HeaderSecondary from './components/HeaderSecondary';\nimport routes from './routes';\nimport Application from '../common/Application';\nimport Navigation from '../common/components/Navigation';\nimport AdminNav from './components/AdminNav';\nimport ExtensionData from './utils/ExtensionData';\n\nexport default class AdminApplication extends Application {\n  extensionData = new ExtensionData();\n\n  extensionCategories = {\n    feature: 30,\n    theme: 20,\n    language: 10,\n  };\n\n  history = {\n    canGoBack: () => true,\n    getPrevious: () => {},\n    backUrl: () => this.forum.attribute('baseUrl'),\n    back: function () {\n      window.location = this.backUrl();\n    },\n  };\n\n  constructor() {\n    super();\n\n    routes(this);\n  }\n\n  /**\n   * @inheritdoc\n   */\n  mount() {\n    // Mithril does not render the home route on https://example.com/admin, so\n    // we need to go to https://example.com/admin#/ explicitly.\n    if (!document.location.hash) document.location.hash = '#/';\n\n    m.route.prefix = '#';\n    super.mount();\n\n    m.mount(document.getElementById('app-navigation'), {\n      view: () =>\n        Navigation.component({\n          className: 'App-backControl',\n          drawer: true,\n        }),\n    });\n    m.mount(document.getElementById('header-navigation'), Navigation);\n    m.mount(document.getElementById('header-primary'), HeaderPrimary);\n    m.mount(document.getElementById('header-secondary'), HeaderSecondary);\n    m.mount(document.getElementById('admin-navigation'), AdminNav);\n  }\n\n  getRequiredPermissions(permission) {\n    const required = [];\n\n    if (permission === 'startDiscussion' || permission.indexOf('discussion.') === 0) {\n      required.push('viewDiscussions');\n    }\n    if (permission === 'discussion.delete') {\n      required.push('discussion.hide');\n    }\n    if (permission === 'discussion.deletePosts') {\n      required.push('discussion.hidePosts');\n    }\n\n    return required;\n  }\n}\n","import Admin from './AdminApplication';\n\nconst app = new Admin();\n\n// @ts-ignore\nwindow.app = app;\n\nexport default app;\n","import compat from '../common/compat';\n\nimport saveSettings from './utils/saveSettings';\nimport ExtensionData from './utils/ExtensionData';\nimport isExtensionEnabled from './utils/isExtensionEnabled';\nimport getCategorizedExtensions from './utils/getCategorizedExtensions';\nimport SettingDropdown from './components/SettingDropdown';\nimport EditCustomFooterModal from './components/EditCustomFooterModal';\nimport SessionDropdown from './components/SessionDropdown';\nimport HeaderPrimary from './components/HeaderPrimary';\nimport AdminPage from './components/AdminPage';\nimport AppearancePage from './components/AppearancePage';\nimport StatusWidget from './components/StatusWidget';\nimport ExtensionsWidget from './components/ExtensionsWidget';\nimport HeaderSecondary from './components/HeaderSecondary';\nimport SettingsModal from './components/SettingsModal';\nimport DashboardWidget from './components/DashboardWidget';\nimport ExtensionPage from './components/ExtensionPage';\nimport ExtensionLinkButton from './components/ExtensionLinkButton';\nimport PermissionGrid from './components/PermissionGrid';\nimport ExtensionPermissionGrid from './components/ExtensionPermissionGrid';\nimport MailPage from './components/MailPage';\nimport UploadImageButton from './components/UploadImageButton';\nimport LoadingModal from './components/LoadingModal';\nimport DashboardPage from './components/DashboardPage';\nimport BasicsPage from './components/BasicsPage';\nimport EditCustomHeaderModal from './components/EditCustomHeaderModal';\nimport PermissionsPage from './components/PermissionsPage';\nimport PermissionDropdown from './components/PermissionDropdown';\nimport AdminNav from './components/AdminNav';\nimport AdminHeader from './components/AdminHeader';\nimport EditCustomCssModal from './components/EditCustomCssModal';\nimport EditGroupModal from './components/EditGroupModal';\nimport routes from './routes';\nimport AdminApplication from './AdminApplication';\n\nexport default Object.assign(compat, {\n  'utils/saveSettings': saveSettings,\n  'utils/ExtensionData': ExtensionData,\n  'utils/isExtensionEnabled': isExtensionEnabled,\n  'utils/getCategorizedExtensions': getCategorizedExtensions,\n  'components/SettingDropdown': SettingDropdown,\n  'components/EditCustomFooterModal': EditCustomFooterModal,\n  'components/SessionDropdown': SessionDropdown,\n  'components/HeaderPrimary': HeaderPrimary,\n  'components/AdminPage': AdminPage,\n  'components/AppearancePage': AppearancePage,\n  'components/StatusWidget': StatusWidget,\n  'components/ExtensionsWidget': ExtensionsWidget,\n  'components/HeaderSecondary': HeaderSecondary,\n  'components/SettingsModal': SettingsModal,\n  'components/DashboardWidget': DashboardWidget,\n  'components/ExtensionPage': ExtensionPage,\n  'components/ExtensionLinkButton': ExtensionLinkButton,\n  'components/PermissionGrid': PermissionGrid,\n  'components/ExtensionPermissionGrid': ExtensionPermissionGrid,\n  'components/MailPage': MailPage,\n  'components/UploadImageButton': UploadImageButton,\n  'components/LoadingModal': LoadingModal,\n  'components/DashboardPage': DashboardPage,\n  'components/BasicsPage': BasicsPage,\n  'components/EditCustomHeaderModal': EditCustomHeaderModal,\n  'components/PermissionsPage': PermissionsPage,\n  'components/PermissionDropdown': PermissionDropdown,\n  'components/AdminNav': AdminNav,\n  'components/AdminHeader': AdminHeader,\n  'components/EditCustomCssModal': EditCustomCssModal,\n  'components/EditGroupModal': EditGroupModal,\n  routes: routes,\n  AdminApplication: AdminApplication,\n});\n","import app from './app';\n\nexport { app };\n\n// Export public API\n\n// Export compat API\nimport compatObj from './compat';\nimport proxifyCompat from '../common/utils/proxifyCompat';\n\ncompatObj.app = app;\n\nexport const compat = proxifyCompat(compatObj, 'admin');\n","/**\n * Truncate a string to the given length, appending ellipses if necessary.\n */\nexport function truncate(string: string, length: number, start: number = 0): string {\n  return (start > 0 ? '...' : '') + string.substring(start, start + length) + (string.length > start + length ? '...' : '');\n}\n\n/**\n * Create a slug out of the given string. Non-alphanumeric characters are\n * converted to hyphens.\n *\n * NOTE: This method does not use the comparably sophisticated transliteration\n * mechanism that is employed in the backend. Therefore, it should only be used\n * to *suggest* slugs that can be overridden by the user.\n */\nexport function slug(string: string): string {\n  return string\n    .toLowerCase()\n    .replace(/[^a-z0-9]/gi, '-')\n    .replace(/-+/g, '-')\n    .replace(/-$|^-/g, '');\n}\n\n/**\n * Strip HTML tags and quotes out of the given string, replacing them with\n * meaningful punctuation.\n */\nexport function getPlainContent(string: string): string {\n  const html = string.replace(/(<\\/p>|<br>)/g, '$1 &nbsp;').replace(/<img\\b[^>]*>/gi, ' ');\n\n  const dom = $('<div/>').html(html);\n\n  dom.find(getPlainContent.removeSelectors.join(',')).remove();\n\n  return dom.text().replace(/\\s+/g, ' ').trim();\n}\n\n/**\n * An array of DOM selectors to remove when getting plain content.\n *\n * @type {Array}\n */\ngetPlainContent.removeSelectors = ['blockquote', 'script'];\n\n/**\n * Make a string's first character uppercase.\n */\nexport function ucfirst(string: string): string {\n  return string.substr(0, 1).toUpperCase() + string.substr(1);\n}\n"],"sourceRoot":""}