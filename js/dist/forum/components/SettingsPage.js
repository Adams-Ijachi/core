(self.webpackChunkflarum_core=self.webpackChunkflarum_core||[]).push([[826],{7839:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>y});var i=n(1788),a=n(5308),o=n(7037),r=n(4435),s=n(5462),c=n(9226),l=n(6366),u=n(9699),f=n(5052),d=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.methods=this.notificationMethods().toArray(),this.loading={},this.types=this.notificationTypes().toArray()},n.view=function(){var t=this,e=this.attrs.user.preferences();return m("table",{className:"NotificationGrid"},m("thead",null,m("tr",null,m("td",null),this.methods.map((function(e){return m("th",{className:"NotificationGrid-groupToggle",onclick:t.toggleMethod.bind(t,e.name)},(0,f.Z)(e.icon)," ",e.label)})))),m("tbody",null,this.types.map((function(n){return m("tr",null,m("td",{className:"NotificationGrid-groupToggle",onclick:t.toggleType.bind(t,n.name)},(0,f.Z)(n.icon)," ",n.label),t.methods.map((function(i){var a=t.preferenceKey(n.name,i.name);return m("td",{className:"NotificationGrid-checkbox"},m(u.Z,{state:!!e[a],loading:t.loading[a],disabled:!(a in e),onchange:t.toggle.bind(t,[a])}))})))}))))},n.oncreate=function(e){t.prototype.oncreate.call(this,e),this.$("thead .NotificationGrid-groupToggle").bind("mouseenter mouseleave",(function(t){var e=parseInt($(this).index(),10)+1;$(this).parents("table").find("td:nth-child("+e+")").toggleClass("highlighted","mouseenter"===t.type)})),this.$("tbody .NotificationGrid-groupToggle").bind("mouseenter mouseleave",(function(t){$(this).parent().find("td").toggleClass("highlighted","mouseenter"===t.type)}))},n.toggle=function(t){var e=this,n=this.attrs.user,i=n.preferences(),a=!i[t[0]];t.forEach((function(t){e.loading[t]=!0,i[t]=a})),m.redraw(),n.save({preferences:i}).then((function(){t.forEach((function(t){return e.loading[t]=!1})),m.redraw()}))},n.toggleMethod=function(t){var e=this,n=this.types.map((function(n){return e.preferenceKey(n.name,t)})).filter((function(t){return t in e.attrs.user.preferences()}));this.toggle(n)},n.toggleType=function(t){var e=this,n=this.methods.map((function(n){return e.preferenceKey(t,n.name)})).filter((function(t){return t in e.attrs.user.preferences()}));this.toggle(n)},n.preferenceKey=function(t,e){return"notify_"+t+"_"+e},n.notificationMethods=function(){var t=new o.Z;return t.add("alert",{name:"alert",icon:"fas fa-bell",label:app.translator.trans("core.forum.settings.notify_by_web_heading")}),t.add("email",{name:"email",icon:"far fa-envelope",label:app.translator.trans("core.forum.settings.notify_by_email_heading")}),t},n.notificationTypes=function(){var t=new o.Z;return t.add("discussionRenamed",{name:"discussionRenamed",icon:"fas fa-pencil-alt",label:app.translator.trans("core.forum.settings.notify_discussion_renamed_label")}),t},e}(l.Z),p=n(631),h=n(4338),g=n(1698),y=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.show(app.session.user),app.setTitle(app.translator.trans("core.forum.settings.title"))},n.content=function(){return m("div",{className:"SettingsPage"},m("ul",null,(0,g.Z)(this.settingsItems().toArray())))},n.settingsItems=function(){var t=this,e=new o.Z;return["account","notifications","privacy"].forEach((function(n){e.add(n,m(c.Z,{className:"Settings-"+n,label:app.translator.trans("core.forum.settings."+n+"_heading")},t[n+"Items"]().toArray()))})),e},n.accountItems=function(){var t=new o.Z;return t.add("changePassword",m(s.Z,{className:"Button",onclick:function(){return app.modal.show(p.Z)}},app.translator.trans("core.forum.settings.change_password_button"))),t.add("changeEmail",m(s.Z,{className:"Button",onclick:function(){return app.modal.show(h.Z)}},app.translator.trans("core.forum.settings.change_email_button"))),t},n.notificationsItems=function(){var t=new o.Z;return t.add("notificationGrid",m(d,{user:this.user})),t},n.privacyItems=function(){var t=this,e=new o.Z;return e.add("discloseOnline",m(r.Z,{state:this.user.preferences().discloseOnline,onchange:function(e){t.discloseOnlineLoading=!0,t.user.savePreferences({discloseOnline:e}).then((function(){t.discloseOnlineLoading=!1,m.redraw()}))},loading:this.discloseOnlineLoading},app.translator.trans("core.forum.settings.privacy_disclose_online_label"))),e},e}(a.Z)}}]);
//# sourceMappingURL=SettingsPage.js.map