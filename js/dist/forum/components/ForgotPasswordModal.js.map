{"version":3,"sources":["webpack://@flarum/core/./src/forum/components/ForgotPasswordModal.js"],"names":["ForgotPasswordModal","oninit","vnode","this","email","Stream","attrs","success","className","title","app","translator","trans","content","onclick","hide","bind","name","type","placeholder","extractText","bidi","disabled","loading","Button","onsubmit","e","preventDefault","request","method","url","forum","attribute","body","errorHandler","onerror","then","alert","loaded","error","status","Modal"],"mappings":"+LAaqBA,E,sGACnBC,OAAA,SAAOC,GACL,YAAMD,OAAN,UAAaC,GAObC,KAAKC,OAAQC,OAAOF,KAAKG,MAAMF,OAAS,IAOxCD,KAAKI,SAAU,G,EAGjBC,UAAA,WACE,MAAO,oC,EAGTC,MAAA,WACE,OAAOC,IAAIC,WAAWC,MAAM,qC,EAG9BC,QAAA,WACE,OAAIV,KAAKI,QAEL,SAAKC,UAAU,cACb,SAAKA,UAAU,uBACb,OAAGA,UAAU,YAAYE,IAAIC,WAAWC,MAAM,kDAC9C,SAAKJ,UAAU,cACb,EAAC,IAAD,CAAQA,UAAU,uCAAuCM,QAASX,KAAKY,KAAKC,KAAKb,OAC9EO,IAAIC,WAAWC,MAAM,iDAShC,SAAKJ,UAAU,cACb,SAAKA,UAAU,uBACb,OAAGA,UAAU,YAAYE,IAAIC,WAAWC,MAAM,oCAC9C,SAAKJ,UAAU,cACb,WACEA,UAAU,cACVS,KAAK,QACLC,KAAK,QACLC,aAAaC,OAAYV,IAAIC,WAAWC,MAAM,iDAC9CS,KAAMlB,KAAKC,MACXkB,SAAUnB,KAAKoB,WAGnB,SAAKf,UAAU,cACZgB,cACC,CACEhB,UAAW,uCACXU,KAAM,SACNK,QAASpB,KAAKoB,SAEhBb,IAAIC,WAAWC,MAAM,iD,EAQjCa,SAAA,SAASC,GAAG,WACVA,EAAEC,iBAEFxB,KAAKoB,SAAU,EAEfb,IACGkB,QAAQ,CACPC,OAAQ,OACRC,IAAKpB,IAAIqB,MAAMC,UAAU,UAAY,UACrCC,KAAM,CAAE7B,MAAOD,KAAKC,SACpB8B,aAAc/B,KAAKgC,QAAQnB,KAAKb,QAEjCiC,MAAK,WACJ,EAAK7B,SAAU,EACf,EAAK8B,MAAQ,QATjB,OAWS,eACND,KAAKjC,KAAKmC,OAAOtB,KAAKb,Q,EAG3BgC,QAAA,SAAQI,GACe,MAAjBA,EAAMC,SACRD,EAAMF,MAAMxB,QAAUH,IAAIC,WAAWC,MAAM,iDAG7C,YAAMuB,QAAN,UAAcI,I,GAjG+BE","file":"forum/components/ForgotPasswordModal.js","sourcesContent":["import Modal from '../../common/components/Modal';\nimport Button from '../../common/components/Button';\nimport extractText from '../../common/utils/extractText';\nimport Stream from '../../common/utils/Stream';\n\n/**\n * The `ForgotPasswordModal` component displays a modal which allows the user to\n * enter their email address and request a link to reset their password.\n *\n * ### Attrs\n *\n * - `email`\n */\nexport default class ForgotPasswordModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    /**\n     * The value of the email input.\n     *\n     * @type {Function}\n     */\n    this.email = Stream(this.attrs.email || '');\n\n    /**\n     * Whether or not the password reset email was sent successfully.\n     *\n     * @type {Boolean}\n     */\n    this.success = false;\n  }\n\n  className() {\n    return 'ForgotPasswordModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('core.forum.forgot_password.title');\n  }\n\n  content() {\n    if (this.success) {\n      return (\n        <div className=\"Modal-body\">\n          <div className=\"Form Form--centered\">\n            <p className=\"helpText\">{app.translator.trans('core.forum.forgot_password.email_sent_message')}</p>\n            <div className=\"Form-group\">\n              <Button className=\"Button Button--primary Button--block\" onclick={this.hide.bind(this)}>\n                {app.translator.trans('core.forum.forgot_password.dismiss_button')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form Form--centered\">\n          <p className=\"helpText\">{app.translator.trans('core.forum.forgot_password.text')}</p>\n          <div className=\"Form-group\">\n            <input\n              className=\"FormControl\"\n              name=\"email\"\n              type=\"email\"\n              placeholder={extractText(app.translator.trans('core.forum.forgot_password.email_placeholder'))}\n              bidi={this.email}\n              disabled={this.loading}\n            />\n          </div>\n          <div className=\"Form-group\">\n            {Button.component(\n              {\n                className: 'Button Button--primary Button--block',\n                type: 'submit',\n                loading: this.loading,\n              },\n              app.translator.trans('core.forum.forgot_password.submit_button')\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/forgot',\n        body: { email: this.email() },\n        errorHandler: this.onerror.bind(this),\n      })\n      .then(() => {\n        this.success = true;\n        this.alert = null;\n      })\n      .catch(() => {})\n      .then(this.loaded.bind(this));\n  }\n\n  onerror(error) {\n    if (error.status === 404) {\n      error.alert.content = app.translator.trans('core.forum.forgot_password.not_found_message');\n    }\n\n    super.onerror(error);\n  }\n}\n//Flarum Asynchronous Module\n"],"sourceRoot":""}