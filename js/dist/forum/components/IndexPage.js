(self.webpackChunk_flarum_core=self.webpackChunk_flarum_core||[]).push([[847],{5368:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var a=t(1788),o=t(6156),n=(t(2511),t(453)),i=t(4594),r=t(7473),c=t(486),p=t(8931),l=t(2587),u=function(e){function s(){return e.apply(this,arguments)||this}(0,a.Z)(s,e);var t=s.prototype;return t.oninit=function(s){e.prototype.oninit.call(this,s),this.hidden=localStorage.getItem("welcomeHidden")},t.view=function(){var e=this;return this.hidden?m("div",null):m("header",{className:"Hero WelcomeHero"},m("div",{class:"container"},l.Z.component({icon:"fas fa-times",onclick:function(){e.$().slideUp(e.hide.bind(e))},className:"Hero-close Button Button--icon Button--link"}),m("div",{className:"containerNarrow"},m("h2",{className:"Hero-title"},app.forum.attribute("welcomeTitle")),m("div",{className:"Hero-subtitle"},m.trust(app.forum.attribute("welcomeMessage"))))))},t.hide=function(){localStorage.setItem("welcomeHidden","true"),this.hidden=!0},s}(p.Z);window.flreg.add("components/WelcomeHero",u);var d=t(2679),h=t(9657),f=t(2558),v=t(9349),w=function(e){function s(){return e.apply(this,arguments)||this}(0,a.Z)(s,e);var o=s.prototype;return o.oninit=function(t){e.prototype.oninit.call(this,t),app.previous.matches(d.Z)&&(this.lastDiscussion=app.previous.get("discussion")),app.previous.matches(s)&&app.discussions.clear(),app.discussions.refreshParams(app.search.params()),app.history.push("index",app.translator.trans("core.forum.header.back_to_index_tooltip")),this.bodyClass="App--index",this.scrollTopOnCreate=!1},o.view=function(){return m("div",{className:"IndexPage"},this.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,(0,r.Z)(this.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("div",{className:"IndexPage-toolbar"},m("ul",{className:"IndexPage-toolbar-view"},(0,r.Z)(this.viewItems().toArray())),m("ul",{className:"IndexPage-toolbar-action"},(0,r.Z)(this.actionItems().toArray()))),m(c.Z,{state:app.discussions})))))},o.setTitle=function(){app.setTitle(app.translator.trans("core.forum.index.meta_title_text")),app.setTitleCount(0)},o.oncreate=function(s){e.prototype.oncreate.call(this,s),this.setTitle();var t=app.cache.heroHeight,a=app.cache.heroHeight=this.$(".Hero").outerHeight()||0,o=app.cache.scrollTop;if($("#app").css("min-height",$(window).height()+a),null!=app.previous.type&&("desktop"==app.screen()||"desktop-hd"==app.screen()||this.lastDiscussion?$(window).scrollTop(o-t+a):$(window).scrollTop(0),this.lastDiscussion)){var n=this.$('li[data-id="'+this.lastDiscussion.id()+'"] .DiscussionListItem');if(n.length){var i=$("#header").outerHeight(),r=$(window).height(),c=n.offset().top,p=c+n.outerHeight();(c<o+i||p>o+r)&&$(window).scrollTop(c-i)}}},o.onbeforeremove=function(){app.cache.scrollTop=$(window).scrollTop()},o.onremove=function(){e.prototype.onremove.call(this),$("#app").css("min-height","")},o.hero=function(){return u.component()},o.sidebarItems=function(){var e=this,s=new i.Z,t=app.forum.attribute("canStartDiscussion")||!app.session.user;return s.add("newDiscussion",l.Z.component({icon:"fas fa-edit",className:"Button Button--primary IndexPage-newDiscussion",itemClassName:"App-primaryControl",onclick:function(){return e.newDiscussionAction().catch((function(){}))},disabled:!t},app.translator.trans(t?"core.forum.index.start_discussion_button":"core.forum.index.cannot_start_discussion_button"))),s.add("nav",v.Z.component({buttonClassName:"Button",className:"App-titleControl",accessibleToggleLabel:app.translator.trans("core.forum.index.toggle_sidenav_dropdown_accessible_label")},this.navItems(this).toArray())),s},o.navItems=function(){var e=new i.Z,s=app.search.stickyParams();return e.add("allDiscussions",f.Z.component({href:app.route("index",s),icon:"far fa-comments"},app.translator.trans("core.forum.index.all_discussions_link")),100),e},o.viewItems=function(){var e=new i.Z,s=app.discussions.sortMap(),t={};for(var a in s)t[a]=app.translator.trans("core.forum.index_sort."+a+"_button");return e.add("sort",h.Z.component({buttonClassName:"Button",label:t[app.search.params().sort]||Object.keys(s).map((function(e){return t[e]}))[0],accessibleToggleLabel:app.translator.trans("core.forum.index_sort.toggle_dropdown_accessible_label")},Object.keys(t).map((function(e){var a=t[e],o=(app.search.params().sort||Object.keys(s)[0])===e;return l.Z.component({icon:!o||"fas fa-check",onclick:app.search.changeSort.bind(app.search,e),active:o},a)})))),e},o.actionItems=function(){var e=new i.Z;return e.add("refresh",l.Z.component({title:app.translator.trans("core.forum.index.refresh_tooltip"),icon:"fas fa-sync",className:"Button Button--icon",onclick:function(){app.discussions.refresh(),app.session.user&&(app.store.find("users",app.session.user.id()),m.redraw())}})),app.session.user&&e.add("markAllAsRead",l.Z.component({title:app.translator.trans("core.forum.index.mark_all_as_read_tooltip"),icon:"fas fa-check",className:"Button Button--icon",onclick:this.markAllAsRead.bind(this)})),e},o.newDiscussionAction=function(){var e=function(){return t.e(460).then(t.bind(t,1498))},s=function(){return t.e(437).then(t.bind(t,3406))};return new Promise((function(t,a){return app.session.user?(app.composer.load(s,{user:app.session.user}),app.composer.show(),t(app.composer)):(app.modal.show(e),a())}))},o.markAllAsRead=function(){confirm(app.translator.trans("core.forum.index.mark_all_as_read_confirmation"))&&app.session.user.save({markedAllAsReadAt:new Date})},s}(n.Z);(0,o.Z)(w,"providesInitialSearch",!0)}}]);
//# sourceMappingURL=IndexPage.js.map