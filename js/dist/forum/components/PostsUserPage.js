(self.webpackChunkflarum_core=self.webpackChunkflarum_core||[]).push([[28],{1565:(t,s,e)=>{"use strict";e.d(s,{Z:()=>p});var i=e(1788),n=e(1795),o=e(1749),r=e(474),a=e(431),l=e(75),c=e(7037),h=e(1698),u=e(5462),d=e(108),p=function(t){function s(){return t.apply(this,arguments)||this}(0,i.Z)(s,t);var n=s.prototype;return n.oninit=function(s){var e=this;t.prototype.oninit.call(this,s),this.revealContent=!1,this.cardVisible=!1,this.subtree.check((function(){return e.cardVisible}),(function(){return e.isEditing()}),(function(){return e.revealContent}))},n.content=function(){return t.prototype.content.call(this).concat([m("header",{className:"Post-header"},m("ul",null,(0,h.Z)(this.headerItems().toArray()))),m("div",{className:"Post-body"},this.isEditing()?m(d.Z,{className:"Post-preview",composer:app.composer}):m.trust(this.attrs.post.contentHtml()))])},n.refreshContent=function(){var t=this.isEditing()?"":this.attrs.post.contentHtml();this.contentHtml!==t&&this.$(".Post-body script").each((function(){var t=document.createElement("script");t.textContent=this.textContent,Array.from(this.attributes).forEach((function(s){return t.setAttribute(s.name,s.value)})),this.parentNode.replaceChild(t,this)})),this.contentHtml=t},n.oncreate=function(s){t.prototype.oncreate.call(this,s),this.refreshContent()},n.onupdate=function(s){t.prototype.onupdate.call(this,s),this.refreshContent()},n.isEditing=function(){var t=this;Promise.resolve().then(e.bind(e,4588)).then((function(s){return app.composer.bodyMatches(s.default,{post:t.attrs.post})}))},n.elementAttrs=function(){var s=this.attrs.post,e=t.prototype.elementAttrs.call(this);return e.className=(e.className||"")+" "+(0,o.Z)({CommentPost:!0,"Post--hidden":s.isHidden(),"Post--edited":s.isEdited(),revealContent:this.revealContent,editing:this.isEditing()}),e},n.toggleContent=function(){this.revealContent=!this.revealContent},n.headerItems=function(){var t=this,s=new c.Z,e=this.attrs.post;return s.add("user",r.Z.component({post:e,cardVisible:this.cardVisible,oncardshow:function(){t.cardVisible=!0,m.redraw()},oncardhide:function(){t.cardVisible=!1,m.redraw()}}),100),s.add("meta",a.Z.component({post:e})),e.isEdited()&&!e.isHidden()&&s.add("edited",l.Z.component({post:e})),e.isHidden()&&s.add("toggle",u.Z.component({className:"Button Button--default Button--more",icon:"fas fa-ellipsis-h",onclick:this.toggleContent.bind(this)})),s},s}(n.Z)},4958:(t,s,e)=>{"use strict";e.r(s),e.d(s,{default:()=>h});var i=e(1788),n=e(5308),o=e(2232),r=e(5462),a=e(9236),l=e(4389),c=e(1565),h=function(t){function s(){return t.apply(this,arguments)||this}(0,i.Z)(s,t);var e=s.prototype;return e.oninit=function(s){t.prototype.oninit.call(this,s),this.loading=!0,this.moreResults=!1,this.posts=[],this.loadLimit=20,this.loadUser(m.route.param("username"))},e.content=function(){return 0!==this.posts.length||this.loading?(this.loading?t=m(o.Z,null):this.moreResults&&(t=m("div",{className:"PostsUserPage-loadMore"},m(r.Z,{className:"Button",onclick:this.loadMore.bind(this)},app.translator.trans("core.forum.user.posts_load_more_button")))),m("div",{className:"PostsUserPage"},m("ul",{className:"PostsUserPage-list"},this.posts.map((function(t){return m("li",null,m("div",{className:"PostsUserPage-discussion"},app.translator.trans("core.forum.user.in_discussion_text",{discussion:m(a.Z,{href:app.route.post(t)},t.discussion().title())})),m(c.Z,{post:t}))}))),m("div",{className:"PostsUserPage-loadMore"},t))):m("div",{className:"PostsUserPage"},m(l.Z,{text:app.translator.trans("core.forum.user.posts_empty_text")}));var t},e.show=function(s){t.prototype.show.call(this,s),this.refresh()},e.refresh=function(){this.loading=!0,this.posts=[],m.redraw(),this.loadResults().then(this.parseResults.bind(this))},e.loadResults=function(t){return app.store.find("posts",{filter:{author:this.user.username(),type:"comment"},page:{offset:t,limit:this.loadLimit},sort:"-createdAt"})},e.loadMore=function(){this.loading=!0,this.loadResults(this.posts.length).then(this.parseResults.bind(this))},e.parseResults=function(t){return this.loading=!1,[].push.apply(this.posts,t),this.moreResults=t.length>=this.loadLimit,m.redraw(),t},s}(n.Z)}}]);
//# sourceMappingURL=PostsUserPage.js.map