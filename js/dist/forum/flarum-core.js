/*! For license information please see flarum-core.js.LICENSE.txt */
(self.webpackChunkflarum_core=self.webpackChunkflarum_core||[]).push([[26],{9845:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Extend:()=>s.U,app:()=>at,compat:()=>Rt});var s=n(2633),i=(n(4816),n(443),n(7757)),o=n.n(i),r=n(2137),a=n(3349),u=n(1788),c=n(6156),l=n(2122),h=n(7769),p=function(){function t(t){this.stack=[]}var e=t.prototype;return e.getCurrent=function(){return this.stack[this.stack.length-1]},e.getPrevious=function(){return this.stack[this.stack.length-2]},e.push=function(t,e,n){void 0===n&&(n=m.route.get());var s=this.stack[this.stack.length-2];s&&s.name===t&&this.stack.pop();var i=this.getCurrent();i&&i.name===t?(0,l.Z)(i,{url:n,title:e}):this.stack.push({name:t,url:n,title:e})},e.canGoBack=function(){return this.stack.length>1},e.back=function(){if(!this.canGoBack())return this.home();this.stack.pop(),m.route.set(this.getCurrent().url)},e.backUrl=function(){return this.stack[this.stack.length-2].url},e.home=function(){this.stack.splice(0),(0,h.Z)("/")},t}(),d=function(){function t(t){this.pinnedKey="panePinned",this.$element=$(t),this.pinned="true"===localStorage.getItem(this.pinnedKey),this.active=!1,this.showing=!1,this.render()}var e=t.prototype;return e.enable=function(){this.active=!0,this.render()},e.disable=function(){this.active=!1,this.showing=!1,this.render()},e.show=function(){clearTimeout(this.hideTimeout),this.showing=!0,this.render()},e.hide=function(){this.showing=!1,this.render()},e.onmouseleave=function(){this.hideTimeout=setTimeout(this.hide.bind(this),250)},e.togglePinned=function(){this.pinned=!this.pinned,localStorage.setItem(this.pinnedKey,this.pinned?"true":"false"),this.render()},e.render=function(){this.$element.toggleClass("panePinned",this.pinned).toggleClass("hasPane",this.active).toggleClass("paneShowing",this.showing)},t}(),f=n(6801),v=n(6366),g=n(7037),b=n(1698),w=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.view=function(){return m("ul",{className:"Header-controls"},(0,b.Z)(this.items().toArray()))},n.items=function(){return new g.Z},e}(v.Z),Z=n(5462),y=n(6149),N=n(3131),C=n(8777),P=n(7971),x=n(2939),S=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.className="SessionDropdown",e.buttonClassName="Button Button--user Button--flat",e.menuClassName="Dropdown-menu--right",e.accessibleToggleLabel=app.translator.trans("core.forum.header.session_dropdown_accessible_label")};var n=e.prototype;return n.view=function(e){return t.prototype.view.call(this,(0,l.Z)({},e,{children:this.items().toArray()}))},n.getButtonContent=function(){var t=app.session.user;return[(0,y.Z)(t)," ",m("span",{className:"Button-label"},(0,N.Z)(t))]},n.items=function(){var t=new g.Z,e=app.session.user;return t.add("profile",P.Z.component({icon:"fas fa-user",href:app.route.user(e)},app.translator.trans("core.forum.header.profile_button")),100),t.add("settings",P.Z.component({icon:"fas fa-cog",href:app.route("settings")},app.translator.trans("core.forum.header.settings_button")),50),app.forum.attribute("adminUrl")&&t.add("administration",P.Z.component({icon:"fas fa-wrench",href:app.forum.attribute("adminUrl"),target:"_blank"},app.translator.trans("core.forum.header.admin_button")),0),t.add("separator",x.Z.component(),-90),t.add("logOut",Z.Z.component({icon:"fas fa-sign-out-alt",onclick:app.session.logout.bind(app.session)},app.translator.trans("core.forum.header.log_out_button")),-100),t},e}(C.Z),_=n(6317),k=n(5052),I=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t),e.initAttrs=function(e){e.className=e.className||"NotificationsDropdown",e.buttonClassName=e.buttonClassName||"Button Button--flat",e.menuClassName=e.menuClassName||"Dropdown-menu--right",e.label=e.label||app.translator.trans("core.forum.notifications.tooltip"),e.icon=e.icon||"fas fa-bell",e.accessibleToggleLabel=e.accessibleToggleLabel||app.translator.trans("core.forum.notifications.toggle_dropdown_accessible_label"),t.initAttrs.call(this,e)};var s=e.prototype;return s.getButton=function(){var e=this.getNewCount(),n=t.prototype.getButton.call(this);return n.attrs.title=this.attrs.label,n.attrs.className+=e?" new":"",n.attrs.onclick=this.onclick.bind(this),n},s.getButtonContent=function(){var t=this.getUnreadCount();return[(0,k.Z)(this.attrs.icon,{className:"Button-icon"}),t?m("span",{className:"NotificationsDropdown-unread"},t):"",m("span",{className:"Button-label"},this.attrs.label)]},s.getMenu=function(){var t=this.NotificationList;return m("div",{className:"Dropdown-menu "+this.attrs.menuClassName,onclick:this.menuClick.bind(this)},this.showing&&t?m(t,{state:this.attrs.state}):"")},s.onclick=function(){var t=this;n.e(77).then(n.bind(n,2047)).then((function(e){t.NotificationList=e.default,m.redraw()})),app.drawer.isOpen()?this.goToRoute():this.attrs.state.load()},s.goToRoute=function(){m.route.set(app.route("notifications"))},s.getUnreadCount=function(){return app.session.user.unreadNotificationCount()},s.getNewCount=function(){return app.session.user.newNotificationCount()},s.menuClick=function(t){(t.shiftKey||t.metaKey||t.ctrlKey||2===t.which)&&t.stopPropagation()},e}(C.Z),D=n(2232),T=n(1749),A=n(8165),E=function(){function t(){this.callbacks={},this.whenCallback=function(t){return!0}}var e=t.prototype;return e.onUp=function(t){return this.callbacks[38]=function(e){e.preventDefault(),t(e)},this},e.onDown=function(t){return this.callbacks[40]=function(e){e.preventDefault(),t(e)},this},e.onSelect=function(t){return this.callbacks[9]=this.callbacks[13]=function(e){e.preventDefault(),t(e)},this},e.onCancel=function(t){return this.callbacks[27]=function(e){e.stopPropagation(),e.preventDefault(),t(e)},this},e.onRemove=function(t){return this.callbacks[8]=function(e){0===e.target.selectionStart&&0===e.target.selectionEnd&&(t(e),e.preventDefault())},this},e.when=function(t){return this.whenCallback=t,this},e.bindTo=function(t){t.on("keydown",this.navigate.bind(this))},e.navigate=function(t){if(this.whenCallback(t)){var e=this.callbacks[t.which];e&&e(t)}},t}(),L=n(4910),B=n(9236),H=function(){function t(){this.results={}}var e=t.prototype;return e.search=function(t){var e=this;t=t.toLowerCase(),this.results[t]=[];var n={filter:{q:t},page:{limit:3},include:"mostRelevantPost"};return app.store.find("discussions",n).then((function(n){return e.results[t]=n}))},e.view=function(t){t=t.toLowerCase();var e=this.results[t]||[];return[m("li",{className:"Dropdown-header"},app.translator.trans("core.forum.search.discussions_heading")),m("li",null,P.Z.component({icon:"fas fa-search",href:app.route("index",{q:t})},app.translator.trans("core.forum.search.all_discussions_button",{query:t}))),e.map((function(e){var n=e.mostRelevantPost();return m("li",{className:"DiscussionSearchResult","data-index":"discussions"+e.id()},m(B.Z,{href:app.route.discussion(e,n&&n.number())},m("div",{className:"DiscussionSearchResult-title"},(0,L.Z)(e.title(),t)),n?m("div",{className:"DiscussionSearchResult-excerpt"},(0,L.Z)(n.contentPlain(),t,100)):""))}))]},t}(),M=function(){function t(){this.results={}}var e=t.prototype;return e.search=function(t){var e=this;return app.store.find("users",{filter:{q:t},page:{limit:5}}).then((function(n){e.results[t]=n,m.redraw()}))},e.view=function(t){t=t.toLowerCase();var e=(this.results[t]||[]).concat(app.store.all("users").filter((function(e){return[e.username(),e.displayName()].some((function(e){return e.toLowerCase().substr(0,t.length)===t}))}))).filter((function(t,e,n){return n.lastIndexOf(t)===e})).sort((function(t,e){return t.displayName().localeCompare(e.displayName())}));return e.length?[m("li",{className:"Dropdown-header"},app.translator.trans("core.forum.search.users_heading")),e.map((function(e){var n=(0,N.Z)(e),s=[(0,L.Z)(n.text,t)];return m("li",{className:"UserSearchResult","data-index":"users"+e.id()},m(B.Z,{href:app.route.user(e)},(0,y.Z)(e),(0,l.Z)({},n,{text:void 0,children:s})))}))]:""},t}(),R=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.state=this.attrs.state,this.hasFocus=!1,this.sources=null,this.loadingSources=0,this.index=0},n.view=function(){var t=this,e=this.state.getInitialSearch();if(this.sources||(this.sources=this.sourceItems().toArray()),!this.sources.length)return m("div",null);var n=(0,A.Z)(app.translator.trans("core.forum.header.search_placeholder"));return m("div",{role:"search",className:"Search "+(0,T.Z)({open:this.state.getValue()&&this.hasFocus,focused:this.hasFocus,active:!!e,loading:!!this.loadingSources})},m("div",{className:"Search-input"},m("input",{"aria-label":n,className:"FormControl",type:"search",placeholder:n,value:this.state.getValue(),oninput:function(e){return t.state.setValue(e.target.value)},onfocus:function(){return t.hasFocus=!0},onblur:function(){return t.hasFocus=!1}}),this.loadingSources?D.Z.component({size:"tiny",className:"Button Button--icon Button--link"}):e?m("button",{className:"Search-clear Button Button--icon Button--link",onclick:this.clear.bind(this)},(0,k.Z)("fas fa-times-circle")):""),m("ul",{className:"Dropdown-menu Search-results"},this.state.getValue()&&this.hasFocus?this.sources.map((function(e){return e.view(t.state.getValue())})):""))},n.onupdate=function(){if(this.setIndex(this.getCurrentNumericIndex()),this.sources.length){var t=window.innerHeight-this.element.querySelector(".Search-input>.FormControl").getBoundingClientRect().bottom-14;this.element.querySelector(".Search-results").style["max-height"]=t+"px"}},n.oncreate=function(n){var s=this;t.prototype.oncreate.call(this,n);var i=this,o=this.state;this.setIndex(this.getCurrentNumericIndex()),this.$(".Search-results").on("mousedown",(function(t){return t.preventDefault()})).on("click",(function(){return s.$("input").blur()})).on("mouseenter","> li:not(.Dropdown-header)",(function(){i.setIndex(i.selectableItems().index(this))}));var r=this.$("input");this.navigator=new E,this.navigator.onUp((function(){return s.setIndex(s.getCurrentNumericIndex()-1,!0)})).onDown((function(){return s.setIndex(s.getCurrentNumericIndex()+1,!0)})).onSelect(this.selectResult.bind(this)).onCancel(this.clear.bind(this)).bindTo(r),r.on("input focus",(function(){var t=this.value.toLowerCase();t&&(clearTimeout(i.searchTimeout),i.searchTimeout=setTimeout((function(){o.isCached(t)||(t.length>=e.MIN_SEARCH_LEN&&i.sources.map((function(e){e.search&&(i.loadingSources++,e.search(t).then((function(){i.loadingSources=Math.max(0,i.loadingSources-1),m.redraw()})))})),o.cache(t),m.redraw())}),250))})).on("focus",(function(){$(this).one("mouseup",(function(t){return t.preventDefault()})).select()}))},n.selectResult=function(){clearTimeout(this.searchTimeout),this.loadingSources=0,this.state.getValue()?m.route.set(this.getItem(this.index).find("a").attr("href")):this.clear(),this.$("input").blur()},n.clear=function(){this.state.clear()},n.sourceItems=function(){var t=new g.Z;return app.forum.attribute("canViewDiscussions")&&t.add("discussions",new H),app.forum.attribute("canViewUserList")&&t.add("users",new M),t},n.selectableItems=function(){return this.$(".Search-results > li:not(.Dropdown-header)")},n.getCurrentNumericIndex=function(){return this.selectableItems().index(this.getItem(this.index))},n.getItem=function(t){var e=this.selectableItems(),n=e.filter('[data-index="'+t+'"]');return n.length||(n=e.eq(t)),n},n.setIndex=function(t,e){var n=this.selectableItems(),s=n.parent(),i=t;t<0?i=n.length-1:t>=n.length&&(i=0);var o=n.removeClass("active").eq(i).addClass("active");if(this.index=o.attr("data-index")||i,e){var r,a=s.scrollTop(),u=s.offset().top,c=u+s.outerHeight(),l=o.offset().top,h=l+o.outerHeight();l<u?r=a-u+l-parseInt(s.css("padding-top"),10):h>c&&(r=a-c+h+parseInt(s.css("padding-bottom"),10)),void 0!==r&&s.stop(!0).animate({scrollTop:r},100)}},e}(v.Z);(0,c.Z)(R,"MIN_SEARCH_LEN",3);var U=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var s=e.prototype;return s.view=function(){return m("ul",{className:"Header-controls"},(0,b.Z)(this.items().toArray()))},s.items=function(){var t=new g.Z,e=function(){return n.e(460).then(n.bind(n,5127))},s=function(){return n.e(395).then(n.bind(n,6999))};if(t.add("search",R.component({state:app.search}),30),app.forum.attribute("showLanguageSelector")&&Object.keys(app.data.locales).length>1){var i=[],o=function(t){i.push(Z.Z.component({active:app.data.locale===t,icon:app.data.locale!==t||"fas fa-check",onclick:function(){app.session.user?app.session.user.savePreferences({locale:t}).then((function(){return window.location.reload()})):(document.cookie="locale="+t+"; path=/; expires=Tue, 19 Jan 2038 03:14:07 GMT",window.location.reload())}},app.data.locales[t]))};for(var r in app.data.locales)o(r);t.add("locale",_.Z.component({buttonClassName:"Button Button--link",accessibleToggleLabel:app.translator.trans("core.forum.header.locale_dropdown_accessible_label")},i),20)}return app.session.user?(t.add("notifications",I.component({state:app.notifications}),10),t.add("session",S.component(),0)):(app.forum.attribute("allowSignUp")&&t.add("signUp",Z.Z.component({className:"Button Button--link",onclick:function(){return app.modal.show(s)}},app.translator.trans("core.forum.header.sign_up_link")),10),t.add("logIn",Z.Z.component({className:"Button Button--link",onclick:function(){return app.modal.show(e)}},app.translator.trans("core.forum.header.log_in_link")),0)),t},e}(v.Z),z=function(t){function e(){return t.apply(this,arguments)||this}return(0,u.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.className=e.className||"Button Button--icon Button--link"},e}(Z.Z),F=n(9668),O=n(9015),q=n(8933),V=function(){function t(){this.position=t.Position.HIDDEN,this.height=null,this.body={attrs:{}},this.editor=null,this.clear()}var e=t.prototype;return e.load=function(){var t=(0,r.Z)(o().mark((function t(e,n){var s,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof v.Z){t.next=5;break}return t.next=3,e();case 3:s=t.sent,e=s.default;case 5:if(i={componentClass:e,attrs:n},!this.preventExit()){t.next=8;break}return t.abrupt("return");case 8:this.isVisible()&&(this.clear(),m.redraw.sync()),this.body=i;case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),e.clear=function(){this.position=t.Position.HIDDEN,this.body={attrs:{}},this.onExit=null,this.fields={content:(0,O.Z)("")},this.editor&&this.editor.destroy(),this.editor=null},e.show=function(){this.position!==t.Position.NORMAL&&this.position!==t.Position.FULLSCREEN&&(this.position=t.Position.NORMAL,m.redraw.sync())},e.hide=function(){this.clear(),m.redraw()},e.close=function(){this.preventExit()||this.hide()},e.minimize=function(){this.isVisible()&&(this.position=t.Position.MINIMIZED,m.redraw())},e.fullScreen=function(){this.isVisible()&&(this.position=t.Position.FULLSCREEN,m.redraw())},e.exitFullScreen=function(){this.position===t.Position.FULLSCREEN&&(this.position=t.Position.NORMAL,m.redraw())},e.bodyMatches=function(t,e){var n=this;return void 0===e&&(e={}),!!(0,F.Z)(this.body.componentClass,t)&&Object.keys(e).every((function(t){return n.body.attrs[t]===e[t]}))},e.isVisible=function(){return this.position!==t.Position.HIDDEN},e.isFullScreen=function(){return this.position===t.Position.FULLSCREEN||"phone"===app.screen()},e.composingReplyTo=function(t){return this.isVisible()&&this.bodyMatches(q.default,{discussion:t})},e.preventExit=function(){if(this.isVisible()&&this.onExit)return this.onExit.callback()?!confirm(this.onExit.message):void 0},e.preventClosingWhen=function(t,e){this.onExit={callback:t,message:e}},e.minimumHeight=function(){return 200},e.maximumHeight=function(){return $(window).height()-$("#header").outerHeight()},e.computedHeight=function(){return this.position===t.Position.MINIMIZED?"":this.position===t.Position.FULLSCREEN?$(window).height():Math.max(this.minimumHeight(),Math.min(this.height,this.maximumHeight()))},t}();V.Position={HIDDEN:"hidden",NORMAL:"normal",MINIMIZED:"minimized",FULLSCREEN:"fullScreen"};const j=V;var K=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.state=this.attrs.state,this.active=!1,this.prevPosition=this.state.position},n.view=function(){var t=this.state.body,e={normal:this.state.position===j.Position.NORMAL,minimized:this.state.position===j.Position.MINIMIZED,fullScreen:this.state.position===j.Position.FULLSCREEN,active:this.active,visible:this.state.isVisible()},n=this.state.position===j.Position.MINIMIZED?this.state.show.bind(this.state):void 0;return m("div",{className:"Composer "+(0,T.Z)(e)},m("div",{className:"Composer-handle",oncreate:this.configHandle.bind(this)}),m("ul",{className:"Composer-controls"},(0,b.Z)(this.controlItems().toArray())),m("div",{className:"Composer-content",onclick:n},t.componentClass?t.componentClass.component((0,l.Z)({},t.attrs,{composer:this.state,disabled:e.minimized})):""))},n.onupdate=function(){this.state.position===this.prevPosition?this.updateHeight():(this.animatePositionChange(),this.prevPosition=this.state.position)},n.oncreate=function(e){var n=this;t.prototype.oncreate.call(this,e),this.initializeHeight(),this.$().hide().css("bottom",-this.state.computedHeight()),this.$().on("focus blur",":input,.TextEditor-editorContainer",(function(t){n.active="focusin"===t.type,m.redraw()})),this.$().on("keydown",":input,.TextEditor-editorContainer","esc",(function(){return n.state.close()})),this.handlers={},$(window).on("resize",this.handlers.onresize=this.updateHeight.bind(this)).resize(),$(document).on("mousemove",this.handlers.onmousemove=this.onmousemove.bind(this)).on("mouseup",this.handlers.onmouseup=this.onmouseup.bind(this))},n.onremove=function(){$(window).off("resize",this.handlers.onresize),$(document).off("mousemove",this.handlers.onmousemove).off("mouseup",this.handlers.onmouseup)},n.configHandle=function(t){var e=this;$(t.dom).css("cursor","row-resize").bind("dragstart mousedown",(function(t){return t.preventDefault()})).mousedown((function(t){e.mouseStart=t.clientY,e.heightStart=e.$().height(),e.handle=$(this),$("body").css("cursor","row-resize")}))},n.onmousemove=function(t){if(this.handle){var e=this.mouseStart-t.clientY;this.changeHeight(this.heightStart+e);var n=$(window).scrollTop(),s=n>0&&n+$(window).height()>=$(document).height();this.updateBodyPadding(s)}},n.onmouseup=function(){this.handle&&(this.handle=null,$("body").css("cursor",""))},n.focus=function(){this.$(".Composer-content :input:enabled:visible, .TextEditor-editor").first().focus()},n.updateHeight=function(){var t=this.state.computedHeight(),e=this.$(".Composer-flexible");if(this.$().height(t),e.length){var n=e.offset().top-this.$().offset().top,s=parseInt(e.css("padding-bottom"),10),i=this.$(".Composer-footer").outerHeight(!0);e.height(this.$().outerHeight()-n-s-i)}},n.updateBodyPadding=function(){var t=this.state.position!==j.Position.HIDDEN&&this.state.position!==j.Position.MINIMIZED&&"phone"!==app.screen()?this.state.computedHeight()-parseInt($("#app").css("padding-bottom"),10):0;$("#content").css({paddingBottom:t})},n.animatePositionChange=function(){if(this.prevPosition!==j.Position.FULLSCREEN||this.state.position!==j.Position.NORMAL)switch(this.state.position){case j.Position.HIDDEN:return this.hide();case j.Position.MINIMIZED:return this.minimize();case j.Position.FULLSCREEN:return this.focus();case j.Position.NORMAL:return this.show()}else this.focus()},n.animateHeightChange=function(){var t=this.$().stop(!0),e=t.outerHeight(),n=$(window).scrollTop();t.show(),this.updateHeight();var s=t.outerHeight();this.prevPosition===j.Position.HIDDEN?t.css({bottom:-s,height:s}):t.css({height:e});var i=t.animate({bottom:0,height:s},"fast").promise();return this.updateBodyPadding(),$(window).scrollTop(n),i},n.showBackdrop=function(){this.$backdrop=$("<div/>").addClass("composer-backdrop").appendTo("body")},n.hideBackdrop=function(){this.$backdrop&&this.$backdrop.remove()},n.show=function(){var t=this;if(this.animateHeightChange().then((function(){return t.focus()})),"phone"===app.screen()){var e=document.documentElement,n=Math.min(e.scrollTop,e.scrollHeight-e.clientHeight);this.$().css("top",$(".App").is(".mobile-safari")?n:0),this.showBackdrop()}},n.hide=function(){var t=this,e=this.$();e.stop(!0).animate({bottom:-e.height()},"fast",(function(){e.hide(),t.hideBackdrop(),t.updateBodyPadding()}))},n.minimize=function(){this.animateHeightChange(),this.$().css("top","auto"),this.hideBackdrop()},n.controlItems=function(){var t=new g.Z;return this.state.position===j.Position.FULLSCREEN?t.add("exitFullScreen",z.component({icon:"fas fa-compress",title:app.translator.trans("core.forum.composer.exit_full_screen_tooltip"),onclick:this.state.exitFullScreen.bind(this.state)})):(this.state.position!==j.Position.MINIMIZED&&(t.add("minimize",z.component({icon:"fas fa-minus minimize",title:app.translator.trans("core.forum.composer.minimize_tooltip"),onclick:this.state.minimize.bind(this.state),itemClassName:"App-backControl"})),t.add("fullScreen",z.component({icon:"fas fa-expand",title:app.translator.trans("core.forum.composer.full_screen_tooltip"),onclick:this.state.fullScreen.bind(this.state)}))),t.add("close",z.component({icon:"fas fa-times",title:app.translator.trans("core.forum.composer.close_tooltip"),onclick:this.state.close.bind(this.state)}))),t},n.initializeHeight=function(){this.state.height=localStorage.getItem("composerHeight"),this.state.height||(this.state.height=this.defaultHeight())},n.defaultHeight=function(){return this.$().height()},n.changeHeight=function(t){this.state.height=t,this.updateHeight(),localStorage.setItem("composerHeight",this.state.height)},e}(v.Z),Y=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.canonicalizeDiscussionSlug=function(t){if(t)return t.split("-")[0]},n.makeKey=function(){var t=(0,l.Z)({},m.route.param());return"near"in t&&delete t.near,t.id=this.canonicalizeDiscussionSlug(t.id),this.routeName.replace(".near","")+JSON.stringify(t)},n.onmatch=function(n,s,i){return app.current.matches(f.Z)&&this.canonicalizeDiscussionSlug(n.id)===this.canonicalizeDiscussionSlug(m.route.param("id"))&&(e.scrollToPostNumber=n.near||"1"),t.prototype.onmatch.call(this,n,s,i)},n.render=function(n){if(null!==e.scrollToPostNumber){var s=e.scrollToPostNumber;setTimeout((function(){return app.current.get("stream").goToNumber(s)})),e.scrollToPostNumber=null}return t.prototype.render.call(this,n)},e}(n(4965).Z);(0,c.Z)(Y,"scrollToPostNumber",null);var W=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var s=e.prototype;return s.oninit=function(e){var s=this;t.prototype.oninit.call(this,e),app.history.push("notifications"),n.e(77).then(n.bind(n,2047)).then((function(t){s.NotificationList=t.default,m.redraw()})),app.notifications.load(),this.bodyClass="App--notifications"},s.view=function(){var t=this.NotificationList;return m("div",{className:"NotificationsPage"},t?m(t,{state:app.notifications}):"")},e}(n(3340).Z);function G(t){var e=function(){return n.e(28).then(n.bind(n,4958))};t.routes={index:{path:"/all",component:function(){return n.e(847).then(n.bind(n,5785))}},discussion:{path:"/d/:id",component:f.Z,resolverClass:Y},"discussion.near":{path:"/d/:id/:near",component:f.Z,resolverClass:Y},user:{path:"/u/:username",component:e},"user.posts":{path:"/u/:username",component:e},"user.discussions":{path:"/u/:username/discussions",component:function(){return n.e(799).then(n.bind(n,3928))}},settings:{path:"/settings",component:function(){return n.e(826).then(n.bind(n,7839))}},notifications:{path:"/notifications",component:W}},t.route.discussion=function(e,n){return t.route(n&&1!==n?"discussion.near":"discussion",{id:e.slug(),near:n&&1!==n?n:void 0})},t.route.post=function(e){return t.route.discussion(e.discussion(),e.number())},t.route.user=function(e){return t.route("user",{username:e.slug()})}}var X=n(6150);function J(t){var e=t.session.user;if(e&&!e.isEmailConfirmed()){var n=function(n){function s(){return n.apply(this,arguments)||this}(0,u.Z)(s,n);var i=s.prototype;return i.oninit=function(t){n.prototype.oninit.call(this,t),this.loading=!1,this.sent=!1},i.view=function(){return m(Z.Z,{class:"Button Button--link",onclick:this.onclick.bind(this),loading:this.loading,disabled:this.sent},this.sent?[(0,k.Z)("fas fa-check")," ",t.translator.trans("core.forum.user_email_confirmation.sent_message")]:t.translator.trans("core.forum.user_email_confirmation.resend_button"))},i.onclick=function(){var n=this;this.loading=!0,m.redraw(),t.request({method:"POST",url:t.forum.attribute("apiUrl")+"/users/"+e.id()+"/send-confirmation"}).then((function(){n.loading=!1,n.sent=!0,m.redraw()})).catch((function(){n.loading=!1,m.redraw()}))},s}(v.Z),s=function(t){function e(){return t.apply(this,arguments)||this}return(0,u.Z)(e,t),e.prototype.view=function(e){var n=t.prototype.view.call(this,e);return(0,l.Z)({},n,{children:[m("div",{className:"container"},n.children)]})},e}(X.Z);m.mount($("<div/>").insertBefore("#content")[0],{view:function(){return m(s,{dismissible:!1,controls:[m(n,null)]},t.translator.trans("core.forum.user_email_confirmation.alert_message",{email:m("strong",null,e.email())}))}})}}var Q=n(5873),tt=n(7330),et=function(){function t(t){this.app=t,this.notificationPages=[],this.loading=!1,this.moreResults=!1}var e=t.prototype;return e.clear=function(){this.notificationPages=[]},e.getNotificationPages=function(){return this.notificationPages},e.isLoading=function(){return this.loading},e.hasMoreResults=function(){return this.moreResults},e.load=function(){this.app.session.user.newNotificationCount()&&(this.notificationPages=[]),this.notificationPages.length>0||(this.app.session.user.pushAttributes({newNotificationCount:0}),this.loadMore())},e.loadMore=function(){var t=this;this.loading=!0,m.redraw();var e=this.notificationPages.length>0?{page:{offset:10*this.notificationPages.length}}:null;return this.app.store.find("notifications",e).then(this.parseResults.bind(this)).catch((function(){})).then((function(){t.loading=!1,m.redraw()}))},e.parseResults=function(t){return t.length&&this.notificationPages.push(t),this.moreResults=!!t.payload.links.next,t},e.markAllAsRead=function(){0!==this.notificationPages.length&&(this.app.session.user.pushAttributes({unreadNotificationCount:0}),this.notificationPages.forEach((function(t){t.forEach((function(t){return t.pushAttributes({isRead:!0})}))})),this.app.request({url:this.app.forum.attribute("apiUrl")+"/notifications/read",method:"POST"}))},t}(),nt=function(){function t(t){void 0===t&&(t=[]),this.cachedSearches=t}var e=t.prototype;return e.getValue=function(){return this.value},e.setValue=function(t){this.value=t},e.clear=function(){this.setValue("")},e.cache=function(t){this.cachedSearches.push(t)},e.isCached=function(t){return-1!==this.cachedSearches.indexOf(t)},t}(),st=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e)||this}(0,u.Z)(e,t);var n=e.prototype;return n.getValue=function(){return void 0===this.value&&(this.value=this.getInitialSearch()||""),t.prototype.getValue.call(this)},n.clear=function(){t.prototype.clear.call(this),this.getInitialSearch()?this.clearInitialSearch():m.redraw()},n.stickyParams=function(){return{sort:m.route.param("sort"),q:m.route.param("q")}},n.params=function(){var t=this.stickyParams();return t.filter=m.route.param("filter"),t},n.changeSort=function(t){var e=this.params();t===Object.keys(app.discussions.sortMap())[0]?delete e.sort:e.sort=t,(0,h.Z)(app.route(app.current.get("routeName"),e))},n.getInitialSearch=function(){return app.current.type&&app.current.type.providesInitialSearch&&this.params().q},n.clearInitialSearch=function(){var t=this.params();delete t.q,(0,h.Z)(app.route(app.current.get("routeName"),t))},e}(nt),it=n(93),ot=function(t){function e(){var e;return e=t.call(this)||this,(0,c.Z)((0,a.Z)(e),"pane",null),(0,c.Z)((0,a.Z)(e),"drawer",null),(0,c.Z)((0,a.Z)(e),"history",new p),(0,c.Z)((0,a.Z)(e),"notifications",new et((0,a.Z)(e))),(0,c.Z)((0,a.Z)(e),"search",new st),(0,c.Z)((0,a.Z)(e),"composer",new j),G((0,a.Z)(e)),e.discussions=new it.Z({},(0,a.Z)(e)),e}(0,u.Z)(e,t);var s=e.prototype;return s.mount=function(){var e=this,n=this.forum.attribute("defaultRoute"),s="index";for(var i in this.routes)this.routes[i].path===n&&(s=i);this.routes[s].path="/",this.history.push(s,this.translator.trans("core.forum.header.back_to_index_tooltip"),"/"),this.pane=new d(document.getElementById("app")),m.route.prefix="",t.prototype.mount.call(this,this.forum.attribute("basePath")),m.mount(document.getElementById("app-navigation"),{view:function(){return tt.Z.component({className:"App-backControl",drawer:!0})}}),m.mount(document.getElementById("header-navigation"),tt.Z),m.mount(document.getElementById("header-primary"),w),m.mount(document.getElementById("header-secondary"),U),m.mount(document.getElementById("composer"),{view:function(){return K.component({state:e.composer})}}),J(this),$("#home-link").click((function(t){t.ctrlKey||t.metaKey||2===t.which||(t.preventDefault(),app.history.home(),app.session.user&&(app.store.find("users",app.session.user.id()),m.redraw()))})),"ontouchstart"in window&&navigator.vendor&&navigator.vendor.includes("Apple")&&navigator.userAgent&&!navigator.userAgent.includes("CriOS")&&!navigator.userAgent.includes("FxiOS")&&$((function(){$(".App").addClass("mobile-safari")}))},s.viewingDiscussion=function(){var t=(0,r.Z)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.current.matches(f.Z.default,{discussion:e}));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),s.authenticationComplete=function(t){t.loggedIn?window.location.reload():this.modal.show((function(){return n.e(395).then(n.bind(n,6999))}),t)},e}(Q.Z),rt=new ot;window.app=rt;const at=rt;var ut=n(1834),ct=n(809),lt=n(8236),ht=n(2956),pt=n(4683),dt=n(5214),mt=n(1546),ft=n(3598),vt=function(t){function e(){return t.apply(this,arguments)||this}return(0,u.Z)(e,t),e.initAttrs=function(e){e.className=(e.className||"")+" LogInButton",e.onclick=function(){var t=$(window);window.open(app.forum.attribute("baseUrl")+e.path,"logInPopup","width=580,height=400,top="+(t.height()/2-200)+",left="+(t.width()/2-290)+",status=no,scrollbars=yes,resizable=no")},t.initAttrs.call(this,e)},e}(Z.Z),gt=n(75),bt=n(631),wt=n(2415),Zt=n(504),yt=n(1795),Nt=n(3097),Ct=n(4338),Pt=n(474),xt=n(5789),St=function(t){function e(){return t.apply(this,arguments)||this}return(0,u.Z)(e,t),e.prototype.view=function(){var t=this.attrs.post,e=t.user(),n=(0,L.Z)(t.contentPlain(),this.attrs.highlight,300);return m(B.Z,{className:"PostPreview",href:app.route.post(t),onclick:this.attrs.onclick},m("span",{className:"PostPreview-content"},(0,y.Z)(e),(0,N.Z)(e)," ",m("span",{className:"PostPreview-excerpt"},n)))},e}(v.Z),_t=n(1867),kt=n(939),It=n(431),Dt=function(){function t(){}var e=t.prototype;return e.search=function(){},e.view=function(){},t}(),Tt=n(6349),At=n(9499),Et=n(108),$t=n(2402),Lt=n(9086),Bt=n(4967);const Ht=(0,l.Z)(ut.Z,{"utils/PostControls":ct.Z,"utils/KeyboardNavigatable":E,"utils/slidable":lt.Z,"utils/History":p,"utils/DiscussionControls":ht.Z,"utils/alertEmailConfirmation":J,"utils/UserControls":pt.Z,"utils/Pane":d,"utils/BasicEditorDriver":Bt.Z,"states/ComposerState":j,"states/DiscussionListState":it.Z,"states/GlobalSearchState":st,"states/NotificationListState":et,"states/PostStreamState":dt.Z,"states/SearchState":nt,"components/AffixedSidebar":mt.Z,"components/DiscussionListPane":ft.Z,"components/LogInButton":vt,"components/SessionDropdown":S,"components/HeaderPrimary":w,"components/PostEdited":gt.Z,"components/ChangePasswordModal":bt.Z,"components/DiscussionsSearchSource":H,"components/HeaderSecondary":U,"components/ComposerButton":z,"components/DiscussionList":wt.Z,"components/AvatarEditor":Zt.Z,"components/Post":yt.Z,"components/TerminalPost":Nt.Z,"components/ChangeEmailModal":Ct.Z,"components/NotificationsDropdown":I,"components/PostUser":Pt.Z,"components/UserCard":xt.Z,"components/UsersSearchSource":M,"components/PostPreview":St,"components/EventPost":_t.Z,"components/DiscussionHero":kt.Z,"components/PostMeta":It.Z,"components/SearchSource":Dt,"components/LogInButtons":Tt.Z,"components/WelcomeHero":At.Z,"components/ComposerPostPreview":Et.Z,"components/RenameDiscussionModal":$t.Z,"components/Search":R,"components/LoadingPost":Lt.Z,"resolvers/DiscussionPageResolver":Y,routes:G,ForumApplication:ot});var Mt=n(1556);Ht.app=at;var Rt=(0,Mt.Z)(Ht,"forum")},6646:(t,e,n)=>{"use strict";function s(t,e,n){return void 0===n&&(n=0),(n>0?"...":"")+t.substring(n,n+e)+(t.length>n+e?"...":"")}function i(t){return t.toLowerCase().replace(/[^a-z0-9]/gi,"-").replace(/-+/g,"-").replace(/-$|^-/g,"")}function o(t){var e=t.replace(/(<\/p>|<br>)/g,"$1 &nbsp;").replace(/<img\b[^>]*>/gi," "),n=$("<div/>").html(e);return n.find(o.removeSelectors.join(",")).remove(),n.text().replace(/\s+/g," ").trim()}function r(t){return t.substr(0,1).toUpperCase()+t.substr(1)}n.r(e),n.d(e,{truncate:()=>s,slug:()=>i,getPlainContent:()=>o,ucfirst:()=>r}),o.removeSelectors=["blockquote","script"]},1546:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var s=n(1788),i=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.view=function(t){return t.children[0]},n.oncreate=function(e){t.prototype.oncreate.call(this,e),this.boundOnresize=this.onresize.bind(this),$(window).on("resize",this.boundOnresize).resize()},n.onremove=function(){$(window).off("resize",this.boundOnresize)},n.onresize=function(){var t=this,e=this.$(),n=$("#header"),s=$("#footer"),i=e.find("> ul");$(window).off(".affix"),i.removeClass("affix affix-top affix-bottom").removeData("bs.affix"),e.outerHeight(!0)>$(window).height()-n.outerHeight(!0)||i.affix({offset:{top:function(){return e.offset().top-n.outerHeight(!0)-parseInt(e.css("margin-top"),10)},bottom:function(){return t.bottom=s.outerHeight(!0)}}})},e}(n(6366).Z)},504:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var s=n(1788),i=n(6366),o=n(6149),r=n(5052),a=n(1698),u=n(7037),c=n(1749),l=n(5462),h=n(2232),p=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.loading=!1,this.isDraggedOver=!1},n.view=function(){var t=this.attrs.user;return m("div",{className:(0,c.Z)(["AvatarEditor","Dropdown",this.attrs.className,this.loading&&"loading",this.isDraggedOver&&"dragover"])},(0,o.Z)(t),m("a",{className:t.avatarUrl()?"Dropdown-toggle":"Dropdown-toggle AvatarEditor--noAvatar",title:app.translator.trans("core.forum.user.avatar_upload_tooltip"),"data-toggle":"dropdown",onclick:this.quickUpload.bind(this),ondragover:this.enableDragover.bind(this),ondragenter:this.enableDragover.bind(this),ondragleave:this.disableDragover.bind(this),ondragend:this.disableDragover.bind(this),ondrop:this.dropUpload.bind(this)},this.loading?m(h.Z,null):t.avatarUrl()?(0,r.Z)("fas fa-pencil-alt"):(0,r.Z)("fas fa-plus-circle")),m("ul",{className:"Dropdown-menu Menu"},(0,a.Z)(this.controlItems().toArray())))},n.controlItems=function(){var t=new u.Z;return t.add("upload",m(l.Z,{icon:"fas fa-upload",onclick:this.openPicker.bind(this)},app.translator.trans("core.forum.user.avatar_upload_button"))),t.add("remove",m(l.Z,{icon:"fas fa-times",onclick:this.remove.bind(this)},app.translator.trans("core.forum.user.avatar_remove_button"))),t},n.enableDragover=function(t){t.preventDefault(),t.stopPropagation(),this.isDraggedOver=!0},n.disableDragover=function(t){t.preventDefault(),t.stopPropagation(),this.isDraggedOver=!1},n.dropUpload=function(t){t.preventDefault(),t.stopPropagation(),this.isDraggedOver=!1,this.upload(t.dataTransfer.files[0])},n.quickUpload=function(t){this.attrs.user.avatarUrl()||(t.preventDefault(),t.stopPropagation(),this.openPicker())},n.openPicker=function(){var t=this;this.loading||$('<input type="file">').appendTo("body").hide().click().on("input",(function(e){t.upload($(e.target)[0].files[0])}))},n.upload=function(t){if(!this.loading){var e=this.attrs.user,n=new FormData;n.append("avatar",t),this.loading=!0,m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/users/"+e.id()+"/avatar",serialize:function(t){return t},body:n}).then(this.success.bind(this),this.failure.bind(this))}},n.remove=function(){var t=this.attrs.user;this.loading=!0,m.redraw(),app.request({method:"DELETE",url:app.forum.attribute("apiUrl")+"/users/"+t.id()+"/avatar"}).then(this.success.bind(this),this.failure.bind(this))},n.success=function(t){app.store.pushPayload(t),delete this.attrs.user.avatarColor,this.loading=!1,m.redraw()},n.failure=function(t){this.loading=!1,m.redraw()},e}(i.Z)},4338:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(1788),i=n(8292),o=n(5462),r=n(9015),a=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.success=!1,this.email=(0,r.Z)(app.session.user.email()),this.password=(0,r.Z)("")},n.className=function(){return"ChangeEmailModal Modal--small"},n.title=function(){return app.translator.trans("core.forum.change_email.title")},n.content=function(){return this.success?m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},app.translator.trans("core.forum.change_email.confirmation_message",{email:m("strong",null,this.email())})),m("div",{className:"Form-group"},m(o.Z,{className:"Button Button--primary Button--block",onclick:this.hide.bind(this)},app.translator.trans("core.forum.change_email.dismiss_button"))))):m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("div",{className:"Form-group"},m("input",{type:"email",name:"email",className:"FormControl",placeholder:app.session.user.email(),bidi:this.email,disabled:this.loading})),m("div",{className:"Form-group"},m("input",{type:"password",name:"password",className:"FormControl",placeholder:app.translator.trans("core.forum.change_email.confirm_password_placeholder"),bidi:this.password,disabled:this.loading})),m("div",{className:"Form-group"},o.Z.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("core.forum.change_email.submit_button")))))},n.onsubmit=function(t){var e=this;t.preventDefault(),this.email()!==app.session.user.email()?(this.loading=!0,this.alertAttrs=null,app.session.user.save({email:this.email()},{errorHandler:this.onerror.bind(this),meta:{password:this.password()}}).then((function(){e.success=!0})).catch((function(){})).then(this.loaded.bind(this))):this.hide()},n.onerror=function(e){401===e.status&&(e.alert.content=app.translator.trans("core.forum.change_email.incorrect_password_message")),t.prototype.onerror.call(this,e)},e}(i.Z)},631:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var s=n(1788),i=n(8292),o=n(5462),r=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.className=function(){return"ChangePasswordModal Modal--small"},n.title=function(){return app.translator.trans("core.forum.change_password.title")},n.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},app.translator.trans("core.forum.change_password.text")),m("div",{className:"Form-group"},o.Z.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("core.forum.change_password.send_button")))))},n.onsubmit=function(t){t.preventDefault(),this.loading=!0,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/forgot",body:{email:app.session.user.email()}}).then(this.hide.bind(this),this.loaded.bind(this))},e}(i.Z)},8098:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var s=n(1788),i=n(6366),o=n(2232),r=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.handler=function(){return this.attrs.when()||void 0},n.oncreate=function(e){t.prototype.oncreate.call(this,e),this.boundHandler=this.handler.bind(this),$(window).on("beforeunload",this.boundHandler)},n.onremove=function(){$(window).off("beforeunload",this.boundHandler)},n.view=function(t){return t.children[0]},e}(i.Z),a=n(6149),u=n(1698),c=n(7037),l=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var i=e.prototype;return i.oninit=function(e){var s=this;t.prototype.oninit.call(this,e),this.composer=this.attrs.composer,this.loading=!0,n.e(247).then(n.bind(n,7681)).then((function(t){s.TextEditor=t.default,s.loading=!1,m.redraw()})),this.attrs.confirmExit&&this.composer.preventClosingWhen((function(){return s.hasChanges()}),this.attrs.confirmExit),this.composer.fields.content(this.attrs.originalContent||"")},i.view=function(){var t=this.TextEditor;return m(r,{when:this.hasChanges.bind(this)},m("div",{className:"ComposerBody "+(this.attrs.className||"")},(0,a.Z)(this.attrs.user,{className:"ComposerBody-avatar"}),m("div",{className:"ComposerBody-content"},m("ul",{className:"ComposerBody-header"},(0,u.Z)(this.headerItems().toArray())),m("div",{className:"ComposerBody-editor"},t?t.component({submitLabel:this.attrs.submitLabel,placeholder:this.attrs.placeholder,disabled:this.loading||this.attrs.disabled,composer:this.composer,preview:this.jumpToPreview&&this.jumpToPreview.bind(this),onchange:this.composer.fields.content,onsubmit:this.onsubmit.bind(this),value:this.composer.fields.content()}):"")),o.Z.component({className:"ComposerBody-loading"+(this.loading?" active":"")})))},i.hasChanges=function(){var t=this.composer.fields.content();return t&&t!==this.attrs.originalContent},i.headerItems=function(){return new c.Z},i.onsubmit=function(){},i.loaded=function(){this.loading=!1,m.redraw()},e}(i.Z)},108:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var s=n(1788),i=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t),e.initAttrs=function(t){t.className=t.className||"",t.surround=t.surround||function(t){return t()}};var n=e.prototype;return n.view=function(){return m("div",{className:this.attrs.className})},n.oncreate=function(e){var n,s=this;t.prototype.oncreate.call(this,e);var i=function(){if(s.attrs.composer.isVisible()){var t=s.attrs.composer.fields.content();n!==t&&(n=t,s.attrs.surround((function(){return s9e.TextFormatter.preview(n||"",e.dom)})))}};i(),this.updateInterval=setInterval(i,50)},n.onremove=function(){clearInterval(this.updateInterval)},e}(n(6366).Z)},939:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(1788),i=n(6366),o=n(7037),r=n(1698),a=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.view=function(){return m("header",{className:"Hero DiscussionHero"},m("div",{className:"container"},m("ul",{className:"DiscussionHero-items"},(0,r.Z)(this.items().toArray()))))},n.items=function(){var t=new o.Z,e=this.attrs.discussion,n=e.badges().toArray();return n.length&&t.add("badges",m("ul",{className:"DiscussionHero-badges badges"},(0,r.Z)(n)),10),t.add("title",m("h2",{className:"DiscussionHero-title"},e.title())),t},e}(i.Z)},2415:(t,e,n)=>{"use strict";n.d(e,{Z:()=>B});var s=n(1788),i=n(6366),o=n(9236),r=n(6149),a=n(1698),u=n(4910),c=n(5052),l=n(9090),h=n(7037),p=n(4008),d=n(8777),f=n(3097),v=n(8932),g=n(2956),b=n(8236),w=n(8165),Z=n(1749),y=n(6801),N=n(5876);var C=n(9350),P=n(7828),x=N.Z?N.Z.prototype:void 0,S=x?x.toString:void 0;const _=function t(e){if("string"==typeof e)return e;if((0,C.Z)(e))return function(t,e){for(var n=-1,s=null==t?0:t.length,i=Array(s);++n<s;)i[n]=e(t[n],n,t);return i}(e,t)+"";if((0,P.Z)(e))return S?S.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n};var k=/[\\^$.*+?()[\]{}|]/g,I=RegExp(k.source);const D=function(t){return(t=null==(e=t)?"":_(e))&&I.test(t)?t.replace(k,"\\$&"):t;var e};var T=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){var n=this;t.prototype.oninit.call(this,e),this.subtree=new v.Z((function(){return n.attrs.discussion.freshness}),(function(){var t=app.session.user&&app.session.user.markedAllAsReadAt();return t&&t.getTime()}),(function(){return n.active()}))},n.elementAttrs=function(){return{className:(0,Z.Z)(["DiscussionListItem",this.active()?"active":"",this.attrs.discussion.isHidden()?"DiscussionListItem--hidden":"","ontouchstart"in window?"Slidable":""])}},n.view=function(){var t=this.attrs.discussion,e=t.user(),n=t.isUnread(),s=t.isRead(),i=!this.showRepliesCount()&&n,h=0,f=g.Z.controls(t,this).toArray(),v=this.elementAttrs();if(this.attrs.params.q){var b=t.mostRelevantPost();b&&(h=b.number());var Z=D(this.attrs.params.q);this.highlightRegExp=new RegExp(Z+"|"+Z.trim().replace(/\s+/g,"|"),"gi")}else h=Math.min(t.lastPostNumber(),(t.lastReadPostNumber()||0)+1);return m("div",v,f.length?d.Z.component({icon:"fas fa-ellipsis-v",className:"DiscussionListItem-controls",buttonClassName:"Button Button--icon Button--flat Slidable-underneath Slidable-underneath--right",accessibleToggleLabel:app.translator.trans("core.forum.discussion_controls.toggle_dropdown_accessible_label")},f):"",m("span",{className:"Slidable-underneath Slidable-underneath--left Slidable-underneath--elastic"+(n?"":" disabled"),onclick:this.markAsRead.bind(this)},(0,c.Z)("fas fa-check")),m("div",{className:"DiscussionListItem-content Slidable-content"+(n?" unread":"")+(s?" read":"")},m(o.Z,{href:e?app.route.user(e):"#",className:"DiscussionListItem-author",title:(0,w.Z)(app.translator.trans("core.forum.discussion_list.started_text",{user:e,ago:(0,l.Z)(t.createdAt())})),oncreate:function(t){$(t.dom).tooltip({placement:"right"})}},(0,r.Z)(e,{title:""})),m("ul",{className:"DiscussionListItem-badges badges"},(0,a.Z)(t.badges().toArray())),m(o.Z,{href:app.route.discussion(t,h),className:"DiscussionListItem-main"},m("h3",{className:"DiscussionListItem-title"},(0,u.Z)(t.title(),this.highlightRegExp)),m("ul",{className:"DiscussionListItem-info"},(0,a.Z)(this.infoItems().toArray()))),m("span",{tabindex:"0",role:"button",className:"DiscussionListItem-count",onclick:this.markAsRead.bind(this),title:i?app.translator.trans("core.forum.discussion_list.mark_as_read_tooltip"):""},(0,p.Z)(t[i?"unreadCount":"replyCount"]()))))},n.oncreate=function(e){if(t.prototype.oncreate.call(this,e),"ontouchstart"in window){var n=(0,b.Z)(this.$());this.$(".DiscussionListItem-controls").on("hidden.bs.dropdown",(function(){return n.reset()}))}},n.onbeforeupdate=function(e,n){return t.prototype.onbeforeupdate.call(this,e,n),this.subtree.needsRebuild()},n.active=function(){return app.current.matches(y.Z,{discussion:this.attrs.discussion})},n.showFirstPost=function(){return-1!==["newest","oldest"].indexOf(this.attrs.params.sort)},n.showRepliesCount=function(){return"replies"===this.attrs.params.sort},n.markAsRead=function(){var t=this.attrs.discussion;t.isUnread()&&(t.save({lastReadPostNumber:t.lastPostNumber()}),m.redraw())},n.infoItems=function(){var t=new h.Z;if(this.attrs.params.q){var e=this.attrs.discussion.mostRelevantPost()||this.attrs.discussion.firstPost();if(e&&"comment"===e.contentType()){var n=(0,u.Z)(e.contentPlain(),this.highlightRegExp,175);t.add("excerpt",n,-100)}}else t.add("terminalPost",f.Z.component({discussion:this.attrs.discussion,lastPost:!this.showFirstPost()}));return t},e}(i.Z),A=n(5462),E=n(2232),L=n(4389),B=function(t){function e(){return t.apply(this,arguments)||this}return(0,s.Z)(e,t),e.prototype.view=function(){var t,e=this.attrs.state,n=e.getParams();if(e.isLoading()?t=E.Z.component():e.moreResults&&(t=A.Z.component({className:"Button",onclick:e.loadMore.bind(e)},app.translator.trans("core.forum.discussion_list.load_more_button"))),e.empty()){var s=app.translator.trans("core.forum.discussion_list.empty_text");return m("div",{className:"DiscussionList"},L.Z.component({text:s}))}return m("div",{className:"DiscussionList"+(e.isSearchResults()?" DiscussionList--searchResults":"")},m("ul",{className:"DiscussionList-discussions"},e.discussions.map((function(t){return m("li",{key:t.id(),"data-id":t.id()},T.component({discussion:t,params:n}))}))),m("div",{className:"DiscussionList-loadMore"},t))},e}(i.Z)},3598:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var s=n(1788),i=n(2415),o=n(6366),r=n(6801),a=function(t){t.pageX<10&&app.pane.show()},u=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.view=function(){if(this.attrs.state.hasDiscussions())return m("div",{className:"DiscussionPage-list"},this.enoughSpace()&&m(i.Z,{state:this.attrs.state}))},n.oncreate=function(e){t.prototype.oncreate.call(this,e);var n=$(e.dom),s=app.pane;if(n.hover(s.show.bind(s),s.onmouseleave.bind(s)),$(document).on("mousemove",a),app.previous.matches(r.Z)){var i=app.cache.discussionListPaneScrollTop||0;n.scrollTop(i)}else{var o=n.find(".DiscussionListItem.active");if(o.length){var u=n.offset().top,c=u+n.outerHeight(),l=o.offset().top,h=l+o.outerHeight();(l<u||h>c)&&n.scrollTop(n.scrollTop()-u+l)}}},n.onremove=function(t){app.cache.discussionListPaneScrollTop=$(t.dom).scrollTop(),$(document).off("mousemove",a)},n.enoughSpace=function(){return!$(".App-navigation").is(":visible")},e}(o.Z)},6801:(t,e,n)=>{"use strict";n.d(e,{Z:()=>w});var s=n(1788),i=n(3340),o=n(7037),r=n(939),a=n(3598),u=n(6366),c=n(5052),l=n(1068),h=n(1252),p=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.stream=this.attrs.stream,this.handlers={},this.scrollListener=new h.Z(this.updateScrubberValues.bind(this,{fromScroll:!0,forceHeightChange:!0}))},n.view=function(){var t=this.stream.count(),e=app.translator.transChoice("core.forum.post_scrubber.viewing_text",t,{index:m("span",{className:"Scrubber-index"}),count:m("span",{className:"Scrubber-count"},(0,l.Z)(t))}),n=this.stream.discussion.unreadCount(),s=t?Math.min(t-this.stream.index,n)/t:0;function i(t){var e=$(t.dom),n={top:100-100*s+"%",height:100*s+"%"};t.state.oldStyle?e.stop(!0).css(t.state.oldStyle).animate(n):e.css(n),t.state.oldStyle=n}var o=["PostStreamScrubber","Dropdown"];return this.attrs.className&&o.push(this.attrs.className),m("div",{className:o.join(" ")},m("button",{className:"Button Dropdown-toggle","data-toggle":"dropdown"},e," ",(0,c.Z)("fas fa-sort")),m("div",{className:"Dropdown-menu dropdown-menu"},m("div",{className:"Scrubber"},m("a",{className:"Scrubber-first",onclick:this.goToFirst.bind(this)},(0,c.Z)("fas fa-angle-double-up")," ",app.translator.trans("core.forum.post_scrubber.original_post_link")),m("div",{className:"Scrubber-scrollbar"},m("div",{className:"Scrubber-before"}),m("div",{className:"Scrubber-handle"},m("div",{className:"Scrubber-bar"}),m("div",{className:"Scrubber-info"},m("strong",null,e),m("span",{className:"Scrubber-description"}))),m("div",{className:"Scrubber-after"}),m("div",{className:"Scrubber-unread",oncreate:i,onupdate:i},app.translator.trans("core.forum.post_scrubber.unread_text",{count:n}))),m("a",{className:"Scrubber-last",onclick:this.goToLast.bind(this)},(0,c.Z)("fas fa-angle-double-down")," ",app.translator.trans("core.forum.post_scrubber.now_link")))))},n.onupdate=function(){var t=this;this.stream.forceUpdateScrubber&&(this.stream.forceUpdateScrubber=!1,this.stream.loadPromise.then((function(){return t.updateScrubberValues({animate:!0,forceHeightChange:!0})})))},n.oncreate=function(e){var n=this;t.prototype.oncreate.call(this,e),$(window).on("resize",this.handlers.onresize=this.onresize.bind(this)).resize(),this.$(".Scrubber-scrollbar").bind("click",this.onclick.bind(this)).bind("dragstart mousedown touchstart",(function(t){return t.preventDefault()})),this.dragging=!1,this.mouseStart=0,this.indexStart=0,this.$(".Scrubber-handle").bind("mousedown touchstart",this.onmousedown.bind(this)).click((function(t){return t.stopPropagation()})),$(document).on("mousemove touchmove",this.handlers.onmousemove=this.onmousemove.bind(this)).on("mouseup touchend",this.handlers.onmouseup=this.onmouseup.bind(this)),setTimeout((function(){return n.scrollListener.start()})),this.stream.loadPromise.then((function(){return n.updateScrubberValues({animate:!1,forceHeightChange:!0})}))},n.onremove=function(){this.scrollListener.stop(),$(window).off("resize",this.handlers.onresize),$(document).off("mousemove touchmove",this.handlers.onmousemove).off("mouseup touchend",this.handlers.onmouseup)},n.updateScrubberValues=function(t){var e=this;void 0===t&&(t={});var n=this.stream.index,s=this.stream.count(),i=this.stream.visible||1,o=this.percentPerPost(),r=this.$();r.find(".Scrubber-index").text((0,l.Z)(this.stream.sanitizeIndex(Math.max(1,n)))),r.find(".Scrubber-description").text(this.stream.description),r.toggleClass("disabled",this.stream.disabled());var a={};if(a.before=Math.max(0,o.index*Math.min(n-1,s-i)),a.handle=Math.min(100-a.before,o.visible*i),a.after=100-a.before-a.handle,!(t.fromScroll&&this.stream.paused||this.adjustingHeight&&!t.forceHeightChange)){var u=t.animate?"animate":"css";this.adjustingHeight=!0;var c=[];for(var h in a){var p=r.find(".Scrubber-"+h);c.push(p.stop(!0,!0)[u]({height:a[h]+"%"},"fast").promise()),"animate"===u&&p.css("overflow","visible")}Promise.all(c).then((function(){return e.adjustingHeight=!1}))}},n.goToFirst=function(){this.stream.goToFirst(),this.updateScrubberValues({animate:!0,forceHeightChange:!0})},n.goToLast=function(){this.stream.goToLast(),this.updateScrubberValues({animate:!0,forceHeightChange:!0})},n.onresize=function(){var t=this.$(),e=this.$(".Scrubber-scrollbar");e.css("max-height",$(window).height()-t.offset().top+$(window).scrollTop()-parseInt($("#app").css("padding-bottom"),10)-(t.outerHeight()-e.outerHeight()))},n.onmousedown=function(t){t.redraw=!1,this.mouseStart=t.clientY||t.originalEvent.touches[0].clientY,this.indexStart=this.stream.index,this.dragging=!0,$("body").css("cursor","move"),this.$().toggleClass("dragging",this.dragging)},n.onmousemove=function(t){if(this.dragging){var e=((t.clientY||t.originalEvent.touches[0].clientY)-this.mouseStart)/this.$(".Scrubber-scrollbar").outerHeight()*100/this.percentPerPost().index||0,n=Math.min(this.indexStart+e,this.stream.count()-1);this.stream.index=Math.max(0,n),this.updateScrubberValues()}},n.onmouseup=function(){if(this.$().toggleClass("dragging",this.dragging),this.dragging){this.mouseStart=0,this.indexStart=0,this.dragging=!1,$("body").css("cursor",""),this.$().removeClass("open");var t=Math.floor(this.stream.index);this.stream.goToIndex(t)}},n.onclick=function(t){var e=this.$(".Scrubber-scrollbar"),n=((t.pageY||t.originalEvent.touches[0].pageY)-e.offset().top+$("body").scrollTop())/e.outerHeight()*100,s=(n-=parseFloat(e.find(".Scrubber-handle")[0].style.height)/2)/this.percentPerPost().index;s=Math.max(0,Math.min(this.stream.count()-1,s)),this.stream.goToIndex(Math.floor(s)),this.updateScrubberValues({animate:!0,forceHeightChange:!0}),this.$().removeClass("open")},n.percentPerPost=function(){var t=this.stream.count()||1,e=this.stream.visible||1,n=50/this.$(".Scrubber-scrollbar").outerHeight()*100,s=Math.max(100/t,n/e);return{index:t===e?0:(100-s*e)/(t-e),visible:s}},e}(u.Z),d=n(2232),f=n(1342),v=n(1698),g=n(2956),b=n(5214),w=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var i=e.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.useBrowserScrollRestoration=!1,this.discussion=null,this.near=m.route.param("near")||0,this.load(),app.discussions.hasDiscussions()&&(app.pane.enable(),app.pane.hide()),app.history.push("discussion"),this.bodyClass="App--discussion"},i.onremove=function(){t.prototype.onremove.call(this),app.pane.disable(),app.composer.composingReplyTo(this.discussion)&&!app.composer.fields.content()?app.composer.hide():app.composer.minimize()},i.view=function(){var t=this.discussion,e=this.PostStream;return m("div",{className:"DiscussionPage"},m(a.Z,{state:app.discussions}),m("div",{className:"DiscussionPage-discussion"},t?[r.Z.component({discussion:t}),m("div",{className:"container"},m("nav",{className:"DiscussionPage-nav"},m("ul",null,(0,v.Z)(this.sidebarItems().toArray()))),m("div",{className:"DiscussionPage-stream"},e?m(e,{discussion:t,stream:this.stream,onPositionChange:this.positionChanged.bind(this)}):d.Z.component({className:"LoadingIndicator--block"})))]:d.Z.component({className:"LoadingIndicator--block"})))},i.load=function(){var t=this;n.e(563).then(n.bind(n,5915)).then((function(e){t.PostStream=e.default,m.redraw()}));var e=app.preloadedApiDocument();if(e)setTimeout(this.show.bind(this,e),0);else{var s=this.requestParams();app.store.find("discussions",m.route.param("id"),s).then(this.show.bind(this))}m.redraw()},i.requestParams=function(){return{bySlug:!0,page:{near:this.near}}},i.show=function(t){var e=this;app.history.push("discussion",t.title()),app.setTitle(t.title()),app.setTitleCount(0);var n=[];if(t.payload&&t.payload.included){var s=t.id();n=t.payload.included.filter((function(t){return"posts"===t.type&&t.relationships&&t.relationships.discussion&&t.relationships.discussion.data.id===s})).map((function(t){return app.store.getById("posts",t.id)})).sort((function(t,e){return t.createdAt()-e.createdAt()})).slice(0,20)}this.stream=new b.Z(t,n),this.stream.goToNumber(m.route.param("near")||n[0]&&n[0].number(),!0).then((function(){e.discussion=t,app.current.set("discussion",t),app.current.set("stream",e.stream)}))},i.sidebarItems=function(){var t=new o.Z;return t.add("controls",f.Z.component({icon:"fas fa-ellipsis-v",className:"App-primaryControl",buttonClassName:"Button--primary",accessibleToggleLabel:app.translator.trans("core.forum.discussion_controls.toggle_dropdown_accessible_label")},g.Z.controls(this.discussion,this).toArray())),t.add("scrubber",p.component({stream:this.stream,className:"App-titleControl"}),-100),t},i.positionChanged=function(t,e){var n=this.discussion,s=app.route.discussion(n,this.near=t);window.history.replaceState(null,document.title,s),app.history.push("discussion",n.title()),app.session.user&&e>(n.lastReadPostNumber()||0)&&(n.save({lastReadPostNumber:e}),m.redraw())},e}(i.Z)},4588:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>c});var s=n(1788),i=n(8098),o=n(5462),r=n(9236),a=n(5052);function u(t){app.composer.isFullScreen()&&(app.composer.minimize(),t.stopPropagation())}var c=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.submitLabel=e.submitLabel||app.translator.trans("core.forum.composer_edit.submit_button"),e.confirmExit=e.confirmExit||app.translator.trans("core.forum.composer_edit.discard_confirmation"),e.originalContent=e.originalContent||e.post.content(),e.user=e.user||e.post.user(),e.post.editedContent=e.originalContent};var n=e.prototype;return n.headerItems=function(){var e=t.prototype.headerItems.call(this),n=this.attrs.post;return e.add("title",m("h3",null,(0,a.Z)("fas fa-pencil-alt")," ",m(r.Z,{href:app.route.discussion(n.discussion(),n.number()),onclick:u},app.translator.trans("core.forum.composer_edit.post_link",{number:n.number(),discussion:n.discussion().title()})))),e},n.jumpToPreview=function(t){u(t),m.route.set(app.route.post(this.attrs.post))},n.data=function(){return{content:this.composer.fields.content()}},n.onsubmit=function(){var t=this,e=this.attrs.post.discussion();this.loading=!0;var n=this.data();this.attrs.post.save(n).then((function(n){if(app.viewingDiscussion(e))app.current.get("stream").goToNumber(n.number());else{var s,i=o.Z.component({className:"Button Button--link",onclick:function(){m.route.set(app.route.post(n)),app.alerts.dismiss(s)}},app.translator.trans("core.forum.composer_edit.view_button"));s=app.alerts.show({type:"success",controls:[i]},app.translator.trans("core.forum.composer_edit.edited_message"))}t.composer.hide()}),this.loaded.bind(this))},e}(i.Z)},1867:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var s=n(2122),i=n(1788),o=n(1795),r=n(6646),a=n(3131),u=n(5052),c=n(9236),l=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.elementAttrs=function(){var e=t.prototype.elementAttrs.call(this);return e.className=(e.className||"")+" EventPost "+(0,r.ucfirst)(this.attrs.post.contentType())+"Post",e},n.content=function(){var e=this.attrs.post.user(),n=(0,a.Z)(e),i=(0,s.Z)(this.descriptionData(),{user:e,username:e?m(c.Z,{className:"EventPost-user",href:app.route.user(e)},n):n});return t.prototype.content.call(this).concat([(0,u.Z)(this.icon(),{className:"EventPost-icon"}),m("div",{class:"EventPost-info"},this.description(i))])},n.icon=function(){return""},n.description=function(t){return app.translator.transChoice(this.descriptionKey(),t.count,t)},n.descriptionKey=function(){return""},n.descriptionData=function(){return{}},e}(o.Z)},9086:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var s=n(1788),i=n(6366),o=n(6149),r=function(t){function e(){return t.apply(this,arguments)||this}return(0,s.Z)(e,t),e.prototype.view=function(){return m("div",{className:"Post CommentPost LoadingPost"},m("header",{className:"Post-header"},(0,o.Z)(null,{className:"PostUser-avatar"}),m("div",{className:"fakeText"})),m("div",{className:"Post-body"},m("div",{className:"fakeText"}),m("div",{className:"fakeText"}),m("div",{className:"fakeText"})))},e}(i.Z)},6349:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var s=n(1788),i=n(6366),o=n(7037),r=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.view=function(){return m("div",{className:"LogInButtons"},this.items().toArray())},n.items=function(){return new o.Z},e}(i.Z)},1795:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var s=n(1788),i=n(6366),o=n(8932),r=n(8777),a=n(809),u=n(1698),c=n(7037),l=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){var n=this;t.prototype.oninit.call(this,e),this.loading=!1,this.subtree=new o.Z((function(){return n.attrs.post.freshness}),(function(){var t=n.attrs.post.user();return t&&t.freshness}),(function(){return n.controlsOpen}))},n.view=function(){var t=this,e=this.elementAttrs();e.className=this.classes(e.className).join(" ");var n=a.Z.controls(this.attrs.post,this).toArray();return m("article",e,m("div",null,this.content(),m("aside",{className:"Post-actions"},m("ul",null,(0,u.Z)(this.actionItems().toArray()),n.length?m("li",null,m(r.Z,{className:"Post-controls",buttonClassName:"Button Button--icon Button--flat",menuClassName:"Dropdown-menu--right",icon:"fas fa-ellipsis-h",onshow:function(){return t.$(".Post-actions").addClass("open")},onhide:function(){return t.$(".Post-actions").removeClass("open")},accessibleToggleLabel:app.translator.trans("core.forum.post_controls.toggle_dropdown_accessible_label")},n)):"")),m("footer",{className:"Post-footer"},m("ul",null,(0,u.Z)(this.footerItems().toArray())))))},n.onbeforeupdate=function(e){return t.prototype.onbeforeupdate.call(this,e),this.subtree.needsRebuild()},n.onupdate=function(){var t=this.$(".Post-actions"),e=this.$(".Post-controls");t.toggleClass("open",e.hasClass("open"))},n.elementAttrs=function(){return{}},n.content=function(){return[]},n.classes=function(t){var e=(t||"").split(" ").concat(["Post"]),n=this.attrs.post.user(),s=this.attrs.post.discussion();return this.loading&&e.push("Post--loading"),n&&n===app.session.user&&e.push("Post--by-actor"),n&&n===s.user()&&e.push("Post--by-start-user"),e},n.actionItems=function(){return new c.Z},n.footerItems=function(){return new c.Z},e}(i.Z)},75:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(1788),i=n(6366),o=n(9090),r=n(8165),a=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.shouldUpdateTooltip=!1,this.oldEditedInfo=null},n.view=function(){var t=this.attrs.post,e=t.editedUser(),n=(0,r.Z)(app.translator.trans("core.forum.post.edited_tooltip",{user:e,ago:(0,o.Z)(t.editedAt())}));return n!==this.oldEditedInfo&&(this.shouldUpdateTooltip=!0,this.oldEditedInfo=n),m("span",{className:"PostEdited",title:n},app.translator.trans("core.forum.post.edited_text"))},n.oncreate=function(e){t.prototype.oncreate.call(this,e),this.rebuildTooltip()},n.onupdate=function(){this.rebuildTooltip()},n.rebuildTooltip=function(){this.shouldUpdateTooltip&&(this.$().tooltip("destroy").tooltip(),this.shouldUpdateTooltip=!1)},e}(i.Z)},431:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(1788),i=n(6366),o=n(7603),r=n(7693),a=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.view=function(){var t=this.attrs.post,e=t.createdAt(),n=this.getPermalink(t),s="ontouchstart"in document.documentElement;return m("div",{className:"Dropdown PostMeta"},m("a",{className:"Dropdown-toggle",onclick:function(t){var e=this;setTimeout((function(){return $(e).parent().find(".PostMeta-permalink").select()})),t.redraw=!1},"data-toggle":"dropdown"},(0,o.Z)(e)),m("div",{className:"Dropdown-menu dropdown-menu"},m("span",{className:"PostMeta-number"},app.translator.trans("core.forum.post.number_tooltip",{number:t.number()}))," ",m("span",{className:"PostMeta-time"},(0,r.Z)(e))," ",m("span",{className:"PostMeta-ip"},t.data.attributes.ipAddress),s?m("a",{className:"Button PostMeta-permalink",href:n},n):m("input",{className:"FormControl PostMeta-permalink",value:n,onclick:function(t){return t.stopPropagation()}})))},n.getPermalink=function(t){return window.location.origin+app.route.post(t)},e}(i.Z)},474:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var s=n(1788),i=n(6366),o=n(9236),r=n(5789),a=n(6149),u=n(3131),c=n(947),l=n(1698),h=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.view=function(){var t=this.attrs.post,e=t.user();if(!e)return m("div",{className:"PostUser"},m("h3",null,(0,a.Z)(e,{className:"PostUser-avatar"})," ",(0,u.Z)(e)));var n="";return!t.isHidden()&&this.attrs.cardVisible&&(n=r.Z.component({user:e,className:"UserCard--popover",controlsButtonClassName:"Button Button--icon Button--flat"})),m("div",{className:"PostUser"},m("h3",null,m(o.Z,{href:app.route.user(e)},(0,a.Z)(e,{className:"PostUser-avatar"}),(0,c.Z)(e),(0,u.Z)(e))),m("ul",{className:"PostUser-badges badges"},(0,l.Z)(e.badges().toArray())),n)},n.oncreate=function(e){var n,s=this;t.prototype.oncreate.call(this,e),this.$().on("mouseover","h3 a, .UserCard",(function(){clearTimeout(n),n=setTimeout(s.showCard.bind(s),500)})).on("mouseout","h3 a, .UserCard",(function(){clearTimeout(n),n=setTimeout(s.hideCard.bind(s),250)}))},n.showCard=function(){var t=this;this.attrs.oncardshow(),setTimeout((function(){return t.$(".UserCard").addClass("in")}))},n.hideCard=function(){var t=this;this.$(".UserCard").removeClass("in").one("transitionend webkitTransitionEnd oTransitionEnd",(function(){t.attrs.oncardhide()}))},e}(i.Z)},2402:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(1788),i=n(8292),o=n(5462),r=n(9015),a=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.discussion=this.attrs.discussion,this.currentTitle=this.attrs.currentTitle,this.newTitle=(0,r.Z)(this.currentTitle)},n.className=function(){return"RenameDiscussionModal Modal--small"},n.title=function(){return app.translator.trans("core.forum.rename_discussion.title")},n.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("div",{className:"Form-group"},m("input",{className:"FormControl",bidi:this.newTitle,type:"text"})),m("div",{className:"Form-group"},o.Z.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("core.forum.rename_discussion.submit_button")))))},n.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0;var n=this.newTitle(),s=this.currentTitle;if(n&&n!==s)return this.discussion.save({title:n}).then((function(){app.viewingDiscussion(e.discussion)&&app.current.get("stream").update(),m.redraw(),e.hide()})).catch((function(){e.loading=!1,m.redraw()}));this.hide()},e}(i.Z)},8933:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var s=n(1788),i=n(8098),o=n(5462),r=n(9236),a=n(5052),u=n(8165);function c(t){app.composer.isFullScreen()&&(app.composer.minimize(),t.stopPropagation())}var l=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.placeholder=e.placeholder||(0,u.Z)(app.translator.trans("core.forum.composer_reply.body_placeholder")),e.submitLabel=e.submitLabel||app.translator.trans("core.forum.composer_reply.submit_button"),e.confirmExit=e.confirmExit||(0,u.Z)(app.translator.trans("core.forum.composer_reply.discard_confirmation"))};var n=e.prototype;return n.headerItems=function(){var e=t.prototype.headerItems.call(this),n=this.attrs.discussion;return e.add("title",m("h3",null,(0,a.Z)("fas fa-reply")," ",m(r.Z,{href:app.route.discussion(n),onclick:c},n.title()))),e},n.jumpToPreview=function(t){c(t),m.route.set(app.route.discussion(this.attrs.discussion,"reply"))},n.data=function(){return{content:this.composer.fields.content(),relationships:{discussion:this.attrs.discussion}}},n.onsubmit=function(){var t=this,e=this.attrs.discussion;this.loading=!0,m.redraw();var n=this.data();app.store.createRecord("posts").save(n).then((function(n){if(app.viewingDiscussion(e)){var s=app.current.get("stream");s.update().then((function(){return s.goToNumber(n.number())}))}else{var i,r=o.Z.component({className:"Button Button--link",onclick:function(){m.route.set(app.route.post(n)),app.alerts.dismiss(i)}},app.translator.trans("core.forum.composer_reply.view_button"));i=app.alerts.show({type:"success",controls:[r]},app.translator.trans("core.forum.composer_reply.posted_message"))}t.composer.hide()}),this.loaded.bind(this))},e}(i.Z)},3097:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(1788),i=n(6366),o=n(7603),r=n(5052),a=function(t){function e(){return t.apply(this,arguments)||this}return(0,s.Z)(e,t),e.prototype.view=function(){var t=this.attrs.discussion,e=this.attrs.lastPost&&t.replyCount(),n=t[e?"lastPostedUser":"user"](),s=t[e?"lastPostedAt":"createdAt"]();return m("span",null,e?(0,r.Z)("fas fa-reply"):""," ",app.translator.trans("core.forum.discussion_list."+(e?"replied":"started")+"_text",{user:n,ago:(0,o.Z)(s)}))},e}(i.Z)},5789:(t,e,n)=>{"use strict";n.d(e,{Z:()=>v});var s=n(1788),i=n(6366),o=n(9090),r=n(7037),a=n(4683),u=n(6149),c=n(3131),l=n(5052),h=n(8777),p=n(9236),d=n(504),f=n(1698),v=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.view=function(){var t=this.attrs.user,e=a.Z.controls(t,this).toArray(),n=t.color(),s=t.badges().toArray();return m("div",{className:"UserCard "+(this.attrs.className||""),style:n?{backgroundColor:n}:""},m("div",{className:"darkenBackground"},m("div",{className:"container"},e.length?h.Z.component({className:"UserCard-controls App-primaryControl",menuClassName:"Dropdown-menu--right",buttonClassName:this.attrs.controlsButtonClassName,label:app.translator.trans("core.forum.user_controls.button"),accessibleToggleLabel:app.translator.trans("core.forum.user_controls.toggle_dropdown_accessible_label"),icon:"fas fa-ellipsis-v"},e):"",m("div",{className:"UserCard-profile"},m("h2",{className:"UserCard-identity"},this.attrs.editable?[d.Z.component({user:t,className:"UserCard-avatar"}),(0,c.Z)(t)]:m(p.Z,{href:app.route.user(t)},m("div",{className:"UserCard-avatar"},(0,u.Z)(t)),(0,c.Z)(t))),s.length?m("ul",{className:"UserCard-badges badges"},(0,f.Z)(s)):"",m("ul",{className:"UserCard-info"},(0,f.Z)(this.infoItems().toArray()))))))},n.infoItems=function(){var t=new r.Z,e=this.attrs.user,n=e.lastSeenAt();if(n){var s=e.isOnline();t.add("lastSeen",m("span",{className:"UserCard-lastSeen"+(s?" online":"")},s?[(0,l.Z)("fas fa-circle")," ",app.translator.trans("core.forum.user.online_text")]:[(0,l.Z)("far fa-clock")," ",(0,o.Z)(n)]))}return t.add("joined",m("span",{className:"UserCard-joinedAt"},app.translator.trans("core.forum.user.joined_date_text",{ago:(0,o.Z)(e.joinTime())}))),t},e}(i.Z)},5308:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var s=n(1788),i=n(3340),o=n(7037),r=n(5789),a=n(2232),u=n(6317),c=n(7971),l=n(2939),h=n(1698),p=n(1546),d=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.user=null,this.bodyClass="App--user"},n.view=function(){return m("div",{className:"UserPage"},this.user?[m(r.Z,{user:this.user,className:"Hero UserHero",editable:this.user.canEdit()||this.user===app.session.user,controlsButtonClassName:"Button"}),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m(p.Z,null,m("nav",{className:"sideNav UserPage-nav"},m("ul",null,(0,h.Z)(this.sidebarItems().toArray())))),m("div",{className:"sideNavOffset UserPage-content"},this.content())))]:[m(a.Z,{className:"LoadingIndicator--block"})])},n.content=function(){},n.show=function(t){this.user=t,app.current.set("user",t),app.setTitle(t.displayName()),m.redraw()},n.loadUser=function(t){var e=this,n=t.toLowerCase();app.preloadedApiDocument(),app.store.all("users").some((function(s){if((s.username().toLowerCase()===n||s.id()===t)&&s.joinTime())return e.show(s),!0})),this.user||app.store.find("users",t,{bySlug:!0}).then(this.show.bind(this))},n.sidebarItems=function(){var t=new o.Z;return t.add("nav",m(u.Z,{className:"App-titleControl",buttonClassName:"Button"},this.navItems().toArray())),t},n.navItems=function(){var t=new o.Z,e=this.user;return t.add("posts",m(c.Z,{href:app.route("user.posts",{username:e.username()}),icon:"far fa-comment"},app.translator.trans("core.forum.user.posts_link")," ",m("span",{className:"Button-badge"},e.commentCount())),100),t.add("discussions",m(c.Z,{href:app.route("user.discussions",{username:e.username()}),icon:"fas fa-bars"},app.translator.trans("core.forum.user.discussions_link")," ",m("span",{className:"Button-badge"},e.discussionCount())),90),app.session.user===e&&(t.add("separator",m(l.Z,null),-90),t.add("settings",m(c.Z,{href:app.route("settings"),icon:"fas fa-cog"},app.translator.trans("core.forum.user.settings_link")),-100)),t},e}(i.Z)},9499:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var s=n(1788),i=n(6366),o=n(5462),r=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.hidden=localStorage.getItem("welcomeHidden")},n.view=function(){var t=this;return this.hidden?m("div",null):m("header",{className:"Hero WelcomeHero"},m("div",{class:"container"},o.Z.component({icon:"fas fa-times",onclick:function(){t.$().slideUp(t.hide.bind(t))},className:"Hero-close Button Button--icon Button--link"}),m("div",{className:"containerNarrow"},m("h2",{className:"Hero-title"},app.forum.attribute("welcomeTitle")),m("div",{className:"Hero-subtitle"},m.trust(app.forum.attribute("welcomeMessage"))))))},n.hide=function(){localStorage.setItem("welcomeHidden","true"),this.hidden=!0},e}(i.Z)},93:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var s=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=window.app),this.params=t,this.app=e,this.discussions=[],this.moreResults=!1,this.loading=!1}var e=t.prototype;return e.requestParams=function(){var t={include:["user","lastPostedUser"],filter:{}};return t.sort=this.sortMap()[this.params.sort],this.params.q&&(t.filter.q=this.params.q,t.include.push("mostRelevantPost","mostRelevantPost.user")),t},e.sortMap=function(){var t={};return this.params.q&&(t.relevance=""),t.latest="-lastPostedAt",t.top="-commentCount",t.newest="-createdAt",t.oldest="createdAt",t},e.getParams=function(){return this.params},e.clear=function(){this.discussions=[],m.redraw()},e.refreshParams=function(t){var e=this;this.hasDiscussions()&&!Object.keys(t).some((function(n){return e.getParams()[n]!==t[n]}))||(this.params=t,this.refresh())},e.refresh=function(t){var e=this,n=(void 0===t?{}:t).deferClear,s=void 0!==n&&n;return this.loading=!0,s||this.clear(),this.loadResults().then((function(t){e.discussions=[],e.parseResults(t)}),(function(){e.loading=!1,m.redraw()}))},e.loadResults=function(t){var e=this.app.preloadedApiDocument();if(e)return Promise.resolve(e);var n=this.requestParams();return n.page={offset:t},n.include=n.include.join(","),this.app.store.find("discussions",n)},e.loadMore=function(){this.loading=!0,this.loadResults(this.discussions.length).then(this.parseResults.bind(this))},e.parseResults=function(t){var e;return(e=this.discussions).push.apply(e,t),this.loading=!1,this.moreResults=!!t.payload.links&&!!t.payload.links.next,m.redraw(),t},e.removeDiscussion=function(t){var e=this.discussions.indexOf(t);-1!==e&&this.discussions.splice(e,1),m.redraw()},e.addDiscussion=function(t){this.discussions.unshift(t),m.redraw()},e.hasDiscussions=function(){return this.discussions.length>0},e.isLoading=function(){return this.loading},e.isSearchResults=function(){return!!this.params.q},e.empty=function(){return!this.hasDiscussions()&&!this.isLoading()},t}()},5214:(t,e,n)=>{"use strict";n.d(e,{Z:()=>y});const s=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var i=n(3249);const o=function(){return i.Z.Date.now()};var r=/\s/;var a=/^\s+/;const u=function(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&r.test(t.charAt(e)););return e}(t)+1).replace(a,""):t};var c=n(7828),l=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,p=/^0o[0-7]+$/i,d=parseInt;const f=function(t){if("number"==typeof t)return t;if((0,c.Z)(t))return NaN;if(s(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=s(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=u(t);var n=h.test(t);return n||p.test(t)?d(t.slice(2),n?2:8):l.test(t)?NaN:+t};var v=Math.max,g=Math.min;const b=function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return s(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),function(t,e,n){var i,r,a,u,c,l,h=0,p=!1,d=!1,m=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function b(e){var n=i,s=r;return i=r=void 0,h=e,u=t.apply(s,n)}function w(t){return h=t,c=setTimeout(y,e),p?b(t):u}function Z(t){var n=t-l;return void 0===l||n>=e||n<0||d&&t-h>=a}function y(){var t=o();if(Z(t))return N(t);c=setTimeout(y,function(t){var n=e-(t-l);return d?g(n,a-(t-h)):n}(t))}function N(t){return c=void 0,m&&i?b(t):(i=r=void 0,u)}function C(){var t=o(),n=Z(t);if(i=arguments,r=this,l=t,n){if(void 0===c)return w(l);if(d)return clearTimeout(c),c=setTimeout(y,e),b(l)}return void 0===c&&(c=setTimeout(y,e)),u}return e=f(e)||0,s(n)&&(p=!!n.leading,a=(d="maxWait"in n)?v(f(n.maxWait)||0,e):a,m="trailing"in n?!!n.trailing:m),C.cancel=function(){void 0!==c&&clearTimeout(c),h=0,i=l=r=c=void 0},C.flush=function(){return void 0===c?u:N(o())},C}(t,e,{leading:i,maxWait:e,trailing:r})};var w=n(3927),Z=function(){function t(t,e){void 0===e&&(e=[]),this.discussion=t,this.paused=!1,this.loadPageTimeouts={},this.pagesLoading=0,this.index=0,this.number=1,this.visible=1,this.description="",this.forceUpdateScrubber=!1,this.loadNext=b(this._loadNext,300),this.loadPrevious=b(this._loadPrevious,300),this.show(e)}var e=t.prototype;return e.update=function(){return this.viewingEnd()?(this.visibleEnd=this.count(),this.loadRange(this.visibleStart,this.visibleEnd)):Promise.resolve()},e.goToFirst=function(){return this.goToIndex(0)},e.goToLast=function(){return this.goToIndex(this.count()-1,!0)},e.goToNumber=function(t,e){if(void 0===e&&(e=!1),"reply"===t){var n=this.goToLast();return this.targetPost.reply=!0,n}return this.paused=!0,this.loadPromise=this.loadNearNumber(t),this.needsScroll=!0,this.targetPost={number:t},this.animateScroll=!e,this.number=t,this.loadPromise.then((function(){return m.redraw()}))},e.goToIndex=function(t,e){return void 0===e&&(e=!1),this.paused=!0,this.loadPromise=this.loadNearIndex(t),this.needsScroll=!0,this.targetPost={index:t},this.animateScroll=!e,this.index=t,m.redraw(),this.loadPromise},e.loadNearNumber=function(t){return this.posts().some((function(e){return e&&Number(e.number())===Number(t)}))?Promise.resolve():(this.reset(),app.store.find("posts",{filter:{discussion:this.discussion.id()},page:{near:t}}).then(this.show.bind(this)))},e.loadNearIndex=function(t){if(t>=this.visibleStart&&t<this.visibleEnd)return Promise.resolve();var e=this.sanitizeIndex(t-this.constructor.loadCount/2),n=e+this.constructor.loadCount;return this.reset(e,n),this.loadRange(e,n).then(this.show.bind(this))},e._loadNext=function(){var t=this.visibleEnd,e=this.visibleEnd=this.sanitizeIndex(this.visibleEnd+this.constructor.loadCount),n=t-2*this.constructor.loadCount;n>this.visibleStart&&n>=0&&(this.visibleStart=n+this.constructor.loadCount+1,this.loadPageTimeouts[n]&&(clearTimeout(this.loadPageTimeouts[n]),this.loadPageTimeouts[n]=null,this.pagesLoading--)),this.loadPage(t,e)},e._loadPrevious=function(){var t=this.visibleStart,e=this.visibleStart=this.sanitizeIndex(this.visibleStart-this.constructor.loadCount),n=e+2*this.constructor.loadCount;n<this.visibleEnd&&n<=this.count()&&(this.visibleEnd=n,this.loadPageTimeouts[n]&&(clearTimeout(this.loadPageTimeouts[n]),this.loadPageTimeouts[n]=null,this.pagesLoading--)),this.loadPage(e,t,!0)},e.loadPage=function(t,e,n){var s=this;void 0===n&&(n=!1),this.pagesLoading++;var i=function(){if(!(t<s.visibleStart||e>s.visibleEnd)){var i=n?s.visibleEnd-1:s.visibleStart;(0,w.Z)('.PostStream-item[data-index="'+i+'"]',m.redraw.sync)}};i(),this.loadPageTimeouts[t]=setTimeout((function(){s.loadRange(t,e).then((function(){i(),s.pagesLoading--})),s.loadPageTimeouts[t]=null}),this.pagesLoading-1?1e3:0)},e.loadRange=function(t,e){var n=[],s=[];return this.discussion.postIds().slice(t,e).forEach((function(t){var e=app.store.getById("posts",t);e&&e.discussion()&&void 0!==e.canEdit()?s.push(e):n.push(t)})),n.length?app.store.find("posts",n).then((function(t){return s.concat(t).sort((function(t,e){return t.createdAt()-e.createdAt()}))})):Promise.resolve(s)},e.show=function(t){this.visibleStart=t.length?this.discussion.postIds().indexOf(t[0].id()):0,this.visibleEnd=this.sanitizeIndex(this.visibleStart+t.length)},e.reset=function(t,e){this.visibleStart=t||0,this.visibleEnd=this.sanitizeIndex(e||this.constructor.loadCount)},e.posts=function(){return this.discussion.postIds().slice(this.visibleStart,this.visibleEnd).map((function(t){var e=app.store.getById("posts",t);return e&&e.discussion()&&void 0!==e.canEdit()?e:null}))},e.count=function(){return this.discussion.postIds().length},e.disabled=function(){return this.visible>=this.count()},e.viewingEnd=function(){return Math.abs(this.count()-this.visibleEnd)<=1},e.sanitizeIndex=function(t){return Math.max(0,Math.min(this.count(),Math.floor(t)))},t}();Z.loadCount=20;const y=Z},2956:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var s=n(7757),i=n.n(s),o=n(2137),r=n(6801),a=n(5462),u=n(2939),c=n(2402),l=n(7037),h=n(8165);const p={controls:function(t,e){var n=this,s=new l.Z;return["user","moderation","destructive"].forEach((function(i){var o=n[i+"Controls"](t,e).toArray();o.length&&(o.forEach((function(t){return s.add(t.itemName,t)})),s.add(i+"Separator",u.Z.component()))})),s},userControls:function(t,e){var n=this,s=new l.Z;return e instanceof r.Z&&s.add("reply",!app.session.user||t.canReply()?a.Z.component({icon:"fas fa-reply",onclick:function(){return n.replyAction.bind(t)(!0,!1).catch((function(){}))}},app.translator.trans(app.session.user?"core.forum.discussion_controls.reply_button":"core.forum.discussion_controls.log_in_to_reply_button")):a.Z.component({icon:"fas fa-reply",className:"disabled",title:app.translator.trans("core.forum.discussion_controls.cannot_reply_text")},app.translator.trans("core.forum.discussion_controls.cannot_reply_button"))),s},moderationControls:function(t){var e=new l.Z;return t.canRename()&&e.add("rename",a.Z.component({icon:"fas fa-pencil-alt",onclick:this.renameAction.bind(t)},app.translator.trans("core.forum.discussion_controls.rename_button"))),e},destructiveControls:function(t){var e=new l.Z;return t.isHidden()?(t.canHide()&&e.add("restore",a.Z.component({icon:"fas fa-reply",onclick:this.restoreAction.bind(t)},app.translator.trans("core.forum.discussion_controls.restore_button"))),t.canDelete()&&e.add("delete",a.Z.component({icon:"fas fa-times",onclick:this.deleteAction.bind(t)},app.translator.trans("core.forum.discussion_controls.delete_forever_button")))):t.canHide()&&e.add("hide",a.Z.component({icon:"far fa-trash-alt",onclick:this.hideAction.bind(t)},app.translator.trans("core.forum.discussion_controls.delete_button"))),e},replyAction:function(t,e){var s=this,r=function(){return n.e(460).then(n.bind(n,5127))},a=function(){return Promise.resolve().then(n.bind(n,8933))};return new Promise(function(){var n=(0,o.Z)(i().mark((function n(o,u){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!app.session.user){n.next=12;break}if(!s.canReply()){n.next=11;break}if(app.composer.composingReplyTo(s)&&!e){n.next=5;break}return n.next=5,app.composer.load(a,{user:app.session.user,discussion:s});case 5:return console.log("hi"),app.composer.show(),t&&app.viewingDiscussion(s)&&!app.composer.isFullScreen()&&app.current.get("stream").goToNumber("reply"),n.abrupt("return",o(app.composer));case 11:return n.abrupt("return",u());case 12:return app.modal.show(r),n.abrupt("return",u());case 14:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())},hideAction:function(){return this.pushAttributes({hiddenAt:new Date,hiddenUser:app.session.user}),this.save({isHidden:!0})},restoreAction:function(){return this.pushAttributes({hiddenAt:null,hiddenUser:null}),this.save({isHidden:!1})},deleteAction:function(){var t=this;if(confirm((0,h.Z)(app.translator.trans("core.forum.discussion_controls.delete_confirmation"))))return app.viewingDiscussion(this)&&app.history.back(),this.delete().then((function(){return app.discussions.removeDiscussion(t)}))},renameAction:function(){return app.modal.show(c.Z,{currentTitle:this.title(),discussion:this})}}},809:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var s=n(4588),i=n(5462),o=n(2939),r=n(7037),a=n(8165);const u={controls:function(t,e){var n=this,s=new r.Z;return["user","moderation","destructive"].forEach((function(i){var r=n[i+"Controls"](t,e).toArray();r.length&&(r.forEach((function(t){return s.add(t.itemName,t)})),s.add(i+"Separator",o.Z.component()))})),s},userControls:function(t,e){return new r.Z},moderationControls:function(t,e){var n=new r.Z;return"comment"===t.contentType()&&t.canEdit()&&(t.isHidden()||n.add("edit",i.Z.component({icon:"fas fa-pencil-alt",onclick:this.editAction.bind(t)},app.translator.trans("core.forum.post_controls.edit_button")))),n},destructiveControls:function(t,e){var n=new r.Z;return"comment"!==t.contentType()||t.isHidden()?("comment"===t.contentType()&&t.canHide()&&n.add("restore",i.Z.component({icon:"fas fa-reply",onclick:this.restoreAction.bind(t)},app.translator.trans("core.forum.post_controls.restore_button"))),t.canDelete()&&n.add("delete",i.Z.component({icon:"fas fa-times",onclick:this.deleteAction.bind(t,e)},app.translator.trans("core.forum.post_controls.delete_forever_button")))):t.canHide()&&n.add("hide",i.Z.component({icon:"far fa-trash-alt",onclick:this.hideAction.bind(t)},app.translator.trans("core.forum.post_controls.delete_button"))),n},editAction:function(){var t=this;return new Promise((function(e){return app.composer.load(s.default,{post:t}),app.composer.show(),e()}))},hideAction:function(){if(confirm((0,a.Z)(app.translator.trans("core.forum.post_controls.hide_confirmation"))))return this.pushAttributes({hiddenAt:new Date,hiddenUser:app.session.user}),this.save({isHidden:!0}).then((function(){return m.redraw()}))},restoreAction:function(){return this.pushAttributes({hiddenAt:null,hiddenUser:null}),this.save({isHidden:!1}).then((function(){return m.redraw()}))},deleteAction:function(t){var e=this;if(confirm((0,a.Z)(app.translator.trans("core.forum.post_controls.delete_confirmation"))))return t&&(t.loading=!0),this.delete().then((function(){var t=e.discussion();t.removePost(e.id()),t.postIds().length||(app.discussions.removeDiscussion(t),app.viewingDiscussion(t)&&app.history.back())})).catch((function(){})).then((function(){t&&(t.loading=!1),m.redraw()}))}}},4683:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var s=n(5462),i=n(2939),o=n(5308),r=n(7037);const a={controls:function(t,e){var n=this,s=new r.Z;return["user","moderation","destructive"].forEach((function(o){var r=n[o+"Controls"](t,e).toArray();r.length&&(r.forEach((function(t){return s.add(t.itemName,t)})),s.add(o+"Separator",m(i.Z,null)))})),s},userControls:function(){return new r.Z},moderationControls:function(t){var e=new r.Z;return(t.canEdit()||t.canEditCredentials()||t.canEditGroups())&&e.add("edit",m(s.Z,{icon:"fas fa-pencil-alt",onclick:this.editAction.bind(this,t)},app.translator.trans("core.forum.user_controls.edit_button"))),e},destructiveControls:function(t){var e=new r.Z;return"1"!==t.id()&&t.canDelete()&&e.add("delete",m(s.Z,{icon:"fas fa-times",onclick:this.deleteAction.bind(this,t)},app.translator.trans("core.forum.user_controls.delete_button"))),e},deleteAction:function(t){var e=this;confirm(app.translator.trans("core.forum.user_controls.delete_confirmation"))&&t.delete().then((function(){e.showDeletionAlert(t,"success"),app.current.matches(o.Z,{user:t})?app.history.back():window.location.reload()})).catch((function(){return e.showDeletionAlert(t,"error")}))},showDeletionAlert:function(t,e){var n=t.data.attributes,s=n.username,i=n.email,o={success:"core.forum.user_controls.delete_success_message",error:"core.forum.user_controls.delete_error_message"}[e];app.alerts.show({type:e},app.translator.trans(o,{username:s,email:i}))},editAction:function(t){app.modal.show((function(){return n.e(352).then(n.bind(n,9106))}),{user:t})}}},8236:(t,e,n)=>{"use strict";function s(t){var e,n,s,i,o=$(t),r=!1,a=!1,u=0,c=function(t,e){void 0===e&&(e={}),e.duration=e.duration||"fast",e.step=function(t){$(this).css("transform","translate("+t+"px, 0)")},o.find(".Slidable-content").animate({"background-position-x":t},e)},l=function(){c(0,{complete:function(){o.removeClass("sliding"),e.hide(),n.hide(),a=!1}})};return o.find(".Slidable-content").on("touchstart",(function(t){e=o.find(".Slidable-underneath--left:not(.disabled)"),n=o.find(".Slidable-underneath--right:not(.disabled)"),s=t.originalEvent.targetTouches[0].clientX,i=t.originalEvent.targetTouches[0].clientY,r=!0,u=0})).on("touchmove",(function(t){var c=t.originalEvent.targetTouches[0].clientX,l=t.originalEvent.targetTouches[0].clientY;if(r&&Math.abs(c-s)>Math.abs(l-i)&&(a=!0),r=!1,a){u=c-s;var h=function(t,e){if(t.length){var n="left"===e?u>0:u<0;n&&t.hasClass("Slidable-underneath--elastic")&&(u-=.5*u),t.toggle(n);var s=Math.max(0,Math.min(1,(Math.abs(u)-25)/50));t.find(".icon").css("transform","scale("+s+")")}else u=Math["left"===e?"min":"max"](0,u)};h(e,"left"),h(n,"right"),$(this).css("transform","translate("+u+"px, 0)"),$(this).css("background-position-x",u+"px"),o.toggleClass("sliding",!!u),t.preventDefault()}})).on("touchend",(function(){var t=function(t){t.click(),t.hasClass("Slidable-underneath--elastic")?l():c((u>0?1:-1)*o.width())};n.length&&u<-50?t(n):e.length&&u>50?t(e):l(),r=!1,a=!1})),{reset:l}}n.d(e,{Z:()=>s})},9089:t=>{var e=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.update=function(t){this.context.putImageData(t,0,0)},e.prototype.getPixelCount=function(){return this.width*this.height},e.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},e.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var n=function(){};if(n.prototype.getColor=function(t,e){return this.getPalette(t,5,e)[0]},n.prototype.getPalette=function(t,n,s){void 0===n&&(n=10),(void 0===s||1>s)&&(s=10);for(var o,r,a,u,c=new e(t),l=c.getImageData().data,h=c.getPixelCount(),p=[],d=0;h>d;d+=s)r=l[0+(o=4*d)],a=l[o+1],u=l[o+2],l[o+3]>=125&&(r>250&&a>250&&u>250||p.push([r,a,u]));var m=i.quantize(p,n),f=m?m.palette():null;return c.removeCanvas(),f},!s)var s={map:function(t,e){var n={};return e?t.map((function(t,s){return n.index=s,e.call(n,t)})):t.slice()},naturalOrder:function(t,e){return e>t?-1:t>e?1:0},sum:function(t,e){var n={};return t.reduce(e?function(t,s,i){return n.index=i,t+e.call(n,s)}:function(t,e){return t+e},0)},max:function(t,e){return Math.max.apply(null,e?s.map(t,e):t)}};var i=function(){function t(t,e,n){return(t<<2*u)+(e<<u)+n}function e(t){function e(){n.sort(t),s=!0}var n=[],s=!1;return{push:function(t){n.push(t),s=!1},peek:function(t){return s||e(),void 0===t&&(t=n.length-1),n[t]},pop:function(){return s||e(),n.pop()},size:function(){return n.length},map:function(t){return n.map(t)},debug:function(){return s||e(),n}}}function n(t,e,n,s,i,o,r){var a=this;a.r1=t,a.r2=e,a.g1=n,a.g2=s,a.b1=i,a.b2=o,a.histo=r}function i(){this.vboxes=new e((function(t,e){return s.naturalOrder(t.vbox.count()*t.vbox.volume(),e.vbox.count()*e.vbox.volume())}))}function o(e){var n,s,i,o,r=new Array(1<<3*u);return e.forEach((function(e){s=e[0]>>c,i=e[1]>>c,o=e[2]>>c,n=t(s,i,o),r[n]=(r[n]||0)+1})),r}function r(t,e){var s,i,o,r=1e6,a=0,u=1e6,l=0,h=1e6,p=0;return t.forEach((function(t){s=t[0]>>c,i=t[1]>>c,o=t[2]>>c,r>s?r=s:s>a&&(a=s),u>i?u=i:i>l&&(l=i),h>o?h=o:o>p&&(p=o)})),new n(r,a,u,l,h,p,e)}function a(e,n){if(n.count()){var i=n.r2-n.r1+1,o=n.g2-n.g1+1,r=n.b2-n.b1+1,a=s.max([i,o,r]);if(1==n.count())return[n.copy()];var u,c,l,h,p=0,d=[],m=[];if(a==i)for(u=n.r1;u<=n.r2;u++){for(h=0,c=n.g1;c<=n.g2;c++)for(l=n.b1;l<=n.b2;l++)h+=e[t(u,c,l)]||0;p+=h,d[u]=p}else if(a==o)for(u=n.g1;u<=n.g2;u++){for(h=0,c=n.r1;c<=n.r2;c++)for(l=n.b1;l<=n.b2;l++)h+=e[t(c,u,l)]||0;p+=h,d[u]=p}else for(u=n.b1;u<=n.b2;u++){for(h=0,c=n.r1;c<=n.r2;c++)for(l=n.g1;l<=n.g2;l++)h+=e[t(c,l,u)]||0;p+=h,d[u]=p}return d.forEach((function(t,e){m[e]=p-t})),function(t){var e,s,i,o,r,a=t+"1",c=t+"2",l=0;for(u=n[a];u<=n[c];u++)if(d[u]>p/2){for(i=n.copy(),o=n.copy(),e=u-n[a],r=(s=n[c]-u)>=e?Math.min(n[c]-1,~~(u+s/2)):Math.max(n[a],~~(u-1-e/2));!d[r];)r++;for(l=m[r];!l&&d[r-1];)l=m[--r];return i[c]=r,o[a]=i[c]+1,[i,o]}}(a==i?"r":a==o?"g":"b")}}var u=5,c=8-u;return n.prototype={volume:function(t){var e=this;return(!e._volume||t)&&(e._volume=(e.r2-e.r1+1)*(e.g2-e.g1+1)*(e.b2-e.b1+1)),e._volume},count:function(e){var n=this,s=n.histo;if(!n._count_set||e){var i,o,r,a=0;for(i=n.r1;i<=n.r2;i++)for(o=n.g1;o<=n.g2;o++)for(r=n.b1;r<=n.b2;r++)index=t(i,o,r),a+=s[index]||0;n._count=a,n._count_set=!0}return n._count},copy:function(){var t=this;return new n(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(e){var n=this,s=n.histo;if(!n._avg||e){var i,o,r,a,c=0,l=1<<8-u,h=0,p=0,d=0;for(o=n.r1;o<=n.r2;o++)for(r=n.g1;r<=n.g2;r++)for(a=n.b1;a<=n.b2;a++)c+=i=s[t(o,r,a)]||0,h+=i*(o+.5)*l,p+=i*(r+.5)*l,d+=i*(a+.5)*l;n._avg=c?[~~(h/c),~~(p/c),~~(d/c)]:[~~(l*(n.r1+n.r2+1)/2),~~(l*(n.g1+n.g2+1)/2),~~(l*(n.b1+n.b2+1)/2)]}return n._avg},contains:function(t){var e=this,n=t[0]>>c;return gval=t[1]>>c,bval=t[2]>>c,n>=e.r1&&n<=e.r2&&gval>=e.g1&&gval<=e.g2&&bval>=e.b1&&bval<=e.b2}},i.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map((function(t){return t.color}))},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,n=0;n<e.size();n++)if(e.peek(n).vbox.contains(t))return e.peek(n).color;return this.nearest(t)},nearest:function(t){for(var e,n,s,i=this.vboxes,o=0;o<i.size();o++)(e>(n=Math.sqrt(Math.pow(t[0]-i.peek(o).color[0],2)+Math.pow(t[1]-i.peek(o).color[1],2)+Math.pow(t[2]-i.peek(o).color[2],2)))||void 0===e)&&(e=n,s=i.peek(o).color);return s},forcebw:function(){var t=this.vboxes;t.sort((function(t,e){return s.naturalOrder(s.sum(t.color),s.sum(e.color))}));var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,i=t[n].color;i[0]>251&&i[1]>251&&i[2]>251&&(t[n].color=[255,255,255])}},{quantize:function(t,n){function u(t,e){for(var n,s=1,i=0;1e3>i;)if((n=t.pop()).count()){var o=a(c,n),r=o[0],u=o[1];if(!r)return;if(t.push(r),u&&(t.push(u),s++),s>=e)return;if(i++>1e3)return}else t.push(n),i++}if(!t.length||2>n||n>256)return!1;var c=o(t);c.forEach((function(){}));var l=r(t,c),h=new e((function(t,e){return s.naturalOrder(t.count(),e.count())}));h.push(l),u(h,.75*n);for(var p=new e((function(t,e){return s.naturalOrder(t.count()*t.volume(),e.count()*e.volume())}));h.size();)p.push(h.pop());u(p,n-p.size());for(var d=new i;p.size();)d.push(p.pop());return d}}}();t.exports=n},443:(t,e,n)=>{var s=n(9089),i=n(7672);void 0===i.ColorThief&&(i.ColorThief=s),t.exports=s},4816:(t,e,n)=>{var s=n(3689),i=n(7672);void 0===i.punycode&&(i.punycode=s),t.exports=s},7828:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var s=n(6818),i=n(3195);const o=function(t){return"symbol"==typeof t||(0,i.Z)(t)&&"[object Symbol]"==(0,s.Z)(t)}},3689:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ucs2decode:()=>d,ucs2encode:()=>m,decode:()=>g,encode:()=>b,toASCII:()=>Z,toUnicode:()=>w,default:()=>y});const s=2147483647,i=36,o=/^xn--/,r=/[^\0-\x7E]/,a=/[\x2E\u3002\uFF0E\uFF61]/g,u={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},c=Math.floor,l=String.fromCharCode;function h(t){throw new RangeError(u[t])}function p(t,e){const n=t.split("@");let s="";n.length>1&&(s=n[0]+"@",t=n[1]);const i=function(t,e){const n=[];let s=t.length;for(;s--;)n[s]=e(t[s]);return n}((t=t.replace(a,".")).split("."),e).join(".");return s+i}function d(t){const e=[];let n=0;const s=t.length;for(;n<s;){const i=t.charCodeAt(n++);if(i>=55296&&i<=56319&&n<s){const s=t.charCodeAt(n++);56320==(64512&s)?e.push(((1023&i)<<10)+(1023&s)+65536):(e.push(i),n--)}else e.push(i)}return e}const m=t=>String.fromCodePoint(...t),f=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},v=function(t,e,n){let s=0;for(t=n?c(t/700):t>>1,t+=c(t/e);t>455;s+=i)t=c(t/35);return c(s+36*t/(t+38))},g=function(t){const e=[],n=t.length;let o=0,r=128,a=72,u=t.lastIndexOf("-");u<0&&(u=0);for(let n=0;n<u;++n)t.charCodeAt(n)>=128&&h("not-basic"),e.push(t.charCodeAt(n));for(let p=u>0?u+1:0;p<n;){let u=o;for(let e=1,r=i;;r+=i){p>=n&&h("invalid-input");const u=(l=t.charCodeAt(p++))-48<10?l-22:l-65<26?l-65:l-97<26?l-97:i;(u>=i||u>c((s-o)/e))&&h("overflow"),o+=u*e;const d=r<=a?1:r>=a+26?26:r-a;if(u<d)break;const m=i-d;e>c(s/m)&&h("overflow"),e*=m}const d=e.length+1;a=v(o-u,d,0==u),c(o/d)>s-r&&h("overflow"),r+=c(o/d),o%=d,e.splice(o++,0,r)}var l;return String.fromCodePoint(...e)},b=function(t){const e=[];let n=(t=d(t)).length,o=128,r=0,a=72;for(const n of t)n<128&&e.push(l(n));let u=e.length,p=u;for(u&&e.push("-");p<n;){let n=s;for(const e of t)e>=o&&e<n&&(n=e);const d=p+1;n-o>c((s-r)/d)&&h("overflow"),r+=(n-o)*d,o=n;for(const n of t)if(n<o&&++r>s&&h("overflow"),n==o){let t=r;for(let n=i;;n+=i){const s=n<=a?1:n>=a+26?26:n-a;if(t<s)break;const o=t-s,r=i-s;e.push(l(f(s+o%r,0))),t=c(o/r)}e.push(l(f(t,0))),a=v(r,d,p==u),r=0,++p}++r,++o}return e.join("")},w=function(t){return p(t,(function(t){return o.test(t)?g(t.slice(4).toLowerCase()):t}))},Z=function(t){return p(t,(function(t){return r.test(t)?"xn--"+b(t):t}))},y={version:"2.1.0",ucs2:{decode:d,encode:m},decode:g,encode:b,toASCII:Z,toUnicode:w}}},t=>{t.O(0,[516,661],(()=>(9845,t(t.s=9845))));var e=t.O();flarum.core=e}]);
//# sourceMappingURL=flarum-core.js.map