/*! For license information please see flarum-core.js.LICENSE.txt */
(self.webpackChunk_flarum_core=self.webpackChunk_flarum_core||[]).push([[315],{742:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Extend:()=>i.U,app:()=>at});var i=n(6920),s=(n(4816),n(443),n(7757)),o=n.n(s),r=n(2137),a=n(3349),u=n(1788),c=n(6156),l=n(2122);function h(t,e,n){void 0===e&&(e=null),void 0===n&&(n={});var i=(0,l.Z)({},n);i.state=i.state||{},i.state.key=Date.now(),m.route.set(t,e,i)}window.flreg.add("utils/setRouteWithForcedRefresh",h);var d=function(){function t(t){this.stack=[]}var e=t.prototype;return e.getCurrent=function(){return this.stack[this.stack.length-1]},e.getPrevious=function(){return this.stack[this.stack.length-2]},e.push=function(t,e,n){void 0===n&&(n=m.route.get());var i=this.stack[this.stack.length-2];i&&i.name===t&&this.stack.pop();var s=this.getCurrent();s&&s.name===t?(0,l.Z)(s,{url:n,title:e}):this.stack.push({name:t,url:n,title:e})},e.canGoBack=function(){return this.stack.length>1},e.back=function(){if(!this.canGoBack())return this.home();this.stack.pop(),m.route.set(this.getCurrent().url)},e.backUrl=function(){return this.stack[this.stack.length-2].url},e.home=function(){this.stack.splice(0),h("/")},t}();window.flreg.add("utils/History",d);var p=function(){function t(t){this.pinnedKey="panePinned",this.$element=$(t),this.pinned="true"===localStorage.getItem(this.pinnedKey),this.active=!1,this.showing=!1,this.render()}var e=t.prototype;return e.enable=function(){this.active=!0,this.render()},e.disable=function(){this.active=!1,this.showing=!1,this.render()},e.show=function(){clearTimeout(this.hideTimeout),this.showing=!0,this.render()},e.hide=function(){this.showing=!1,this.render()},e.onmouseleave=function(){this.hideTimeout=setTimeout(this.hide.bind(this),250)},e.togglePinned=function(){this.pinned=!this.pinned,localStorage.setItem(this.pinnedKey,this.pinned?"true":"false"),this.render()},e.render=function(){this.$element.toggleClass("panePinned",this.pinned).toggleClass("hasPane",this.active).toggleClass("paneShowing",this.showing)},t}();window.flreg.add("utils/Pane",p);var f=n(2679),g=n(8931),v=n(4594),b=n(7473),w=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.view=function(){return m("ul",{className:"Header-controls"},(0,b.Z)(this.items().toArray()))},n.items=function(){return new v.Z},e}(g.Z);window.flreg.add("components/HeaderPrimary",w);var y=n(2587),N=n(9908),Z=n(507),x=n(9657),S=n(2558),C=n(5128),P=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.className="SessionDropdown",e.buttonClassName="Button Button--user Button--flat",e.menuClassName="Dropdown-menu--right",e.accessibleToggleLabel=app.translator.trans("core.forum.header.session_dropdown_accessible_label")};var n=e.prototype;return n.view=function(e){return t.prototype.view.call(this,(0,l.Z)({},e,{children:this.items().toArray()}))},n.getButtonContent=function(){var t=app.session.user;return[(0,N.Z)(t)," ",m("span",{className:"Button-label"},(0,Z.Z)(t))]},n.items=function(){var t=new v.Z,e=app.session.user;return t.add("profile",S.Z.component({icon:"fas fa-user",href:app.route.user(e)},app.translator.trans("core.forum.header.profile_button")),100),t.add("settings",S.Z.component({icon:"fas fa-cog",href:app.route("settings")},app.translator.trans("core.forum.header.settings_button")),50),app.forum.attribute("adminUrl")&&t.add("administration",S.Z.component({icon:"fas fa-wrench",href:app.forum.attribute("adminUrl"),target:"_blank"},app.translator.trans("core.forum.header.admin_button")),0),t.add("separator",C.Z.component(),-90),t.add("logOut",y.Z.component({icon:"fas fa-sign-out-alt",onclick:app.session.logout.bind(app.session)},app.translator.trans("core.forum.header.log_out_button")),-100),t},e}(x.Z);window.flreg.add("components/SessionDropdown",P);var k=n(9349),I=n(9100),_=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t),e.initAttrs=function(e){e.className=e.className||"NotificationsDropdown",e.buttonClassName=e.buttonClassName||"Button Button--flat",e.menuClassName=e.menuClassName||"Dropdown-menu--right",e.label=e.label||app.translator.trans("core.forum.notifications.tooltip"),e.icon=e.icon||"fas fa-bell",e.accessibleToggleLabel=e.accessibleToggleLabel||app.translator.trans("core.forum.notifications.toggle_dropdown_accessible_label"),t.initAttrs.call(this,e)};var i=e.prototype;return i.getButton=function(){var e=this.getNewCount(),n=t.prototype.getButton.call(this);return n.attrs.title=this.attrs.label,n.attrs.className+=e?" new":"",n.attrs.onclick=this.onclick.bind(this),n},i.getButtonContent=function(){var t=this.getUnreadCount();return[(0,I.Z)(this.attrs.icon,{className:"Button-icon"}),t?m("span",{className:"NotificationsDropdown-unread"},t):"",m("span",{className:"Button-label"},this.attrs.label)]},i.getMenu=function(){var t=this.NotificationList;return m("div",{className:"Dropdown-menu "+this.attrs.menuClassName,onclick:this.menuClick.bind(this)},this.showing&&t?m(t,{state:this.attrs.state}):"")},i.onclick=function(){var t=this;n.e(77).then(n.bind(n,3490)).then((function(e){t.NotificationList=e.default,m.redraw()})),app.drawer.isOpen()?this.goToRoute():this.attrs.state.load()},i.goToRoute=function(){m.route.set(app.route("notifications"))},i.getUnreadCount=function(){return app.session.user.unreadNotificationCount()},i.getNewCount=function(){return app.session.user.newNotificationCount()},i.menuClick=function(t){(t.shiftKey||t.metaKey||t.ctrlKey||2===t.which)&&t.stopPropagation()},e}(x.Z);window.flreg.add("components/NotificationsDropdown",_);var D=n(8726),T=n(1650),E=n(5731),A=function(){function t(){this.callbacks={},this.whenCallback=function(t){return!0}}var e=t.prototype;return e.onUp=function(t){return this.callbacks[38]=function(e){e.preventDefault(),t(e)},this},e.onDown=function(t){return this.callbacks[40]=function(e){e.preventDefault(),t(e)},this},e.onSelect=function(t){return this.callbacks[9]=this.callbacks[13]=function(e){e.preventDefault(),t(e)},this},e.onCancel=function(t){return this.callbacks[27]=function(e){e.stopPropagation(),e.preventDefault(),t(e)},this},e.onRemove=function(t){return this.callbacks[8]=function(e){0===e.target.selectionStart&&0===e.target.selectionEnd&&(t(e),e.preventDefault())},this},e.when=function(t){return this.whenCallback=t,this},e.bindTo=function(t){t.on("keydown",this.navigate.bind(this))},e.navigate=function(t){if(this.whenCallback(t)){var e=this.callbacks[t.which];e&&e(t)}},t}();window.flreg.add("utils/KeyboardNavigatable",A);var L=n(7089),R=n(8046),H=function(){function t(){this.results={}}var e=t.prototype;return e.search=function(t){var e=this;t=t.toLowerCase(),this.results[t]=[];var n={filter:{q:t},page:{limit:3},include:"mostRelevantPost"};return app.store.find("discussions",n).then((function(n){return e.results[t]=n}))},e.view=function(t){t=t.toLowerCase();var e=this.results[t]||[];return[m("li",{className:"Dropdown-header"},app.translator.trans("core.forum.search.discussions_heading")),m("li",null,S.Z.component({icon:"fas fa-search",href:app.route("index",{q:t})},app.translator.trans("core.forum.search.all_discussions_button",{query:t}))),e.map((function(e){var n=e.mostRelevantPost();return m("li",{className:"DiscussionSearchResult","data-index":"discussions"+e.id()},m(R.Z,{href:app.route.discussion(e,n&&n.number())},m("div",{className:"DiscussionSearchResult-title"},(0,L.Z)(e.title(),t)),n?m("div",{className:"DiscussionSearchResult-excerpt"},(0,L.Z)(n.contentPlain(),t,100)):""))}))]},t}();window.flreg.add("components/DiscussionsSearchSource",H);var M=function(){function t(){this.results={}}var e=t.prototype;return e.search=function(t){var e=this;return app.store.find("users",{filter:{q:t},page:{limit:5}}).then((function(n){e.results[t]=n,m.redraw()}))},e.view=function(t){t=t.toLowerCase();var e=(this.results[t]||[]).concat(app.store.all("users").filter((function(e){return[e.username(),e.displayName()].some((function(e){return e.toLowerCase().substr(0,t.length)===t}))}))).filter((function(t,e,n){return n.lastIndexOf(t)===e})).sort((function(t,e){return t.displayName().localeCompare(e.displayName())}));return e.length?[m("li",{className:"Dropdown-header"},app.translator.trans("core.forum.search.users_heading")),e.map((function(e){var n=(0,Z.Z)(e),i=[(0,L.Z)(n.text,t)];return m("li",{className:"UserSearchResult","data-index":"users"+e.id()},m(R.Z,{href:app.route.user(e)},(0,N.Z)(e),(0,l.Z)({},n,{text:void 0,children:i})))}))]:""},t}();window.flreg.add("components/UsersSearchResults",M);var B=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.state=this.attrs.state,this.hasFocus=!1,this.sources=null,this.loadingSources=0,this.index=0},n.view=function(){var t=this,e=this.state.getInitialSearch();if(this.sources||(this.sources=this.sourceItems().toArray()),!this.sources.length)return m("div",null);var n=(0,E.Z)(app.translator.trans("core.forum.header.search_placeholder"));return m("div",{role:"search",className:"Search "+(0,T.Z)({open:this.state.getValue()&&this.hasFocus,focused:this.hasFocus,active:!!e,loading:!!this.loadingSources})},m("div",{className:"Search-input"},m("input",{"aria-label":n,className:"FormControl",type:"search",placeholder:n,value:this.state.getValue(),oninput:function(e){return t.state.setValue(e.target.value)},onfocus:function(){return t.hasFocus=!0},onblur:function(){return t.hasFocus=!1}}),this.loadingSources?D.Z.component({size:"tiny",className:"Button Button--icon Button--link"}):e?m("button",{className:"Search-clear Button Button--icon Button--link",onclick:this.clear.bind(this)},(0,I.Z)("fas fa-times-circle")):""),m("ul",{className:"Dropdown-menu Search-results"},this.state.getValue()&&this.hasFocus?this.sources.map((function(e){return e.view(t.state.getValue())})):""))},n.onupdate=function(){if(this.setIndex(this.getCurrentNumericIndex()),this.sources.length){var t=window.innerHeight-this.element.querySelector(".Search-input>.FormControl").getBoundingClientRect().bottom-14;this.element.querySelector(".Search-results").style["max-height"]=t+"px"}},n.oncreate=function(n){var i=this;t.prototype.oncreate.call(this,n);var s=this,o=this.state;this.setIndex(this.getCurrentNumericIndex()),this.$(".Search-results").on("mousedown",(function(t){return t.preventDefault()})).on("click",(function(){return i.$("input").blur()})).on("mouseenter","> li:not(.Dropdown-header)",(function(){s.setIndex(s.selectableItems().index(this))}));var r=this.$("input");this.navigator=new A,this.navigator.onUp((function(){return i.setIndex(i.getCurrentNumericIndex()-1,!0)})).onDown((function(){return i.setIndex(i.getCurrentNumericIndex()+1,!0)})).onSelect(this.selectResult.bind(this)).onCancel(this.clear.bind(this)).bindTo(r),r.on("input focus",(function(){var t=this.value.toLowerCase();t&&(clearTimeout(s.searchTimeout),s.searchTimeout=setTimeout((function(){o.isCached(t)||(t.length>=e.MIN_SEARCH_LEN&&s.sources.map((function(e){e.search&&(s.loadingSources++,e.search(t).then((function(){s.loadingSources=Math.max(0,s.loadingSources-1),m.redraw()})))})),o.cache(t),m.redraw())}),250))})).on("focus",(function(){$(this).one("mouseup",(function(t){return t.preventDefault()})).select()}))},n.selectResult=function(){clearTimeout(this.searchTimeout),this.loadingSources=0,this.state.getValue()?m.route.set(this.getItem(this.index).find("a").attr("href")):this.clear(),this.$("input").blur()},n.clear=function(){this.state.clear()},n.sourceItems=function(){var t=new v.Z;return app.forum.attribute("canViewDiscussions")&&t.add("discussions",new H),app.forum.attribute("canViewUserList")&&t.add("users",new M),t},n.selectableItems=function(){return this.$(".Search-results > li:not(.Dropdown-header)")},n.getCurrentNumericIndex=function(){return this.selectableItems().index(this.getItem(this.index))},n.getItem=function(t){var e=this.selectableItems(),n=e.filter('[data-index="'+t+'"]');return n.length||(n=e.eq(t)),n},n.setIndex=function(t,e){var n=this.selectableItems(),i=n.parent(),s=t;t<0?s=n.length-1:t>=n.length&&(s=0);var o=n.removeClass("active").eq(s).addClass("active");if(this.index=o.attr("data-index")||s,e){var r,a=i.scrollTop(),u=i.offset().top,c=u+i.outerHeight(),l=o.offset().top,h=l+o.outerHeight();l<u?r=a-u+l-parseInt(i.css("padding-top"),10):h>c&&(r=a-c+h+parseInt(i.css("padding-bottom"),10)),void 0!==r&&i.stop(!0).animate({scrollTop:r},100)}},e}(g.Z);(0,c.Z)(B,"MIN_SEARCH_LEN",3),window.flreg.add("components/Search",B);var z=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var i=e.prototype;return i.view=function(){return m("ul",{className:"Header-controls"},(0,b.Z)(this.items().toArray()))},i.items=function(){var t=new v.Z,e=function(){return n.e(460).then(n.bind(n,1498))},i=function(){return n.e(395).then(n.bind(n,3235))};if(t.add("search",B.component({state:app.search}),30),app.forum.attribute("showLanguageSelector")&&Object.keys(app.data.locales).length>1){var s=[],o=function(t){s.push(y.Z.component({active:app.data.locale===t,icon:app.data.locale!==t||"fas fa-check",onclick:function(){app.session.user?app.session.user.savePreferences({locale:t}).then((function(){return window.location.reload()})):(document.cookie="locale="+t+"; path=/; expires=Tue, 19 Jan 2038 03:14:07 GMT",window.location.reload())}},app.data.locales[t]))};for(var r in app.data.locales)o(r);t.add("locale",k.Z.component({buttonClassName:"Button Button--link",accessibleToggleLabel:app.translator.trans("core.forum.header.locale_dropdown_accessible_label")},s),20)}return app.session.user?(t.add("notifications",_.component({state:app.notifications}),10),t.add("session",P.component(),0)):(app.forum.attribute("allowSignUp")&&t.add("signUp",y.Z.component({className:"Button Button--link",onclick:function(){return app.modal.show(i)}},app.translator.trans("core.forum.header.sign_up_link")),10),t.add("logIn",y.Z.component({className:"Button Button--link",onclick:function(){return app.modal.show(e)}},app.translator.trans("core.forum.header.log_in_link")),0)),t},e}(g.Z);window.flreg.add("components/HeaderSecondary",z);var F=function(t){function e(){return t.apply(this,arguments)||this}return(0,u.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.className=e.className||"Button Button--icon Button--link"},e}(y.Z);window.flreg.add("components/ComposerButton",F);var U=n(3482),O=n(1024),q=n(4181),V=function(){function t(){this.position=t.Position.HIDDEN,this.height=null,this.body={attrs:{}},this.editor=null,this.clear()}var e=t.prototype;return e.load=function(){var t=(0,r.Z)(o().mark((function t(e,n){var i,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof g.Z){t.next=5;break}return t.next=3,e();case 3:i=t.sent,e=i.default;case 5:if(s={componentClass:e,attrs:n},!this.preventExit()){t.next=8;break}return t.abrupt("return");case 8:this.isVisible()&&(this.clear(),m.redraw.sync()),this.body=s;case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),e.clear=function(){this.position=t.Position.HIDDEN,this.body={attrs:{}},this.onExit=null,this.fields={content:(0,O.Z)("")},this.editor&&this.editor.destroy(),this.editor=null},e.show=function(){this.position!==t.Position.NORMAL&&this.position!==t.Position.FULLSCREEN&&(this.position=t.Position.NORMAL,m.redraw.sync())},e.hide=function(){this.clear(),m.redraw()},e.close=function(){this.preventExit()||this.hide()},e.minimize=function(){this.isVisible()&&(this.position=t.Position.MINIMIZED,m.redraw())},e.fullScreen=function(){this.isVisible()&&(this.position=t.Position.FULLSCREEN,m.redraw())},e.exitFullScreen=function(){this.position===t.Position.FULLSCREEN&&(this.position=t.Position.NORMAL,m.redraw())},e.bodyMatches=function(t,e){var n=this;return void 0===e&&(e={}),!!(0,U.Z)(this.body.componentClass,t)&&Object.keys(e).every((function(t){return n.body.attrs[t]===e[t]}))},e.isVisible=function(){return this.position!==t.Position.HIDDEN},e.isFullScreen=function(){return this.position===t.Position.FULLSCREEN||"phone"===app.screen()},e.composingReplyTo=function(t){return this.isVisible()&&this.bodyMatches(q.default,{discussion:t})},e.preventExit=function(){if(this.isVisible()&&this.onExit)return this.onExit.callback()?!confirm(this.onExit.message):void 0},e.preventClosingWhen=function(t,e){this.onExit={callback:t,message:e}},e.minimumHeight=function(){return 200},e.maximumHeight=function(){return $(window).height()-$("#header").outerHeight()},e.computedHeight=function(){return this.position===t.Position.MINIMIZED?"":this.position===t.Position.FULLSCREEN?$(window).height():Math.max(this.minimumHeight(),Math.min(this.height,this.maximumHeight()))},t}();V.Position={HIDDEN:"hidden",NORMAL:"normal",MINIMIZED:"minimized",FULLSCREEN:"fullScreen"};const j=V;window.flreg.add("states/ComposerState",V);var K=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.state=this.attrs.state,this.active=!1,this.prevPosition=this.state.position},n.view=function(){var t=this.state.body,e={normal:this.state.position===j.Position.NORMAL,minimized:this.state.position===j.Position.MINIMIZED,fullScreen:this.state.position===j.Position.FULLSCREEN,active:this.active,visible:this.state.isVisible()},n=this.state.position===j.Position.MINIMIZED?this.state.show.bind(this.state):void 0;return m("div",{className:"Composer "+(0,T.Z)(e)},m("div",{className:"Composer-handle",oncreate:this.configHandle.bind(this)}),m("ul",{className:"Composer-controls"},(0,b.Z)(this.controlItems().toArray())),m("div",{className:"Composer-content",onclick:n},t.componentClass?t.componentClass.component((0,l.Z)({},t.attrs,{composer:this.state,disabled:e.minimized})):""))},n.onupdate=function(){this.state.position===this.prevPosition?this.updateHeight():(this.animatePositionChange(),this.prevPosition=this.state.position)},n.oncreate=function(e){var n=this;t.prototype.oncreate.call(this,e),this.initializeHeight(),this.$().hide().css("bottom",-this.state.computedHeight()),this.$().on("focus blur",":input,.TextEditor-editorContainer",(function(t){n.active="focusin"===t.type,m.redraw()})),this.$().on("keydown",":input,.TextEditor-editorContainer","esc",(function(){return n.state.close()})),this.handlers={},$(window).on("resize",this.handlers.onresize=this.updateHeight.bind(this)).resize(),$(document).on("mousemove",this.handlers.onmousemove=this.onmousemove.bind(this)).on("mouseup",this.handlers.onmouseup=this.onmouseup.bind(this))},n.onremove=function(){$(window).off("resize",this.handlers.onresize),$(document).off("mousemove",this.handlers.onmousemove).off("mouseup",this.handlers.onmouseup)},n.configHandle=function(t){var e=this;$(t.dom).css("cursor","row-resize").bind("dragstart mousedown",(function(t){return t.preventDefault()})).mousedown((function(t){e.mouseStart=t.clientY,e.heightStart=e.$().height(),e.handle=$(this),$("body").css("cursor","row-resize")}))},n.onmousemove=function(t){if(this.handle){var e=this.mouseStart-t.clientY;this.changeHeight(this.heightStart+e);var n=$(window).scrollTop(),i=n>0&&n+$(window).height()>=$(document).height();this.updateBodyPadding(i)}},n.onmouseup=function(){this.handle&&(this.handle=null,$("body").css("cursor",""))},n.focus=function(){this.$(".Composer-content :input:enabled:visible, .TextEditor-editor").first().focus()},n.updateHeight=function(){var t=this.state.computedHeight(),e=this.$(".Composer-flexible");if(this.$().height(t),e.length){var n=e.offset().top-this.$().offset().top,i=parseInt(e.css("padding-bottom"),10),s=this.$(".Composer-footer").outerHeight(!0);e.height(this.$().outerHeight()-n-i-s)}},n.updateBodyPadding=function(){var t=this.state.position!==j.Position.HIDDEN&&this.state.position!==j.Position.MINIMIZED&&"phone"!==app.screen()?this.state.computedHeight()-parseInt($("#app").css("padding-bottom"),10):0;$("#content").css({paddingBottom:t})},n.animatePositionChange=function(){if(this.prevPosition!==j.Position.FULLSCREEN||this.state.position!==j.Position.NORMAL)switch(this.state.position){case j.Position.HIDDEN:return this.hide();case j.Position.MINIMIZED:return this.minimize();case j.Position.FULLSCREEN:return this.focus();case j.Position.NORMAL:return this.show()}else this.focus()},n.animateHeightChange=function(){var t=this.$().stop(!0),e=t.outerHeight(),n=$(window).scrollTop();t.show(),this.updateHeight();var i=t.outerHeight();this.prevPosition===j.Position.HIDDEN?t.css({bottom:-i,height:i}):t.css({height:e});var s=t.animate({bottom:0,height:i},"fast").promise();return this.updateBodyPadding(),$(window).scrollTop(n),s},n.showBackdrop=function(){this.$backdrop=$("<div/>").addClass("composer-backdrop").appendTo("body")},n.hideBackdrop=function(){this.$backdrop&&this.$backdrop.remove()},n.show=function(){var t=this;if(this.animateHeightChange().then((function(){return t.focus()})),"phone"===app.screen()){var e=document.documentElement,n=Math.min(e.scrollTop,e.scrollHeight-e.clientHeight);this.$().css("top",$(".App").is(".mobile-safari")?n:0),this.showBackdrop()}},n.hide=function(){var t=this,e=this.$();e.stop(!0).animate({bottom:-e.height()},"fast",(function(){e.hide(),t.hideBackdrop(),t.updateBodyPadding()}))},n.minimize=function(){this.animateHeightChange(),this.$().css("top","auto"),this.hideBackdrop()},n.controlItems=function(){var t=new v.Z;return this.state.position===j.Position.FULLSCREEN?t.add("exitFullScreen",F.component({icon:"fas fa-compress",title:app.translator.trans("core.forum.composer.exit_full_screen_tooltip"),onclick:this.state.exitFullScreen.bind(this.state)})):(this.state.position!==j.Position.MINIMIZED&&(t.add("minimize",F.component({icon:"fas fa-minus minimize",title:app.translator.trans("core.forum.composer.minimize_tooltip"),onclick:this.state.minimize.bind(this.state),itemClassName:"App-backControl"})),t.add("fullScreen",F.component({icon:"fas fa-expand",title:app.translator.trans("core.forum.composer.full_screen_tooltip"),onclick:this.state.fullScreen.bind(this.state)}))),t.add("close",F.component({icon:"fas fa-times",title:app.translator.trans("core.forum.composer.close_tooltip"),onclick:this.state.close.bind(this.state)}))),t},n.initializeHeight=function(){this.state.height=localStorage.getItem("composerHeight"),this.state.height||(this.state.height=this.defaultHeight())},n.defaultHeight=function(){return this.$().height()},n.changeHeight=function(t){this.state.height=t,this.updateHeight(),localStorage.setItem("composerHeight",this.state.height)},e}(g.Z);window.flreg.add("components/Composer",K);var Y=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var n=e.prototype;return n.canonicalizeDiscussionSlug=function(t){if(t)return t.split("-")[0]},n.makeKey=function(){var t=(0,l.Z)({},m.route.param());return"near"in t&&delete t.near,t.id=this.canonicalizeDiscussionSlug(t.id),this.routeName.replace(".near","")+JSON.stringify(t)},n.onmatch=function(n,i,s){return app.current.matches(f.Z)&&this.canonicalizeDiscussionSlug(n.id)===this.canonicalizeDiscussionSlug(m.route.param("id"))&&(e.scrollToPostNumber=n.near||"1"),t.prototype.onmatch.call(this,n,i,s)},n.render=function(n){if(null!==e.scrollToPostNumber){var i=e.scrollToPostNumber;setTimeout((function(){return app.current.get("stream").goToNumber(i)})),e.scrollToPostNumber=null}return t.prototype.render.call(this,n)},e}(n(2231).Z);(0,c.Z)(Y,"scrollToPostNumber",null),window.flreg.add("resolvers/DiscussionPageResolver",Y);var G=function(t){function e(){return t.apply(this,arguments)||this}(0,u.Z)(e,t);var i=e.prototype;return i.oninit=function(e){var i=this;t.prototype.oninit.call(this,e),app.history.push("notifications"),n.e(77).then(n.bind(n,3490)).then((function(t){i.NotificationList=t.default,m.redraw()})),app.notifications.load(),this.bodyClass="App--notifications"},i.view=function(){var t=this.NotificationList;return m("div",{className:"NotificationsPage"},t?m(t,{state:app.notifications}):"")},e}(n(453).Z);window.flreg.add("components/NotificationsPage",G);var W=n(7607);function X(t){var e=t.session.user;if(e&&!e.isEmailConfirmed()){var n=function(n){function i(){return n.apply(this,arguments)||this}(0,u.Z)(i,n);var s=i.prototype;return s.oninit=function(t){n.prototype.oninit.call(this,t),this.loading=!1,this.sent=!1},s.view=function(){return m(y.Z,{class:"Button Button--link",onclick:this.onclick.bind(this),loading:this.loading,disabled:this.sent},this.sent?[(0,I.Z)("fas fa-check")," ",t.translator.trans("core.forum.user_email_confirmation.sent_message")]:t.translator.trans("core.forum.user_email_confirmation.resend_button"))},s.onclick=function(){var n=this;this.loading=!0,m.redraw(),t.request({method:"POST",url:t.forum.attribute("apiUrl")+"/users/"+e.id()+"/send-confirmation"}).then((function(){n.loading=!1,n.sent=!0,m.redraw()})).catch((function(){n.loading=!1,m.redraw()}))},i}(g.Z),i=function(t){function e(){return t.apply(this,arguments)||this}return(0,u.Z)(e,t),e.prototype.view=function(e){var n=t.prototype.view.call(this,e);return(0,l.Z)({},n,{children:[m("div",{className:"container"},n.children)]})},e}(W.Z);m.mount($("<div/>").insertBefore("#content")[0],{view:function(){return m(i,{dismissible:!1,controls:[m(n,null)]},t.translator.trans("core.forum.user_email_confirmation.alert_message",{email:m("strong",null,e.email())}))}})}}window.flreg.add("utils/alertEmailConfirmation",X);var J=n(188),Q=n(4807),tt=function(){function t(t){this.app=t,this.notificationPages=[],this.loading=!1,this.moreResults=!1}var e=t.prototype;return e.clear=function(){this.notificationPages=[]},e.getNotificationPages=function(){return this.notificationPages},e.isLoading=function(){return this.loading},e.hasMoreResults=function(){return this.moreResults},e.load=function(){this.app.session.user.newNotificationCount()&&(this.notificationPages=[]),this.notificationPages.length>0||(this.app.session.user.pushAttributes({newNotificationCount:0}),this.loadMore())},e.loadMore=function(){var t=this;this.loading=!0,m.redraw();var e=this.notificationPages.length>0?{page:{offset:10*this.notificationPages.length}}:null;return this.app.store.find("notifications",e).then(this.parseResults.bind(this)).catch((function(){})).then((function(){t.loading=!1,m.redraw()}))},e.parseResults=function(t){return t.length&&this.notificationPages.push(t),this.moreResults=!!t.payload.links.next,t},e.markAllAsRead=function(){0!==this.notificationPages.length&&(this.app.session.user.pushAttributes({unreadNotificationCount:0}),this.notificationPages.forEach((function(t){t.forEach((function(t){return t.pushAttributes({isRead:!0})}))})),this.app.request({url:this.app.forum.attribute("apiUrl")+"/notifications/read",method:"POST"}))},t}();window.flreg.add("states/NotificationListState",tt);var et=function(){function t(t){void 0===t&&(t=[]),this.cachedSearches=t}var e=t.prototype;return e.getValue=function(){return this.value},e.setValue=function(t){this.value=t},e.clear=function(){this.setValue("")},e.cache=function(t){this.cachedSearches.push(t)},e.isCached=function(t){return-1!==this.cachedSearches.indexOf(t)},t}();window.flreg.add("states/SearchState",et);var nt=function(t){function e(e){return void 0===e&&(e=[]),t.call(this,e)||this}(0,u.Z)(e,t);var n=e.prototype;return n.getValue=function(){return void 0===this.value&&(this.value=this.getInitialSearch()||""),t.prototype.getValue.call(this)},n.clear=function(){t.prototype.clear.call(this),this.getInitialSearch()?this.clearInitialSearch():m.redraw()},n.stickyParams=function(){return{sort:m.route.param("sort"),q:m.route.param("q")}},n.params=function(){var t=this.stickyParams();return t.filter=m.route.param("filter"),t},n.changeSort=function(t){var e=this.params();t===Object.keys(app.discussions.sortMap())[0]?delete e.sort:e.sort=t,h(app.route(app.current.get("routeName"),e))},n.getInitialSearch=function(){return app.current.type&&app.current.type.providesInitialSearch&&this.params().q},n.clearInitialSearch=function(){var t=this.params();delete t.q,h(app.route(app.current.get("routeName"),t))},e}(et);window.flreg.add("states/GlobalSearchState",nt);var it=n(2060);function st(){return"ontouchstart"in window&&navigator.vendor&&navigator.vendor.includes("Apple")&&navigator.userAgent&&!navigator.userAgent.includes("CriOS")&&!navigator.userAgent.includes("FxiOS")}window.flreg.add("utils/isSafariMobile",st);var ot=function(t){function e(){var e;return e=t.call(this)||this,(0,c.Z)((0,a.Z)(e),"pane",null),(0,c.Z)((0,a.Z)(e),"drawer",null),(0,c.Z)((0,a.Z)(e),"history",new d),(0,c.Z)((0,a.Z)(e),"notifications",new tt((0,a.Z)(e))),(0,c.Z)((0,a.Z)(e),"search",new nt),(0,c.Z)((0,a.Z)(e),"composer",new j),function(t){var e=function(){return Promise.all([n.e(997),n.e(28)]).then(n.bind(n,2352))};t.routes={index:{path:"/all",component:function(){return n.e(847).then(n.bind(n,5368))}},discussion:{path:"/d/:id",component:f.Z,resolverClass:Y},"discussion.near":{path:"/d/:id/:near",component:f.Z,resolverClass:Y},user:{path:"/u/:username",component:e},"user.posts":{path:"/u/:username",component:e},"user.discussions":{path:"/u/:username/discussions",component:function(){return n.e(799).then(n.bind(n,5813))}},settings:{path:"/settings",component:function(){return Promise.all([n.e(997),n.e(826)]).then(n.bind(n,4785))}},notifications:{path:"/notifications",component:G}},t.route.discussion=function(e,n){return t.route(n&&1!==n?"discussion.near":"discussion",{id:e.slug(),near:n&&1!==n?n:void 0})},t.route.post=function(e){return t.route.discussion(e.discussion(),e.number())},t.route.user=function(e){return t.route("user",{username:e.slug()})}}((0,a.Z)(e)),e.discussions=new it.Z({},(0,a.Z)(e)),e}(0,u.Z)(e,t);var i=e.prototype;return i.mount=function(){var e=this,n=this.forum.attribute("defaultRoute"),i="index";for(var s in this.routes)this.routes[s].path===n&&(i=s);this.routes[i].path="/",this.history.push(i,this.translator.trans("core.forum.header.back_to_index_tooltip"),"/"),this.pane=new p(document.getElementById("app")),m.route.prefix="",t.prototype.mount.call(this,this.forum.attribute("basePath")),m.mount(document.getElementById("app-navigation"),{view:function(){return Q.Z.component({className:"App-backControl",drawer:!0})}}),m.mount(document.getElementById("header-navigation"),Q.Z),m.mount(document.getElementById("header-primary"),w),m.mount(document.getElementById("header-secondary"),z),m.mount(document.getElementById("composer"),{view:function(){return K.component({state:e.composer})}}),X(this),$("#home-link").click((function(t){t.ctrlKey||t.metaKey||2===t.which||(t.preventDefault(),app.history.home(),app.session.user&&(app.store.find("users",app.session.user.id()),m.redraw()))})),st()&&$((function(){$(".App").addClass("mobile-safari")}))},i.viewingDiscussion=function(){var t=(0,r.Z)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.current.matches(f.Z.default,{discussion:e}));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.authenticationComplete=function(t){t.loggedIn?window.location.reload():this.modal.show((function(){return n.e(395).then(n.bind(n,3235))}),t)},e}(J.Z);window.flreg.add("forum/ForumApplication",ot);var rt=new ot;window.app=rt;const at=rt},4612:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(1788),s=function(t){function e(){return t.apply(this,arguments)||this}return(0,i.Z)(e,t),e.prototype.view=function(){return m("div",{className:"Placeholder"},m("p",null,this.attrs.text))},e}(n(8931).Z);window.flreg.add("components/Placeholder",s)},2511:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var i=n(2122);function s(t,e,n){var s=t[e];t[e]=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var o=s?s.apply(this,e):void 0;return n.apply(this,[o].concat(e)),o},(0,i.Z)(t[e],s)}window.flreg.add("common/extend",s),window.flreg.add("common/override",(function(t,e,n){var s=t[e];t[e]=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.apply(this,[s.bind(this)].concat(e))},(0,i.Z)(t[e],s)}))},7089:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var i=n(1666);function s(t,e,n){if(!e&&!n)return t;var s=e instanceof RegExp?e:new RegExp(e,"gi"),o=t,r=0;return n&&(e&&(r=Math.max(0,t.search(s)-n/2)),o=(0,i.$G)(o,n,r)),o=$("<div/>").text(o).html(),e&&(o=o.replace(s,"<mark>$&</mark>")),m.trust(o)}window.flreg.add("helpers/highlight",s)},6961:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(7484),s=n.n(i),o=n(9052);function r(t){var e=s()(t),n=e.format(),i=e.format("LLLL"),r=(0,o.Z)(t);return m("time",{pubdate:!0,datetime:n,title:i,"data-humantime":!0},r)}window.flreg.add("helpers/humanTime",r)},135:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var i=function(){function t(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.callbacks=e,this.data={},this.needsRebuild()}var e=t.prototype;return e.needsRebuild=function(){var t=this,e=!1;return this.callbacks.forEach((function(n,i){var s=n();s!==t.data[i]&&(t.data[i]=s,e=!0)})),e},e.check=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.callbacks=this.callbacks.concat(e),this.needsRebuild()},e.invalidate=function(){this.data={}},t}();window.flreg.add("utils/SubtreeRetainer",i)},1666:(t,e,n)=>{"use strict";function i(t,e,n){return void 0===n&&(n=0),(n>0?"...":"")+t.substring(n,n+e)+(t.length>n+e?"...":"")}function s(t){var e=t.replace(/(<\/p>|<br>)/g,"$1 &nbsp;").replace(/<img\b[^>]*>/gi," "),n=$("<div/>").html(e);return n.find(s.removeSelectors.join(",")).remove(),n.text().replace(/\s+/g," ").trim()}function o(t){return t.substr(0,1).toUpperCase()+t.substr(1)}n.d(e,{$G:()=>i,AH:()=>s,Ps:()=>o}),s.removeSelectors=["blockquote","script"],window.flreg.add("utils/truncate",i),window.flreg.add("utils/slug",(function(t){return t.toLowerCase().replace(/[^a-z0-9]/gi,"-").replace(/-+/g,"-").replace(/-$|^-/g,"")})),window.flreg.add("utils/getPlainContent",s),window.flreg.add("utils/ucfirst",o)},4810:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var i=n(1788),s=n(8931),o=n(8726),r=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.handler=function(){return this.attrs.when()||void 0},n.oncreate=function(e){t.prototype.oncreate.call(this,e),this.boundHandler=this.handler.bind(this),$(window).on("beforeunload",this.boundHandler)},n.onremove=function(){$(window).off("beforeunload",this.boundHandler)},n.view=function(t){return t.children[0]},e}(s.Z);window.flreg.add("components/ConfirmDocumentUnload",r);var a=n(9908),u=n(7473),c=n(4594),l=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var s=e.prototype;return s.oninit=function(e){var i=this;t.prototype.oninit.call(this,e),this.composer=this.attrs.composer,this.loading=!0,n.e(247).then(n.bind(n,7664)).then((function(t){i.TextEditor=t.default,i.loading=!1,m.redraw()})),this.attrs.confirmExit&&this.composer.preventClosingWhen((function(){return i.hasChanges()}),this.attrs.confirmExit),this.composer.fields.content(this.attrs.originalContent||"")},s.view=function(){var t=this.TextEditor;return m(r,{when:this.hasChanges.bind(this)},m("div",{className:"ComposerBody "+(this.attrs.className||"")},(0,a.Z)(this.attrs.user,{className:"ComposerBody-avatar"}),m("div",{className:"ComposerBody-content"},m("ul",{className:"ComposerBody-header"},(0,u.Z)(this.headerItems().toArray())),m("div",{className:"ComposerBody-editor"},t?t.component({submitLabel:this.attrs.submitLabel,placeholder:this.attrs.placeholder,disabled:this.loading||this.attrs.disabled,composer:this.composer,preview:this.jumpToPreview&&this.jumpToPreview.bind(this),onchange:this.composer.fields.content,onsubmit:this.onsubmit.bind(this),value:this.composer.fields.content()}):"")),o.Z.component({className:"ComposerBody-loading"+(this.loading?" active":"")})))},s.hasChanges=function(){var t=this.composer.fields.content();return t&&t!==this.attrs.originalContent},s.headerItems=function(){return new c.Z},s.onsubmit=function(){},s.loaded=function(){this.loading=!1,m.redraw()},e}(s.Z);window.flreg.add("components/ComposerBody",l)},486:(t,e,n)=>{"use strict";n.d(e,{Z:()=>H});var i=n(1788),s=n(8931),o=n(8046),r=n(9908),a=n(7473),u=n(7089),c=n(9100),l=n(9052),h=n(4594);function d(t){return t>=1e6?Math.floor(t/1e6)+app.translator.trans("core.lib.number_suffix.mega_text"):t>=1e3?(t/1e3).toFixed(1)+app.translator.trans("core.lib.number_suffix.kilo_text"):t.toString()}window.flreg.add("utils/abbreviateNumber",d);var p=n(9657),f=n(6961),g=function(t){function e(){return t.apply(this,arguments)||this}return(0,i.Z)(e,t),e.prototype.view=function(){var t=this.attrs.discussion,e=this.attrs.lastPost&&t.replyCount(),n=t[e?"lastPostedUser":"user"](),i=t[e?"lastPostedAt":"createdAt"]();return m("span",null,e?(0,c.Z)("fas fa-reply"):""," ",app.translator.trans("core.forum.discussion_list."+(e?"replied":"started")+"_text",{user:n,ago:(0,f.Z)(i)}))},e}(s.Z);window.flreg.add("components/TerminalPost",g);var v=n(135),b=n(1658);function w(t){var e,n,i,s,o=$(t),r=!1,a=!1,u=0,c=function(t,e){void 0===e&&(e={}),e.duration=e.duration||"fast",e.step=function(t){$(this).css("transform","translate("+t+"px, 0)")},o.find(".Slidable-content").animate({"background-position-x":t},e)},l=function(){c(0,{complete:function(){o.removeClass("sliding"),e.hide(),n.hide(),a=!1}})};return o.find(".Slidable-content").on("touchstart",(function(t){e=o.find(".Slidable-underneath--left:not(.disabled)"),n=o.find(".Slidable-underneath--right:not(.disabled)"),i=t.originalEvent.targetTouches[0].clientX,s=t.originalEvent.targetTouches[0].clientY,r=!0,u=0})).on("touchmove",(function(t){var c=t.originalEvent.targetTouches[0].clientX,l=t.originalEvent.targetTouches[0].clientY;if(r&&Math.abs(c-i)>Math.abs(l-s)&&(a=!0),r=!1,a){u=c-i;var h=function(t,e){if(t.length){var n="left"===e?u>0:u<0;n&&t.hasClass("Slidable-underneath--elastic")&&(u-=.5*u),t.toggle(n);var i=Math.max(0,Math.min(1,(Math.abs(u)-25)/50));t.find(".icon").css("transform","scale("+i+")")}else u=Math["left"===e?"min":"max"](0,u)};h(e,"left"),h(n,"right"),$(this).css("transform","translate("+u+"px, 0)"),$(this).css("background-position-x",u+"px"),o.toggleClass("sliding",!!u),t.preventDefault()}})).on("touchend",(function(){var t=function(t){t.click(),t.hasClass("Slidable-underneath--elastic")?l():c((u>0?1:-1)*o.width())};n.length&&u<-50?t(n):e.length&&u>50?t(e):l(),r=!1,a=!1})),{reset:l}}window.flreg.add("utils/slidable",w);var y=n(5731),N=n(1650),Z=n(2679),x=n(5876);var S=n(9350),C=n(7828),P=x.Z?x.Z.prototype:void 0,k=P?P.toString:void 0;const I=function t(e){if("string"==typeof e)return e;if((0,S.Z)(e))return function(t,e){for(var n=-1,i=null==t?0:t.length,s=Array(i);++n<i;)s[n]=e(t[n],n,t);return s}(e,t)+"";if((0,C.Z)(e))return k?k.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n};var _=/[\\^$.*+?()[\]{}|]/g,D=RegExp(_.source);const T=function(t){return(t=null==(e=t)?"":I(e))&&D.test(t)?t.replace(_,"\\$&"):t;var e};var E=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.oninit=function(e){var n=this;t.prototype.oninit.call(this,e),this.subtree=new v.Z((function(){return n.attrs.discussion.freshness}),(function(){var t=app.session.user&&app.session.user.markedAllAsReadAt();return t&&t.getTime()}),(function(){return n.active()}))},n.elementAttrs=function(){return{className:(0,N.Z)(["DiscussionListItem",this.active()?"active":"",this.attrs.discussion.isHidden()?"DiscussionListItem--hidden":"","ontouchstart"in window?"Slidable":""])}},n.view=function(){var t=this.attrs.discussion,e=t.user(),n=t.isUnread(),i=t.isRead(),s=!this.showRepliesCount()&&n,h=0,f=(new b.Z).controls(t,this).toArray(),g=this.elementAttrs();if(this.attrs.params.q){var v=t.mostRelevantPost();v&&(h=v.number());var w=T(this.attrs.params.q);this.highlightRegExp=new RegExp(w+"|"+w.trim().replace(/\s+/g,"|"),"gi")}else h=Math.min(t.lastPostNumber(),(t.lastReadPostNumber()||0)+1);return m("div",g,f.length?p.Z.component({icon:"fas fa-ellipsis-v",className:"DiscussionListItem-controls",buttonClassName:"Button Button--icon Button--flat Slidable-underneath Slidable-underneath--right",accessibleToggleLabel:app.translator.trans("core.forum.discussion_controls.toggle_dropdown_accessible_label")},f):"",m("span",{className:"Slidable-underneath Slidable-underneath--left Slidable-underneath--elastic"+(n?"":" disabled"),onclick:this.markAsRead.bind(this)},(0,c.Z)("fas fa-check")),m("div",{className:"DiscussionListItem-content Slidable-content"+(n?" unread":"")+(i?" read":"")},m(o.Z,{href:e?app.route.user(e):"#",className:"DiscussionListItem-author",title:(0,y.Z)(app.translator.trans("core.forum.discussion_list.started_text",{user:e,ago:(0,l.Z)(t.createdAt())})),oncreate:function(t){$(t.dom).tooltip({placement:"right"})}},(0,r.Z)(e,{title:""})),m("ul",{className:"DiscussionListItem-badges badges"},(0,a.Z)(t.badges().toArray())),m(o.Z,{href:app.route.discussion(t,h),className:"DiscussionListItem-main"},m("h3",{className:"DiscussionListItem-title"},(0,u.Z)(t.title(),this.highlightRegExp)),m("ul",{className:"DiscussionListItem-info"},(0,a.Z)(this.infoItems().toArray()))),m("span",{tabindex:"0",role:"button",className:"DiscussionListItem-count",onclick:this.markAsRead.bind(this),title:s?app.translator.trans("core.forum.discussion_list.mark_as_read_tooltip"):""},d(t[s?"unreadCount":"replyCount"]()))))},n.oncreate=function(e){if(t.prototype.oncreate.call(this,e),"ontouchstart"in window){var n=w(this.$());this.$(".DiscussionListItem-controls").on("hidden.bs.dropdown",(function(){return n.reset()}))}},n.onbeforeupdate=function(e,n){return t.prototype.onbeforeupdate.call(this,e,n),this.subtree.needsRebuild()},n.active=function(){return app.current.matches(Z.Z,{discussion:this.attrs.discussion})},n.showFirstPost=function(){return-1!==["newest","oldest"].indexOf(this.attrs.params.sort)},n.showRepliesCount=function(){return"replies"===this.attrs.params.sort},n.markAsRead=function(){var t=this.attrs.discussion;t.isUnread()&&(t.save({lastReadPostNumber:t.lastPostNumber()}),m.redraw())},n.infoItems=function(){var t=new h.Z;if(this.attrs.params.q){var e=this.attrs.discussion.mostRelevantPost()||this.attrs.discussion.firstPost();if(e&&"comment"===e.contentType()){var n=(0,u.Z)(e.contentPlain(),this.highlightRegExp,175);t.add("excerpt",n,-100)}}else t.add("terminalPost",g.component({discussion:this.attrs.discussion,lastPost:!this.showFirstPost()}));return t},e}(s.Z);window.flreg.add("components/DiscussionListItem",E);var A=n(2587),L=n(8726),R=n(4612),H=function(t){function e(){return t.apply(this,arguments)||this}return(0,i.Z)(e,t),e.prototype.view=function(){var t,e=this.attrs.state,n=e.getParams();if(e.isLoading()?t=L.Z.component():e.moreResults&&(t=A.Z.component({className:"Button",onclick:e.loadMore.bind(e)},app.translator.trans("core.forum.discussion_list.load_more_button"))),e.empty()){var i=app.translator.trans("core.forum.discussion_list.empty_text");return m("div",{className:"DiscussionList"},R.Z.component({text:i}))}return m("div",{className:"DiscussionList"+(e.isSearchResults()?" DiscussionList--searchResults":"")},m("ul",{className:"DiscussionList-discussions"},e.discussions.map((function(t){return m("li",{key:t.id(),"data-id":t.id()},E.component({discussion:t,params:n}))}))),m("div",{className:"DiscussionList-loadMore"},t))},e}(s.Z);window.flreg.add("components/DiscussionList",H)},2679:(t,e,n)=>{"use strict";n.d(e,{Z:()=>U});var i=n(1788),s=n(453),o=n(4594),r=n(8931),a=n(7473),u=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.view=function(){return m("header",{className:"Hero DiscussionHero"},m("div",{className:"container"},m("ul",{className:"DiscussionHero-items"},(0,a.Z)(this.items().toArray()))))},n.items=function(){var t=new o.Z,e=this.attrs.discussion,n=e.badges().toArray();return n.length&&t.add("badges",m("ul",{className:"DiscussionHero-badges badges"},(0,a.Z)(n)),10),t.add("title",m("h2",{className:"DiscussionHero-title"},e.title())),t},e}(r.Z);window.flreg.add("components/DiscussionHero",u);var c=n(486),l=function(t){t.pageX<10&&app.pane.show()},h=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.view=function(){if(this.attrs.state.hasDiscussions())return m("div",{className:"DiscussionPage-list"},this.enoughSpace()&&m(c.Z,{state:this.attrs.state}))},n.oncreate=function(e){t.prototype.oncreate.call(this,e);var n=$(e.dom),i=app.pane;if(n.hover(i.show.bind(i),i.onmouseleave.bind(i)),$(document).on("mousemove",l),app.previous.matches(U)){var s=app.cache.discussionListPaneScrollTop||0;n.scrollTop(s)}else{var o=n.find(".DiscussionListItem.active");if(o.length){var r=n.offset().top,a=r+n.outerHeight(),u=o.offset().top,c=u+o.outerHeight();(u<r||c>a)&&n.scrollTop(n.scrollTop()-r+u)}}},n.onremove=function(t){app.cache.discussionListPaneScrollTop=$(t.dom).scrollTop(),$(document).off("mousemove",l)},n.enoughSpace=function(){return!$(".App-navigation").is(":visible")},e}(r.Z);window.flreg.add("components/DiscussionListPane",h);var d=n(9100);function p(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}window.flreg.add("utils/formatNumber",p);var f=n(8e3),g=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.stream=this.attrs.stream,this.handlers={},this.scrollListener=new f.Z(this.updateScrubberValues.bind(this,{fromScroll:!0,forceHeightChange:!0}))},n.view=function(){var t=this.stream.count(),e=app.translator.transChoice("core.forum.post_scrubber.viewing_text",t,{index:m("span",{className:"Scrubber-index"}),count:m("span",{className:"Scrubber-count"},p(t))}),n=this.stream.discussion.unreadCount(),i=t?Math.min(t-this.stream.index,n)/t:0;function s(t){var e=$(t.dom),n={top:100-100*i+"%",height:100*i+"%"};t.state.oldStyle?e.stop(!0).css(t.state.oldStyle).animate(n):e.css(n),t.state.oldStyle=n}var o=["PostStreamScrubber","Dropdown"];return this.attrs.className&&o.push(this.attrs.className),m("div",{className:o.join(" ")},m("button",{className:"Button Dropdown-toggle","data-toggle":"dropdown"},e," ",(0,d.Z)("fas fa-sort")),m("div",{className:"Dropdown-menu dropdown-menu"},m("div",{className:"Scrubber"},m("a",{className:"Scrubber-first",onclick:this.goToFirst.bind(this)},(0,d.Z)("fas fa-angle-double-up")," ",app.translator.trans("core.forum.post_scrubber.original_post_link")),m("div",{className:"Scrubber-scrollbar"},m("div",{className:"Scrubber-before"}),m("div",{className:"Scrubber-handle"},m("div",{className:"Scrubber-bar"}),m("div",{className:"Scrubber-info"},m("strong",null,e),m("span",{className:"Scrubber-description"}))),m("div",{className:"Scrubber-after"}),m("div",{className:"Scrubber-unread",oncreate:s,onupdate:s},app.translator.trans("core.forum.post_scrubber.unread_text",{count:n}))),m("a",{className:"Scrubber-last",onclick:this.goToLast.bind(this)},(0,d.Z)("fas fa-angle-double-down")," ",app.translator.trans("core.forum.post_scrubber.now_link")))))},n.onupdate=function(){var t=this;this.stream.forceUpdateScrubber&&(this.stream.forceUpdateScrubber=!1,this.stream.loadPromise.then((function(){return t.updateScrubberValues({animate:!0,forceHeightChange:!0})})))},n.oncreate=function(e){var n=this;t.prototype.oncreate.call(this,e),$(window).on("resize",this.handlers.onresize=this.onresize.bind(this)).resize(),this.$(".Scrubber-scrollbar").bind("click",this.onclick.bind(this)).bind("dragstart mousedown touchstart",(function(t){return t.preventDefault()})),this.dragging=!1,this.mouseStart=0,this.indexStart=0,this.$(".Scrubber-handle").bind("mousedown touchstart",this.onmousedown.bind(this)).click((function(t){return t.stopPropagation()})),$(document).on("mousemove touchmove",this.handlers.onmousemove=this.onmousemove.bind(this)).on("mouseup touchend",this.handlers.onmouseup=this.onmouseup.bind(this)),setTimeout((function(){return n.scrollListener.start()})),this.stream.loadPromise.then((function(){return n.updateScrubberValues({animate:!1,forceHeightChange:!0})}))},n.onremove=function(){this.scrollListener.stop(),$(window).off("resize",this.handlers.onresize),$(document).off("mousemove touchmove",this.handlers.onmousemove).off("mouseup touchend",this.handlers.onmouseup)},n.updateScrubberValues=function(t){var e=this;void 0===t&&(t={});var n=this.stream.index,i=this.stream.count(),s=this.stream.visible||1,o=this.percentPerPost(),r=this.$();r.find(".Scrubber-index").text(p(this.stream.sanitizeIndex(Math.max(1,n)))),r.find(".Scrubber-description").text(this.stream.description),r.toggleClass("disabled",this.stream.disabled());var a={};if(a.before=Math.max(0,o.index*Math.min(n-1,i-s)),a.handle=Math.min(100-a.before,o.visible*s),a.after=100-a.before-a.handle,!(t.fromScroll&&this.stream.paused||this.adjustingHeight&&!t.forceHeightChange)){var u=t.animate?"animate":"css";this.adjustingHeight=!0;var c=[];for(var l in a){var h=r.find(".Scrubber-"+l);c.push(h.stop(!0,!0)[u]({height:a[l]+"%"},"fast").promise()),"animate"===u&&h.css("overflow","visible")}Promise.all(c).then((function(){return e.adjustingHeight=!1}))}},n.goToFirst=function(){this.stream.goToFirst(),this.updateScrubberValues({animate:!0,forceHeightChange:!0})},n.goToLast=function(){this.stream.goToLast(),this.updateScrubberValues({animate:!0,forceHeightChange:!0})},n.onresize=function(){var t=this.$(),e=this.$(".Scrubber-scrollbar");e.css("max-height",$(window).height()-t.offset().top+$(window).scrollTop()-parseInt($("#app").css("padding-bottom"),10)-(t.outerHeight()-e.outerHeight()))},n.onmousedown=function(t){t.redraw=!1,this.mouseStart=t.clientY||t.originalEvent.touches[0].clientY,this.indexStart=this.stream.index,this.dragging=!0,$("body").css("cursor","move"),this.$().toggleClass("dragging",this.dragging)},n.onmousemove=function(t){if(this.dragging){var e=((t.clientY||t.originalEvent.touches[0].clientY)-this.mouseStart)/this.$(".Scrubber-scrollbar").outerHeight()*100/this.percentPerPost().index||0,n=Math.min(this.indexStart+e,this.stream.count()-1);this.stream.index=Math.max(0,n),this.updateScrubberValues()}},n.onmouseup=function(){if(this.$().toggleClass("dragging",this.dragging),this.dragging){this.mouseStart=0,this.indexStart=0,this.dragging=!1,$("body").css("cursor",""),this.$().removeClass("open");var t=Math.floor(this.stream.index);this.stream.goToIndex(t)}},n.onclick=function(t){var e=this.$(".Scrubber-scrollbar"),n=((t.pageY||t.originalEvent.touches[0].pageY)-e.offset().top+$("body").scrollTop())/e.outerHeight()*100,i=(n-=parseFloat(e.find(".Scrubber-handle")[0].style.height)/2)/this.percentPerPost().index;i=Math.max(0,Math.min(this.stream.count()-1,i)),this.stream.goToIndex(Math.floor(i)),this.updateScrubberValues({animate:!0,forceHeightChange:!0}),this.$().removeClass("open")},n.percentPerPost=function(){var t=this.stream.count()||1,e=this.stream.visible||1,n=50/this.$(".Scrubber-scrollbar").outerHeight()*100,i=Math.max(100/t,n/e);return{index:t===e?0:(100-i*e)/(t-e),visible:i}},e}(r.Z);window.flreg.add("components/PostStreamScrubber",g);var v=n(8726),b=n(2122),w=n(9657),y=n(2587),N=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.className+=" Dropdown--split",e.menuClassName+=" Dropdown-menu--right"};var n=e.prototype;return n.getButton=function(t){var e=this.getFirstChild(t),n=(0,b.Z)({},e.attrs);return n.className=(n.className||"")+" SplitDropdown-button Button "+this.attrs.buttonClassName,[y.Z.component(n,e.children),m("button",{className:"Dropdown-toggle Button Button--icon "+this.attrs.buttonClassName,"aria-haspopup":"menu","aria-label":this.attrs.accessibleToggleLabel,"data-toggle":"dropdown"},(0,d.Z)(this.attrs.icon,{className:"Button-icon"}),(0,d.Z)("fas fa-caret-down",{className:"Button-caret"}))]},n.getFirstChild=function(t){for(var e=t;e instanceof Array;)e=e[0];return e},e}(w.Z);window.flreg.add("components/SplitDropdown",N);var Z=n(1658);const x=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var S=n(3249);const C=function(){return S.Z.Date.now()};var P=/\s/;var k=/^\s+/;const I=function(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&P.test(t.charAt(e)););return e}(t)+1).replace(k,""):t};var _=n(7828),D=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,E=/^0o[0-7]+$/i,A=parseInt;const L=function(t){if("number"==typeof t)return t;if((0,_.Z)(t))return NaN;if(x(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=x(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=I(t);var n=T.test(t);return n||E.test(t)?A(t.slice(2),n?2:8):D.test(t)?NaN:+t};var R=Math.max,H=Math.min;const M=function(t,e,n){var i=!0,s=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return x(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),function(t,e,n){var i,s,o,r,a,u,c=0,l=!1,h=!1,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function p(e){var n=i,o=s;return i=s=void 0,c=e,r=t.apply(o,n)}function m(t){return c=t,a=setTimeout(g,e),l?p(t):r}function f(t){var n=t-u;return void 0===u||n>=e||n<0||h&&t-c>=o}function g(){var t=C();if(f(t))return v(t);a=setTimeout(g,function(t){var n=e-(t-u);return h?H(n,o-(t-c)):n}(t))}function v(t){return a=void 0,d&&i?p(t):(i=s=void 0,r)}function b(){var t=C(),n=f(t);if(i=arguments,s=this,u=t,n){if(void 0===a)return m(u);if(h)return clearTimeout(a),a=setTimeout(g,e),p(u)}return void 0===a&&(a=setTimeout(g,e)),r}return e=L(e)||0,x(n)&&(l=!!n.leading,o=(h="maxWait"in n)?R(L(n.maxWait)||0,e):o,d="trailing"in n?!!n.trailing:d),b.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=u=s=a=void 0},b.flush=function(){return void 0===a?r:v(C())},b}(t,e,{leading:i,maxWait:e,trailing:s})};function B(t,e){var n=$(window),i=$(t).offset().top-n.scrollTop();e(),n.scrollTop($(t).offset().top-i)}window.flreg.add("utils/anchorScroll",B);var z=function(){function t(t,e){void 0===e&&(e=[]),this.discussion=t,this.paused=!1,this.loadPageTimeouts={},this.pagesLoading=0,this.index=0,this.number=1,this.visible=1,this.description="",this.forceUpdateScrubber=!1,this.loadNext=M(this._loadNext,300),this.loadPrevious=M(this._loadPrevious,300),this.show(e)}var e=t.prototype;return e.update=function(){return this.viewingEnd()?(this.visibleEnd=this.count(),this.loadRange(this.visibleStart,this.visibleEnd)):Promise.resolve()},e.goToFirst=function(){return this.goToIndex(0)},e.goToLast=function(){return this.goToIndex(this.count()-1,!0)},e.goToNumber=function(t,e){if(void 0===e&&(e=!1),"reply"===t){var n=this.goToLast();return this.targetPost.reply=!0,n}return this.paused=!0,this.loadPromise=this.loadNearNumber(t),this.needsScroll=!0,this.targetPost={number:t},this.animateScroll=!e,this.number=t,this.loadPromise.then((function(){return m.redraw()}))},e.goToIndex=function(t,e){return void 0===e&&(e=!1),this.paused=!0,this.loadPromise=this.loadNearIndex(t),this.needsScroll=!0,this.targetPost={index:t},this.animateScroll=!e,this.index=t,m.redraw(),this.loadPromise},e.loadNearNumber=function(t){return this.posts().some((function(e){return e&&Number(e.number())===Number(t)}))?Promise.resolve():(this.reset(),app.store.find("posts",{filter:{discussion:this.discussion.id()},page:{near:t}}).then(this.show.bind(this)))},e.loadNearIndex=function(t){if(t>=this.visibleStart&&t<this.visibleEnd)return Promise.resolve();var e=this.sanitizeIndex(t-this.constructor.loadCount/2),n=e+this.constructor.loadCount;return this.reset(e,n),this.loadRange(e,n).then(this.show.bind(this))},e._loadNext=function(){var t=this.visibleEnd,e=this.visibleEnd=this.sanitizeIndex(this.visibleEnd+this.constructor.loadCount),n=t-2*this.constructor.loadCount;n>this.visibleStart&&n>=0&&(this.visibleStart=n+this.constructor.loadCount+1,this.loadPageTimeouts[n]&&(clearTimeout(this.loadPageTimeouts[n]),this.loadPageTimeouts[n]=null,this.pagesLoading--)),this.loadPage(t,e)},e._loadPrevious=function(){var t=this.visibleStart,e=this.visibleStart=this.sanitizeIndex(this.visibleStart-this.constructor.loadCount),n=e+2*this.constructor.loadCount;n<this.visibleEnd&&n<=this.count()&&(this.visibleEnd=n,this.loadPageTimeouts[n]&&(clearTimeout(this.loadPageTimeouts[n]),this.loadPageTimeouts[n]=null,this.pagesLoading--)),this.loadPage(e,t,!0)},e.loadPage=function(t,e,n){var i=this;void 0===n&&(n=!1),this.pagesLoading++;var s=function(){t<i.visibleStart||e>i.visibleEnd||B('.PostStream-item[data-index="'+(n?i.visibleEnd-1:i.visibleStart)+'"]',m.redraw.sync)};s(),this.loadPageTimeouts[t]=setTimeout((function(){i.loadRange(t,e).then((function(){s(),i.pagesLoading--})),i.loadPageTimeouts[t]=null}),this.pagesLoading-1?1e3:0)},e.loadRange=function(t,e){var n=[],i=[];return this.discussion.postIds().slice(t,e).forEach((function(t){var e=app.store.getById("posts",t);e&&e.discussion()&&void 0!==e.canEdit()?i.push(e):n.push(t)})),n.length?app.store.find("posts",n).then((function(t){return i.concat(t).sort((function(t,e){return t.createdAt()-e.createdAt()}))})):Promise.resolve(i)},e.show=function(t){this.visibleStart=t.length?this.discussion.postIds().indexOf(t[0].id()):0,this.visibleEnd=this.sanitizeIndex(this.visibleStart+t.length)},e.reset=function(t,e){this.visibleStart=t||0,this.visibleEnd=this.sanitizeIndex(e||this.constructor.loadCount)},e.posts=function(){return this.discussion.postIds().slice(this.visibleStart,this.visibleEnd).map((function(t){var e=app.store.getById("posts",t);return e&&e.discussion()&&void 0!==e.canEdit()?e:null}))},e.count=function(){return this.discussion.postIds().length},e.disabled=function(){return this.visible>=this.count()},e.viewingEnd=function(){return Math.abs(this.count()-this.visibleEnd)<=1},e.sanitizeIndex=function(t){return Math.max(0,Math.min(this.count(),Math.floor(t)))},t}();z.loadCount=20;const F=z;window.flreg.add("states/PostStreamState",z);var U=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t);var s=e.prototype;return s.oninit=function(e){t.prototype.oninit.call(this,e),this.useBrowserScrollRestoration=!1,this.discussion=null,this.near=m.route.param("near")||0,this.load(),app.discussions.hasDiscussions()&&(app.pane.enable(),app.pane.hide()),app.history.push("discussion"),this.bodyClass="App--discussion"},s.onremove=function(){t.prototype.onremove.call(this),app.pane.disable(),app.composer.composingReplyTo(this.discussion)&&!app.composer.fields.content()?app.composer.hide():app.composer.minimize()},s.view=function(){var t=this.discussion,e=this.PostStream;return m("div",{className:"DiscussionPage"},m(h,{state:app.discussions}),m("div",{className:"DiscussionPage-discussion"},t?[u.component({discussion:t}),m("div",{className:"container"},m("nav",{className:"DiscussionPage-nav"},m("ul",null,(0,a.Z)(this.sidebarItems().toArray()))),m("div",{className:"DiscussionPage-stream"},e?m(e,{discussion:t,stream:this.stream,onPositionChange:this.positionChanged.bind(this)}):v.Z.component({className:"LoadingIndicator--block"})))]:v.Z.component({className:"LoadingIndicator--block"})))},s.load=function(){var t=this;Promise.all([n.e(997),n.e(563)]).then(n.bind(n,4371)).then((function(e){t.PostStream=e.default,m.redraw()}));var e=app.preloadedApiDocument();if(e)setTimeout(this.show.bind(this,e),0);else{var i=this.requestParams();app.store.find("discussions",m.route.param("id"),i).then(this.show.bind(this))}m.redraw()},s.requestParams=function(){return{bySlug:!0,page:{near:this.near}}},s.show=function(t){var e=this;app.history.push("discussion",t.title()),app.setTitle(t.title()),app.setTitleCount(0);var n=[];if(t.payload&&t.payload.included){var i=t.id();n=t.payload.included.filter((function(t){return"posts"===t.type&&t.relationships&&t.relationships.discussion&&t.relationships.discussion.data.id===i})).map((function(t){return app.store.getById("posts",t.id)})).sort((function(t,e){return t.createdAt()-e.createdAt()})).slice(0,20)}this.stream=new F(t,n),this.stream.goToNumber(m.route.param("near")||n[0]&&n[0].number(),!0).then((function(){e.discussion=t,app.current.set("discussion",t),app.current.set("stream",e.stream)}))},s.sidebarItems=function(){var t=new o.Z;return t.add("controls",N.component({icon:"fas fa-ellipsis-v",className:"App-primaryControl",buttonClassName:"Button--primary",accessibleToggleLabel:app.translator.trans("core.forum.discussion_controls.toggle_dropdown_accessible_label")},(new Z.Z).controls(this.discussion,this).toArray())),t.add("scrubber",g.component({stream:this.stream,className:"App-titleControl"}),-100),t},s.positionChanged=function(t,e){var n=this.discussion,i=app.route.discussion(n,this.near=t);window.history.replaceState(null,document.title,i),app.history.push("discussion",n.title()),app.session.user&&e>(n.lastReadPostNumber()||0)&&(n.save({lastReadPostNumber:e}),m.redraw())},e}(s.Z);window.flreg.add("components/DiscussionPage",U)},4181:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var i=n(1788),s=n(4810),o=n(2587),r=n(8046),a=n(9100),u=n(5731);function c(t){app.composer.isFullScreen()&&(app.composer.minimize(),t.stopPropagation())}var l=function(t){function e(){return t.apply(this,arguments)||this}(0,i.Z)(e,t),e.initAttrs=function(e){t.initAttrs.call(this,e),e.placeholder=e.placeholder||(0,u.Z)(app.translator.trans("core.forum.composer_reply.body_placeholder")),e.submitLabel=e.submitLabel||app.translator.trans("core.forum.composer_reply.submit_button"),e.confirmExit=e.confirmExit||(0,u.Z)(app.translator.trans("core.forum.composer_reply.discard_confirmation"))};var n=e.prototype;return n.headerItems=function(){var e=t.prototype.headerItems.call(this),n=this.attrs.discussion;return e.add("title",m("h3",null,(0,a.Z)("fas fa-reply")," ",m(r.Z,{href:app.route.discussion(n),onclick:c},n.title()))),e},n.jumpToPreview=function(t){c(t),m.route.set(app.route.discussion(this.attrs.discussion,"reply"))},n.data=function(){return{content:this.composer.fields.content(),relationships:{discussion:this.attrs.discussion}}},n.onsubmit=function(){var t=this,e=this.attrs.discussion;this.loading=!0,m.redraw();var n=this.data();app.store.createRecord("posts").save(n).then((function(n){if(app.viewingDiscussion(e)){var i=app.current.get("stream");i.update().then((function(){return i.goToNumber(n.number())}))}else{var s,r=o.Z.component({className:"Button Button--link",onclick:function(){m.route.set(app.route.post(n)),app.alerts.dismiss(s)}},app.translator.trans("core.forum.composer_reply.view_button"));s=app.alerts.show({type:"success",controls:[r]},app.translator.trans("core.forum.composer_reply.posted_message"))}t.composer.hide()}),this.loaded.bind(this))},e}(s.Z);window.flreg.add("components/ReplyComposer",l)},2060:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var i=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=window.app),this.params=t,this.app=e,this.discussions=[],this.moreResults=!1,this.loading=!1}var e=t.prototype;return e.requestParams=function(){var t={include:["user","lastPostedUser"],filter:{}};return t.sort=this.sortMap()[this.params.sort],this.params.q&&(t.filter.q=this.params.q,t.include.push("mostRelevantPost","mostRelevantPost.user")),t},e.sortMap=function(){var t={};return this.params.q&&(t.relevance=""),t.latest="-lastPostedAt",t.top="-commentCount",t.newest="-createdAt",t.oldest="createdAt",t},e.getParams=function(){return this.params},e.clear=function(){this.discussions=[],m.redraw()},e.refreshParams=function(t){var e=this;this.hasDiscussions()&&!Object.keys(t).some((function(n){return e.getParams()[n]!==t[n]}))||(this.params=t,this.refresh())},e.refresh=function(t){var e=this,n=(void 0===t?{}:t).deferClear,i=void 0!==n&&n;return this.loading=!0,i||this.clear(),this.loadResults().then((function(t){e.discussions=[],e.parseResults(t)}),(function(){e.loading=!1,m.redraw()}))},e.loadResults=function(t){var e=this.app.preloadedApiDocument();if(e)return Promise.resolve(e);var n=this.requestParams();return n.page={offset:t},n.include=n.include.join(","),this.app.store.find("discussions",n)},e.loadMore=function(){this.loading=!0,this.loadResults(this.discussions.length).then(this.parseResults.bind(this))},e.parseResults=function(t){var e;return(e=this.discussions).push.apply(e,t),this.loading=!1,this.moreResults=!!t.payload.links&&!!t.payload.links.next,m.redraw(),t},e.removeDiscussion=function(t){var e=this.discussions.indexOf(t);-1!==e&&this.discussions.splice(e,1),m.redraw()},e.addDiscussion=function(t){this.discussions.unshift(t),m.redraw()},e.hasDiscussions=function(){return this.discussions.length>0},e.isLoading=function(){return this.loading},e.isSearchResults=function(){return!!this.params.q},e.empty=function(){return!this.hasDiscussions()&&!this.isLoading()},t}();window.flreg.add("states/DiscussionListState",i)},1658:(t,e,n)=>{"use strict";n.d(e,{Z:()=>g});var i=n(7757),s=n.n(i),o=n(2137),r=n(2679),a=n(2587),u=n(5128),c=n(1788),l=n(5556),h=n(1024),d=function(t){function e(){return t.apply(this,arguments)||this}(0,c.Z)(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.discussion=this.attrs.discussion,this.currentTitle=this.attrs.currentTitle,this.newTitle=(0,h.Z)(this.currentTitle)},n.className=function(){return"RenameDiscussionModal Modal--small"},n.title=function(){return app.translator.trans("core.forum.rename_discussion.title")},n.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("div",{className:"Form-group"},m("input",{className:"FormControl",bidi:this.newTitle,type:"text"})),m("div",{className:"Form-group"},a.Z.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("core.forum.rename_discussion.submit_button")))))},n.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0;var n=this.newTitle(),i=this.currentTitle;if(n&&n!==i)return this.discussion.save({title:n}).then((function(){app.viewingDiscussion(e.discussion)&&app.current.get("stream").update(),m.redraw(),e.hide()})).catch((function(){e.loading=!1,m.redraw()}));this.hide()},e}(l.Z);window.flreg.add("components/RenameDiscussionModal",d);var p=n(4594),f=n(5731),g=function(){function t(){}var e=t.prototype;return e.controls=function(t,e){var n=this,i=new p.Z;return["user","moderation","destructive"].forEach((function(s){var o=n[s+"Controls"](t,e).toArray();o.length&&(o.forEach((function(t){return i.add(t.itemName,t)})),i.add(s+"Separator",u.Z.component()))})),i},e.userControls=function(t,e){var n=this,i=new p.Z;return e instanceof r.Z&&i.add("reply",!app.session.user||t.canReply()?a.Z.component({icon:"fas fa-reply",onclick:function(){return n.replyAction.bind(t)(!0,!1).catch((function(){}))}},app.translator.trans(app.session.user?"core.forum.discussion_controls.reply_button":"core.forum.discussion_controls.log_in_to_reply_button")):a.Z.component({icon:"fas fa-reply",className:"disabled",title:app.translator.trans("core.forum.discussion_controls.cannot_reply_text")},app.translator.trans("core.forum.discussion_controls.cannot_reply_button"))),i},e.moderationControls=function(t){var e=new p.Z;return t.canRename()&&e.add("rename",a.Z.component({icon:"fas fa-pencil-alt",onclick:this.renameAction.bind(t)},app.translator.trans("core.forum.discussion_controls.rename_button"))),e},e.destructiveControls=function(t){var e=new p.Z;return t.isHidden()?(t.canHide()&&e.add("restore",a.Z.component({icon:"fas fa-reply",onclick:this.restoreAction.bind(t)},app.translator.trans("core.forum.discussion_controls.restore_button"))),t.canDelete()&&e.add("delete",a.Z.component({icon:"fas fa-times",onclick:this.deleteAction.bind(t)},app.translator.trans("core.forum.discussion_controls.delete_forever_button")))):t.canHide()&&e.add("hide",a.Z.component({icon:"far fa-trash-alt",onclick:this.hideAction.bind(t)},app.translator.trans("core.forum.discussion_controls.delete_button"))),e},e.replyAction=function(t,e){var i=this,r=function(){return n.e(460).then(n.bind(n,1498))},a=function(){return Promise.resolve().then(n.bind(n,4181))};return new Promise(function(){var n=(0,o.Z)(s().mark((function n(o,u){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!app.session.user){n.next=12;break}if(!i.canReply()){n.next=11;break}if(app.composer.composingReplyTo(i)&&!e){n.next=5;break}return n.next=5,app.composer.load(a,{user:app.session.user,discussion:i});case 5:return console.log("hi"),app.composer.show(),t&&app.viewingDiscussion(i)&&!app.composer.isFullScreen()&&app.current.get("stream").goToNumber("reply"),n.abrupt("return",o(app.composer));case 11:return n.abrupt("return",u());case 12:return app.modal.show(r),n.abrupt("return",u());case 14:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())},e.hideAction=function(){return this.pushAttributes({hiddenAt:new Date,hiddenUser:app.session.user}),this.save({isHidden:!0})},e.restoreAction=function(){return this.pushAttributes({hiddenAt:null,hiddenUser:null}),this.save({isHidden:!1})},e.deleteAction=function(){var t=this;if(confirm((0,f.Z)(app.translator.trans("core.forum.discussion_controls.delete_confirmation"))))return app.viewingDiscussion(this)&&app.history.back(),this.delete().then((function(){return app.discussions.removeDiscussion(t)}))},e.renameAction=function(){return app.modal.show(d,{currentTitle:this.title(),discussion:this})},t}();window.flreg.add("utils/DiscussionControls",g)},9089:t=>{var e=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.update=function(t){this.context.putImageData(t,0,0)},e.prototype.getPixelCount=function(){return this.width*this.height},e.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},e.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var n=function(){};if(n.prototype.getColor=function(t,e){return this.getPalette(t,5,e)[0]},n.prototype.getPalette=function(t,n,i){void 0===n&&(n=10),(void 0===i||1>i)&&(i=10);for(var o,r,a,u,c=new e(t),l=c.getImageData().data,h=c.getPixelCount(),d=[],p=0;h>p;p+=i)r=l[0+(o=4*p)],a=l[o+1],u=l[o+2],l[o+3]>=125&&(r>250&&a>250&&u>250||d.push([r,a,u]));var m=s.quantize(d,n),f=m?m.palette():null;return c.removeCanvas(),f},!i)var i={map:function(t,e){var n={};return e?t.map((function(t,i){return n.index=i,e.call(n,t)})):t.slice()},naturalOrder:function(t,e){return e>t?-1:t>e?1:0},sum:function(t,e){var n={};return t.reduce(e?function(t,i,s){return n.index=s,t+e.call(n,i)}:function(t,e){return t+e},0)},max:function(t,e){return Math.max.apply(null,e?i.map(t,e):t)}};var s=function(){function t(t,e,n){return(t<<2*u)+(e<<u)+n}function e(t){function e(){n.sort(t),i=!0}var n=[],i=!1;return{push:function(t){n.push(t),i=!1},peek:function(t){return i||e(),void 0===t&&(t=n.length-1),n[t]},pop:function(){return i||e(),n.pop()},size:function(){return n.length},map:function(t){return n.map(t)},debug:function(){return i||e(),n}}}function n(t,e,n,i,s,o,r){var a=this;a.r1=t,a.r2=e,a.g1=n,a.g2=i,a.b1=s,a.b2=o,a.histo=r}function s(){this.vboxes=new e((function(t,e){return i.naturalOrder(t.vbox.count()*t.vbox.volume(),e.vbox.count()*e.vbox.volume())}))}function o(e){var n,i,s,o,r=new Array(1<<3*u);return e.forEach((function(e){i=e[0]>>c,s=e[1]>>c,o=e[2]>>c,n=t(i,s,o),r[n]=(r[n]||0)+1})),r}function r(t,e){var i,s,o,r=1e6,a=0,u=1e6,l=0,h=1e6,d=0;return t.forEach((function(t){i=t[0]>>c,s=t[1]>>c,o=t[2]>>c,r>i?r=i:i>a&&(a=i),u>s?u=s:s>l&&(l=s),h>o?h=o:o>d&&(d=o)})),new n(r,a,u,l,h,d,e)}function a(e,n){if(n.count()){var s=n.r2-n.r1+1,o=n.g2-n.g1+1,r=n.b2-n.b1+1,a=i.max([s,o,r]);if(1==n.count())return[n.copy()];var u,c,l,h,d=0,p=[],m=[];if(a==s)for(u=n.r1;u<=n.r2;u++){for(h=0,c=n.g1;c<=n.g2;c++)for(l=n.b1;l<=n.b2;l++)h+=e[t(u,c,l)]||0;d+=h,p[u]=d}else if(a==o)for(u=n.g1;u<=n.g2;u++){for(h=0,c=n.r1;c<=n.r2;c++)for(l=n.b1;l<=n.b2;l++)h+=e[t(c,u,l)]||0;d+=h,p[u]=d}else for(u=n.b1;u<=n.b2;u++){for(h=0,c=n.r1;c<=n.r2;c++)for(l=n.g1;l<=n.g2;l++)h+=e[t(c,l,u)]||0;d+=h,p[u]=d}return p.forEach((function(t,e){m[e]=d-t})),function(t){var e,i,s,o,r,a=t+"1",c=t+"2",l=0;for(u=n[a];u<=n[c];u++)if(p[u]>d/2){for(s=n.copy(),o=n.copy(),e=u-n[a],r=(i=n[c]-u)>=e?Math.min(n[c]-1,~~(u+i/2)):Math.max(n[a],~~(u-1-e/2));!p[r];)r++;for(l=m[r];!l&&p[r-1];)l=m[--r];return s[c]=r,o[a]=s[c]+1,[s,o]}}(a==s?"r":a==o?"g":"b")}}var u=5,c=8-u;return n.prototype={volume:function(t){var e=this;return(!e._volume||t)&&(e._volume=(e.r2-e.r1+1)*(e.g2-e.g1+1)*(e.b2-e.b1+1)),e._volume},count:function(e){var n=this,i=n.histo;if(!n._count_set||e){var s,o,r,a=0;for(s=n.r1;s<=n.r2;s++)for(o=n.g1;o<=n.g2;o++)for(r=n.b1;r<=n.b2;r++)index=t(s,o,r),a+=i[index]||0;n._count=a,n._count_set=!0}return n._count},copy:function(){var t=this;return new n(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(e){var n=this,i=n.histo;if(!n._avg||e){var s,o,r,a,c=0,l=1<<8-u,h=0,d=0,p=0;for(o=n.r1;o<=n.r2;o++)for(r=n.g1;r<=n.g2;r++)for(a=n.b1;a<=n.b2;a++)c+=s=i[t(o,r,a)]||0,h+=s*(o+.5)*l,d+=s*(r+.5)*l,p+=s*(a+.5)*l;n._avg=c?[~~(h/c),~~(d/c),~~(p/c)]:[~~(l*(n.r1+n.r2+1)/2),~~(l*(n.g1+n.g2+1)/2),~~(l*(n.b1+n.b2+1)/2)]}return n._avg},contains:function(t){var e=this,n=t[0]>>c;return gval=t[1]>>c,bval=t[2]>>c,n>=e.r1&&n<=e.r2&&gval>=e.g1&&gval<=e.g2&&bval>=e.b1&&bval<=e.b2}},s.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map((function(t){return t.color}))},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,n=0;n<e.size();n++)if(e.peek(n).vbox.contains(t))return e.peek(n).color;return this.nearest(t)},nearest:function(t){for(var e,n,i,s=this.vboxes,o=0;o<s.size();o++)(e>(n=Math.sqrt(Math.pow(t[0]-s.peek(o).color[0],2)+Math.pow(t[1]-s.peek(o).color[1],2)+Math.pow(t[2]-s.peek(o).color[2],2)))||void 0===e)&&(e=n,i=s.peek(o).color);return i},forcebw:function(){var t=this.vboxes;t.sort((function(t,e){return i.naturalOrder(i.sum(t.color),i.sum(e.color))}));var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,s=t[n].color;s[0]>251&&s[1]>251&&s[2]>251&&(t[n].color=[255,255,255])}},{quantize:function(t,n){function u(t,e){for(var n,i=1,s=0;1e3>s;)if((n=t.pop()).count()){var o=a(c,n),r=o[0],u=o[1];if(!r)return;if(t.push(r),u&&(t.push(u),i++),i>=e)return;if(s++>1e3)return}else t.push(n),s++}if(!t.length||2>n||n>256)return!1;var c=o(t);c.forEach((function(){}));var l=r(t,c),h=new e((function(t,e){return i.naturalOrder(t.count(),e.count())}));h.push(l),u(h,.75*n);for(var d=new e((function(t,e){return i.naturalOrder(t.count()*t.volume(),e.count()*e.volume())}));h.size();)d.push(h.pop());u(d,n-d.size());for(var p=new s;d.size();)p.push(d.pop());return p}}}();t.exports=n},443:(t,e,n)=>{var i=n(9089),s=n(7672);void 0===s.ColorThief&&(s.ColorThief=i),t.exports=i},4816:(t,e,n)=>{var i=n(3689),s=n(7672);void 0===s.punycode&&(s.punycode=i),t.exports=i},7828:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(6818),s=n(3195);const o=function(t){return"symbol"==typeof t||(0,s.Z)(t)&&"[object Symbol]"==(0,i.Z)(t)}},3689:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ucs2decode:()=>p,ucs2encode:()=>m,decode:()=>v,encode:()=>b,toASCII:()=>y,toUnicode:()=>w,default:()=>N});const i=2147483647,s=36,o=/^xn--/,r=/[^\0-\x7E]/,a=/[\x2E\u3002\uFF0E\uFF61]/g,u={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},c=Math.floor,l=String.fromCharCode;function h(t){throw new RangeError(u[t])}function d(t,e){const n=t.split("@");let i="";n.length>1&&(i=n[0]+"@",t=n[1]);const s=function(t,e){const n=[];let i=t.length;for(;i--;)n[i]=e(t[i]);return n}((t=t.replace(a,".")).split("."),e).join(".");return i+s}function p(t){const e=[];let n=0;const i=t.length;for(;n<i;){const s=t.charCodeAt(n++);if(s>=55296&&s<=56319&&n<i){const i=t.charCodeAt(n++);56320==(64512&i)?e.push(((1023&s)<<10)+(1023&i)+65536):(e.push(s),n--)}else e.push(s)}return e}const m=t=>String.fromCodePoint(...t),f=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},g=function(t,e,n){let i=0;for(t=n?c(t/700):t>>1,t+=c(t/e);t>455;i+=s)t=c(t/35);return c(i+36*t/(t+38))},v=function(t){const e=[],n=t.length;let o=0,r=128,a=72,u=t.lastIndexOf("-");u<0&&(u=0);for(let n=0;n<u;++n)t.charCodeAt(n)>=128&&h("not-basic"),e.push(t.charCodeAt(n));for(let d=u>0?u+1:0;d<n;){let u=o;for(let e=1,r=s;;r+=s){d>=n&&h("invalid-input");const u=(l=t.charCodeAt(d++))-48<10?l-22:l-65<26?l-65:l-97<26?l-97:s;(u>=s||u>c((i-o)/e))&&h("overflow"),o+=u*e;const p=r<=a?1:r>=a+26?26:r-a;if(u<p)break;const m=s-p;e>c(i/m)&&h("overflow"),e*=m}const p=e.length+1;a=g(o-u,p,0==u),c(o/p)>i-r&&h("overflow"),r+=c(o/p),o%=p,e.splice(o++,0,r)}var l;return String.fromCodePoint(...e)},b=function(t){const e=[];let n=(t=p(t)).length,o=128,r=0,a=72;for(const n of t)n<128&&e.push(l(n));let u=e.length,d=u;for(u&&e.push("-");d<n;){let n=i;for(const e of t)e>=o&&e<n&&(n=e);const p=d+1;n-o>c((i-r)/p)&&h("overflow"),r+=(n-o)*p,o=n;for(const n of t)if(n<o&&++r>i&&h("overflow"),n==o){let t=r;for(let n=s;;n+=s){const i=n<=a?1:n>=a+26?26:n-a;if(t<i)break;const o=t-i,r=s-i;e.push(l(f(i+o%r,0))),t=c(o/r)}e.push(l(f(t,0))),a=g(r,p,d==u),r=0,++d}++r,++o}return e.join("")},w=function(t){return d(t,(function(t){return o.test(t)?v(t.slice(4).toLowerCase()):t}))},y=function(t){return d(t,(function(t){return r.test(t)?"xn--"+b(t):t}))},N={version:"2.1.0",ucs2:{decode:p,encode:m},decode:v,encode:b,toASCII:y,toUnicode:w}},5456:t=>{"use strict";t.exports=window.flreg.get("components/UserPage")}},t=>{t.O(0,[358,997],(()=>(742,t(t.s=742))));var e=t.O();flarum.core=e}]);
//# sourceMappingURL=flarum-core.js.map